{"version":3,"sources":["webpack://diglossa.js/./src/config.js","webpack://diglossa.js/./src/i18n/about_menu_template.js","webpack://diglossa.js/./src/i18n/book_menu_template.js","webpack://diglossa.js/./src/i18n/dict_menu_template.js","webpack://diglossa.js/./src/i18n/file_menu_template.js","webpack://diglossa.js/./src/i18n/help_menu_template.js","webpack://diglossa.js/./src/i18n/i18n.js","webpack://diglossa.js/./src/i18n/lang_deu_menu_template.js","webpack://diglossa.js/./src/i18n/lang_eng_menu_template.js","webpack://diglossa.js/./src/i18n/lang_rus_menu_template.js","webpack://diglossa.js/./src/i18n/lang_zho_menu_template.js","webpack://diglossa.js/./src/i18n/menu-factory.js","webpack://diglossa.js/external \"book-epub2json\"","webpack://diglossa.js/external \"book-fb2json\"","webpack://diglossa.js/external \"book-md2json\"","webpack://diglossa.js/external \"book-pdf2json\"","webpack://diglossa.js/external \"electron\"","webpack://diglossa.js/external \"electron-store\"","webpack://diglossa.js/external \"fs-extra\"","webpack://diglossa.js/external \"os\"","webpack://diglossa.js/external \"path\"","webpack://diglossa.js/external \"url\"","webpack://diglossa.js/webpack/bootstrap","webpack://diglossa.js/webpack/runtime/compat get default export","webpack://diglossa.js/webpack/runtime/define property getters","webpack://diglossa.js/webpack/runtime/hasOwnProperty shorthand","webpack://diglossa.js/webpack/runtime/make namespace object","webpack://diglossa.js/./src/background.js"],"names":["config","host","port","version","defstate","batch_size","pageSize","splitSizes","langs","ldname","deflang","extpath","log","console","aboutMenuTemplate","menu","label","t","submenu","click","BrowserWindow","webContents","send","bookMenuTemplate","accelerator","type","dictMenuTemplate","fileMenuTemplate","app","os","require","href","helpMenuTemplate","shell","debugInfo","body","join","reloadIgnoringCache","toggleDevTools","process","platform","release","trim","path","electron","fse","ipcMain","remote","apath","getAppPath","content","lang","on","event","newlang","loadedLanguage","i18n","phrase","langFile","localePath","resolve","pathExistsSync","readJsonSync","enPath","dcased","uncap","caped","capitalize","s","charAt","toUpperCase","slice","toLowerCase","deuMenuTemplate","engMenuTemplate","rusMenuTemplate","zhoMenuTemplate","Menu","MenuFactory","menus","push","setApplicationMenu","buildFromTemplate","Store","positionstore","name","createWindow","mainWindow","width","height","webPreferences","enableRemoteModule","nodeIntegrationInWorker","nodeIntegration","winBounds","get","getBounds","setBounds","loadURL","url","pathname","__dirname","protocol","slashes","preventDefault","openDevTools","global","templates","dgl","set","pckg","setTitle","data","bpath","ext","replace","split","action","epub2json","fb2json","pdf2json","md2json","descr","result","orbid","createPopup","popupWindow","frame","hasShadow","show","popupBounds","hide","handleError","title","error","errorHandler","_","debounce","window","addEventListener","rejectionHandler","reason"],"mappings":"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","file":"background.js","sourcesContent":["//\n\nexport const config = {\n  host: 'http://diglossa.org',\n  port: '5984',\n  version: 'https://github.com/mbykov/diglossa.js/releases/latest',\n  defstate: 'library',\n  batch_size: 1000,\n  pageSize: 25,\n  splitSizes: [100, 0],\n  langs: ['eng', 'deu', 'rus'],\n  ldname: 'local',\n  deflang: 'eng',\n  extpath: './diglossa.export.fts'\n}\n","import { app, BrowserWindow } from \"electron\";\nimport { i18n as t } from \"./i18n\";\nlet log  = console.log\n\nexport function aboutMenuTemplate() {\n  let menu =  {\n    label: t('about'),\n\n    submenu: [\n      {  label: t('essence '), click: () => { BrowserWindow.getFocusedWindow().webContents.send('section', 'essence') } },\n\n      {  label: t('about'), click: () => { BrowserWindow.getFocusedWindow().webContents.send('section', 'about') } },\n\n      {  label: t('acknowledgements'), click: () => { BrowserWindow.getFocusedWindow().webContents.send('section', 'acknowledgements') } },\n\n      {  label: t('code'), click: () => { BrowserWindow.getFocusedWindow().webContents.send('section', 'code') } },\n\n      {  label: t('contacts'), click: () => { BrowserWindow.getFocusedWindow().webContents.send('section', 'contacts') } },\n\n      {  label: t('license'), click: () => { BrowserWindow.getFocusedWindow().webContents.send('section', 'license') } },\n\n    ]\n  }\n  return menu\n}\n","import { app, BrowserWindow } from \"electron\";\nimport { i18n as t } from \"./i18n\";\nlet log  = console.log\n\nexport function bookMenuTemplate() {\n  let menu =  {\n    label: t(\"book\"),\n    submenu: [\n      {  label: t(\"library\"),\n         accelerator: \"CmdOrCtrl+L\",\n         click: () => { BrowserWindow.getFocusedWindow().webContents.send('route', 'library') } },\n\n      {  label: t(\"bookmarks\"),\n         // accelerator: \"CmdOrCtrl+B\",\n         click: () => { BrowserWindow.getFocusedWindow().webContents.send('route', 'bookmarks') } },\n\n      { type: \"separator\" },\n      { label: \"Import book\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('importBook') } },\n      { label: \"Add parallel book\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('addParallelBook') } },\n      { label: \"Generate FTS\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('generateFTS') } },\n\n      { type: \"separator\" },\n      // { label: \"Book package preferences\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('route', 'prefs') } },\n      { label: \"Export to .dgl package\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('route', 'preference') } },\n\n      // { type: \"separator\" },\n\n      { label: \"Compress package\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('compress') } },\n      { label: \"Uncompress package\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('uncompress') } },\n      // { label: \"Publish\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('publishDGL') } },\n\n    ]\n  }\n  return menu\n}\n","import { app, BrowserWindow } from \"electron\";\nimport { i18n as t } from \"./i18n\";\nlet log  = console.log\n\nexport function dictMenuTemplate() {\n  let menu =  {\n    label: t(\"dictionary\"),\n    submenu: [\n      {  label: t(\"dictionary list\"),\n         // accelerator: \"CmdOrCtrl+D\", ======= ли то, либо это\n         click: () => { BrowserWindow.getFocusedWindow().webContents.send('route', 'dictionary') } },\n\n      { type: \"separator\" },\n      { label: \"Import StarDict .ifo\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('importDict') } },\n      { label: \"Import DSL .ifo\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('importDict') } },\n\n      { type: \"separator\" },\n      { label: \"Export  .dgl-dict\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('exportDGL-dict') } },\n\n    ]\n  }\n  return menu\n}\n","import { app, BrowserWindow } from \"electron\";\nimport { i18n as t } from \"./i18n\";\nlet log  = console.log\n\nexport function fileMenuTemplate() {\n  let menu =  {\n    label: \"File\",\n    submenu: [\n      {  label: t(\"home\"),\n         accelerator: \"CmdOrCtrl+H\",\n         click: () => { BrowserWindow.getFocusedWindow().webContents.send('route', 'home') } },\n\n      {  label: t(\"sign in\"),\n         click: () => { BrowserWindow.getFocusedWindow().webContents.send('route', 'signin') } },\n\n      {  label: t(\"sign up\"),\n         click: () => { BrowserWindow.getFocusedWindow().webContents.send('route', 'signup') } },\n\n      { type: \"separator\" },\n\n      { type: \"separator\" },\n\n      {  label: t(\"Preferences\"),\n         click: () => { BrowserWindow.getFocusedWindow().webContents.send('route', 'prefsapp') } },\n\n      { type: \"separator\" },\n\n      { label: t(\"Quit\"),\n        accelerator: \"CmdOrCtrl+Q\",\n        click: () => {\n          app.quit();\n        }\n      }\n    ]\n  }\n  return menu\n}\n","import { app, BrowserWindow, shell } from \"electron\"\nimport { i18n as t } from \"./i18n\"\nconst os = require('os')\n\nlet href\n\nexport function helpMenuTemplate() {\n  let menu =  {\n    label: t(\"Help\"),\n    submenu: [\n      { label: t(\"Website\"), click: () => {\n        href = 'http://diglossa.org/diglossa.js'\n        shell.openExternal(href)\n      } },\n      { label: t(\"Source Code\"), click: () => {\n        href = 'https://github.com/mbykov/diglossa.js/'\n        shell.openExternal(href)\n      } },\n      { label: t(\"Report an Issue…\"), click: () => {\n        href = 'https://github.com/mbykov/diglossa.js/issues/new/'\n        console.log('INFO', debugInfo())\n        let body = debugInfo()\n        href = [href, body].join('?body=')\n        shell.openExternal(href)\n      } },\n\t    { label: 'Show App Data',\n\t\t    click() {\n\t\t\t    shell.openItem(app.getPath('userData'));\n\t\t    }\n\t    },\n      { label: t(\"hot keys\"), accelerator: \"CmdOrCtrl+H\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('section', 'help') } },\n      { label: \"Reload\", accelerator: \"CmdOrCtrl+R\", click: () => { BrowserWindow.getFocusedWindow().webContents.reloadIgnoringCache(); }  },\n      { label: \"Re-Read\", accelerator: \"Shift+CmdOrCtrl+R\", click: () => { BrowserWindow.getFocusedWindow().webContents.send('action', 're-read-file') }  },\n      { label: t(\"Toggle devTools\"),\n        accelerator: \"Alt+CmdOrCtrl+I\",\n        click: () => {\n          BrowserWindow.getFocusedWindow().toggleDevTools();\n        }\n      }\n    ]\n  }\n  return menu\n}\n\nfunction debugInfo() {\n  let debugInfo = `${app.getName()} ${app.getVersion()}\n            ${process.platform} ${os.release()}\n            Locale: ${app.getLocale()}\n            `.trim()\n  return debugInfo\n}\n","'use strict'\n\nconst path = require(\"path\")\nconst electron = require('electron')\nconst fse = require('fs-extra')\nconst config = require('../config')\nconst { ipcMain } = require('electron')\nconst log = console.log\n\nlet app = electron.app ? electron.app : electron.remote.app\nlet apath = app.getAppPath()\nlet content = {}\n\nlet lang = config.deflang\nipcMain.on('lang', (event, newlang) => {\n  lang = newlang\n})\n\nlet loadedLanguage\nexport function i18n(phrase) {\n  if (!content[lang]) {\n    let langFile = lang + '.js'\n    let localePath = path.resolve(apath, 'src/i18n', langFile)\n\t  if (fse.pathExistsSync(localePath)) {\n\t\t  loadedLanguage = fse.readJsonSync(localePath)\n\t  } else {\n      let enPath = path.resolve(apath, 'src/i18n/eng.js')\n\t\t  loadedLanguage = fse.readJsonSync(enPath)\n\t  }\n    content[lang] = loadedLanguage\n  }\n  let dcased = uncap(phrase)\n  let caped = capitalize(content[lang][dcased]) || capitalize(phrase)\n  return caped\n}\n\nconst capitalize = (s) => {\n  if (typeof s !== 'string') return ''\n  return s.charAt(0).toUpperCase() + s.slice(1)\n}\n\nconst uncap = (s) => {\n  if (typeof s !== 'string') return ''\n  return s.charAt(0).toLowerCase() + s.slice(1)\n}\n","import { app, BrowserWindow, ipcRenderer } from \"electron\";\n\nexport const deuMenuTemplate = {\n  label: \"DEU\",\n  submenu: [\n    {\n      label: \"ENG\",\n      click: () => {\n        BrowserWindow.getFocusedWindow().webContents.send('lang', 'eng')\n      }\n    },\n    {\n      label: \"RUS\",\n      click: () => {\n        BrowserWindow.getFocusedWindow().webContents.send('lang', 'rus')\n      }\n    },\n    // {\n    //   label: \"TIB\",\n    //   click: () => {\n    //     BrowserWindow.getFocusedWindow().webContents.send('lang', 'tib')\n    //   }\n    // },\n    // {\n    //   label: \"ZHO\",\n    //   click: () => {\n    //     BrowserWindow.getFocusedWindow().webContents.send('lang', 'zho')\n    //   }\n    // }\n  ]\n};\n","import { app, BrowserWindow } from \"electron\";\n\nexport const engMenuTemplate = {\n  label: \"ENG\",\n  submenu: [\n    {\n      label: \"DEU\",\n      click: () => {\n        BrowserWindow.getFocusedWindow().webContents.send('lang', 'deu')\n      }\n    },\n    {\n      label: \"RUS\",\n      click: () => {\n        BrowserWindow.getFocusedWindow().webContents.send('lang', 'rus')\n      }\n    },\n    // {\n    //   label: \"TIB\",\n    //   click: () => {\n    //     BrowserWindow.getFocusedWindow().webContents.send('lang', 'tib')\n    //   }\n    // },\n    // {\n    //   label: \"ZHO\",\n    //   click: () => {\n    //     BrowserWindow.getFocusedWindow().webContents.send('lang', 'zho')\n    //   }\n    // }\n  ]\n};\n","import { app, BrowserWindow, ipcRenderer } from \"electron\";\n\nexport const rusMenuTemplate = {\n  label: \"RUS\",\n  submenu: [\n    {\n      label: \"DEU\",\n      click: () => {\n        BrowserWindow.getFocusedWindow().webContents.send('lang', 'deu')\n      }\n    },\n    {\n      label: \"ENG\",\n      click: () => {\n        BrowserWindow.getFocusedWindow().webContents.send('lang', 'eng')\n      }\n    },\n    // {\n    //   label: \"TIB\",\n    //   click: () => {\n    //     BrowserWindow.getFocusedWindow().webContents.send('lang', 'tib')\n    //   }\n    // },\n    // {\n    //   label: \"ZHO\",\n    //   click: () => {\n    //     BrowserWindow.getFocusedWindow().webContents.send('lang', 'zho')\n    //   }\n    // }\n  ]\n};\n","import { app, BrowserWindow, ipcRenderer } from \"electron\";\n\nexport const zhoMenuTemplate = {\n  label: \"ZHO\",\n  submenu: [\n    {\n      label: \"ENG\",\n      click: () => {\n        BrowserWindow.getFocusedWindow().webContents.send('lang', 'eng')\n      }\n    },\n    {\n      label: \"DEU\",\n      click: () => {\n        BrowserWindow.getFocusedWindow().webContents.send('lang', 'deu')\n      }\n    },\n    {\n      label: \"RUS\",\n      click: () => {\n        BrowserWindow.getFocusedWindow().webContents.send('lang', 'rus')\n      }\n    },\n    {\n      label: \"TIB\",\n      click: () => {\n        BrowserWindow.getFocusedWindow().webContents.send('lang', 'tib')\n      }\n    }\n  ]\n};\n","const Menu = require('electron').Menu;\n// import env from \"env\";\nconst log = console.log\n\nimport { fileMenuTemplate } from \"./file_menu_template\";\nimport { bookMenuTemplate } from \"./book_menu_template\";\nimport { dictMenuTemplate } from \"./dict_menu_template\";\nimport { aboutMenuTemplate } from \"./about_menu_template\";\n// import { editMenuTemplate } from \"./edit_menu_template\";\nimport { helpMenuTemplate } from \"./help_menu_template\";\n\nimport { deuMenuTemplate } from \"./lang_deu_menu_template\";\nimport { engMenuTemplate } from \"./lang_eng_menu_template\";\nimport { rusMenuTemplate } from \"./lang_rus_menu_template\";\nimport { zhoMenuTemplate } from \"./lang_zho_menu_template\";\n\n// const menu = null;\n// const platform = process.platform;\n\nexport function MenuFactory(lang) {\n  const menus = [fileMenuTemplate(), bookMenuTemplate(), dictMenuTemplate(), aboutMenuTemplate(), helpMenuTemplate()];\n\n  // if (env.name !== \"production\") {\n  //   menus.push(devMenuTemplate);\n  // }\n  // menus.push(langMenuTemplate);\n\n  switch(lang) {\n  case 'eng':\n    menus.push(engMenuTemplate);\n    break\n  case 'deu':\n    menus.push(deuMenuTemplate);\n    break\n  case 'rus':\n    menus.push(rusMenuTemplate);\n    break\n  case 'zho':\n    menus.push(zhoMenuTemplate);\n    break\n  default:\n    menus.push(engMenuTemplate);\n  }\n\n  Menu.setApplicationMenu(Menu.buildFromTemplate(menus));\n}\n","module.exports = require(\"book-epub2json\");;","module.exports = require(\"book-fb2json\");;","module.exports = require(\"book-md2json\");;","module.exports = require(\"book-pdf2json\");;","module.exports = require(\"electron\");;","module.exports = require(\"electron-store\");;","module.exports = require(\"fs-extra\");;","module.exports = require(\"os\");;","module.exports = require(\"path\");;","module.exports = require(\"url\");;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import path from \"path\";\nimport url from \"url\";\nimport { app, BrowserWindow, ipcMain, shell } from \"electron\";\n\nimport { config } from \"./config\";\n\n// import { fb2json } from '../../b/book-fb2json'\n// import { epub2json } from '../../b/book-epub2json'\n// import { md2json } from '../../b/book-md2json'\n// import { pdf2json } from '../../b/book-pdf2json'\nimport { fb2json } from 'book-fb2json'\nimport { epub2json } from 'book-epub2json'\nimport { md2json } from 'book-md2json'\nimport { pdf2json } from 'book-pdf2json'\n\nconst Store = require('electron-store')\nconst positionstore = new Store({name: 'bounds'})\nimport { MenuFactory } from \"./i18n/menu-factory\"\n\n// Special module holding environment variables which you declared\n// in config/env_xxx.json file.\n// import env from \"env\";\n\nconst createWindow = () => {\n  const mainWindow = new BrowserWindow({\n    width: 800,\n    height: 600,\n    webPreferences: {\n      enableRemoteModule: true,\n      nodeIntegrationInWorker: true,\n      nodeIntegration: true\n    }\n  });\n\n  let winBounds = positionstore.get('main') || mainWindow.getBounds()\n  mainWindow.setBounds(winBounds)\n\n  mainWindow.loadURL(\n    url.format({\n      pathname: path.join(__dirname, \"app.html\"),\n      protocol: \"file:\",\n      slashes: true\n    })\n  );\n\n  mainWindow.webContents.on('will-navigate', (event) => {\n    event.preventDefault()\n  })\n\n  mainWindow.webContents.openDevTools();\n  global.templates = {}\n  global.dgl = {}\n\n  mainWindow.on('close', () => {\n    positionstore.set('main', mainWindow.getBounds())\n  })\n  // mainWindow.on('resize', () => {\n  //   positionstore.set('main', mainWindow.getBounds())\n  // })\n\n  mainWindow.webContents.on('did-finish-load', () => {\n    let pckg = require('../package.json')\n    let name = pckg.name\n    let version = pckg.version\n    mainWindow.webContents.send('version', version )\n    mainWindow.setTitle([name, 'v.', version].join(' '))\n  })\n\n  ipcMain.on('importBook', async (event, data) => {\n    let bpath = data.bpath\n    let ext = path.extname(data.bpath)\n    if (!ext) return false\n    let type = ext.replace(/^\\./, '')\n    if (type == 'zip') type = bpath.split('.').slice(-2).join('.')\n\n    let action\n    if (type == 'epub') action = epub2json\n    else if (type == 'fb2') action = fb2json\n    else if (type == 'fb2.zip') action = fb2json\n    else if (type == 'pdf') action = pdf2json\n    // else if (type == 'html') action = html2json\n    else if (type == 'md') action = md2json\n    else return {descr: 'book extension should be .epub, .fb2, .fb2.zip, .md or .dgl'}\n\n    let result = await action(bpath)\n    result.type = type\n    result.bpath = bpath\n    if (data.orbid) result.orbid = data.orbid\n    mainWindow.webContents.send('importBookResult', result)\n  })\n}\n\n\nconst createPopup = () => {\n\n  const popupWindow = new BrowserWindow({\n    width: 200,\n    height: 300,\n    frame: false,\n    hasShadow: true,\n    show: false,\n    webPreferences: {\n      // enableRemoteModule: true,\n      nodeIntegration: true\n    }\n  });\n\n  let popupBounds = positionstore.get('popup') || popupWindow.getBounds()\n  popupWindow.setBounds(popupBounds)\n\n  // and load the index.html of the app.\n  popupWindow.loadURL(\n    url.format({\n      pathname: path.join(__dirname, \"popup.html\"),\n      protocol: \"file:\",\n      slashes: true\n    })\n  );\n\n  // Open the DevTools.\n  // popupWindow.webContents.openDevTools();\n\n  popupWindow.webContents.on('will-navigate', (event) => {\n    event.preventDefault()\n  })\n\n  ipcMain.on('show-popup-window', (event, data) => {\n    popupWindow.show()\n    popupWindow.webContents.send('data', data)\n  })\n\n  ipcMain.on('hide-popup-window', (event) => {\n    popupWindow.hide()\n  })\n\n  popupWindow.on('close', () => {\n    positionstore.set('popup', popupWindow.getBounds())\n  })\n  // popupWindow.on('resize', () => {\n  //   positionstore.set('popup', popupWindow.getBounds())\n  // })\n}\n\n\napp.on(\"window-all-closed\", () => {\n  app.quit();\n});\n\napp.on(\"ready\", () => {\n  let lang = config.deflang\n  MenuFactory(lang)\n})\n\napp.on('ready', createPopup);\napp.on('ready', createWindow);\n\nipcMain.on('lang', (event, lang) => {\n  console.log('_LANG', lang)\n  MenuFactory(lang)\n})\n\nconst handleError = (title, error) => {\n  console.log('_B HE title', title)\n  console.log('_B HE ERR', error)\n}\n\nif (process.type === 'renderer') {\n\tconst errorHandler = _.debounce(error => {\n\t\thandleError('Unhandled Error', error);\n\t}, 200);\n\twindow.addEventListener('error', event => {\n\t\tevent.preventDefault();\n\t\terrorHandler(event.error || event);\n\t});\n\n\tconst rejectionHandler = _.debounce(reason => {\n\t\thandleError('Unhandled Promise Rejection', reason);\n\t}, 200);\n\twindow.addEventListener('unhandledrejection', event => {\n\t\tevent.preventDefault();\n\t\trejectionHandler(event.reason);\n\t});\n} else {\n\tprocess.on('uncaughtException', error => {\n\t\thandleError('Unhandled Error', error);\n\t});\n\n\tprocess.on('unhandledRejection', error => {\n\t\thandleError('Unhandled Promise Rejection', error);\n\t});\n}\n"],"sourceRoot":""}