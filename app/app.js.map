{"version":3,"sources":["webpack://diglossa.js/./src/app.js","webpack://diglossa.js/./src/autosync.js","webpack://diglossa.js/./src/book.js","webpack://diglossa.js/./src/bookmarks.js","webpack://diglossa.js/./src/config.js","webpack://diglossa.js/./src/dicts.js","webpack://diglossa.js/./src/exportBook.js","webpack://diglossa.js/./src/header.js","webpack://diglossa.js/./src/importBook.js","webpack://diglossa.js/./src/importDict.js","webpack://diglossa.js/./src/lib/load-templates.js","webpack://diglossa.js/./src/lib/message.js","webpack://diglossa.js/./src/lib/pouch.js","webpack://diglossa.js/./src/lib/progress.js","webpack://diglossa.js/./src/lib/stemmer.js","webpack://diglossa.js/./src/lib/tree.js","webpack://diglossa.js/./src/lib/utils.js","webpack://diglossa.js/./src/library.js","webpack://diglossa.js/./src/lookup.js","webpack://diglossa.js/./src/newtext.js","webpack://diglossa.js/./src/page.js","webpack://diglossa.js/./src/prefs.js","webpack://diglossa.js/./src/search.js","webpack://diglossa.js/./src/semaphore.js","webpack://diglossa.js/./src/css/compiled.css","webpack://diglossa.js/./src/css/index.css","webpack://diglossa.js/./src/css/tree.css","webpack://diglossa.js/./node_modules/css-loader/dist/runtime/api.js","webpack://diglossa.js/./src/css/compiled.css?5cb6","webpack://diglossa.js/./src/css/index.css?f7ea","webpack://diglossa.js/./src/css/tree.css?07e9","webpack://diglossa.js/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://diglossa.js/external \"book-md2json\"","webpack://diglossa.js/external \"dgl-utils\"","webpack://diglossa.js/external \"dict-sd2json\"","webpack://diglossa.js/external \"electron\"","webpack://diglossa.js/external \"electron-store\"","webpack://diglossa.js/external \"flexsearch\"","webpack://diglossa.js/external \"franc\"","webpack://diglossa.js/external \"fs-extra\"","webpack://diglossa.js/external \"glob\"","webpack://diglossa.js/external \"is-zip\"","webpack://diglossa.js/external \"json5\"","webpack://diglossa.js/external \"langs\"","webpack://diglossa.js/external \"lodash\"","webpack://diglossa.js/external \"mark.js\"","webpack://diglossa.js/external \"marked\"","webpack://diglossa.js/external \"mousetrap\"","webpack://diglossa.js/external \"natural\"","webpack://diglossa.js/external \"path\"","webpack://diglossa.js/external \"snowball-german\"","webpack://diglossa.js/external \"stopword\"","webpack://diglossa.js/webpack/bootstrap","webpack://diglossa.js/webpack/runtime/compat get default export","webpack://diglossa.js/webpack/runtime/define property getters","webpack://diglossa.js/webpack/runtime/hasOwnProperty shorthand","webpack://diglossa.js/webpack/runtime/make namespace object","webpack://diglossa.js/webpack/startup"],"names":["mouse","require","Store","appstore","name","dgl","remote","templates","routes","library","book","page","bookmarks","newtext","preference","dictionary","search","lookup","History","constructor","store","index","state","push","length","back","router","forward","log","hst","bind","ev","editMode","skip","closeAll","route","section","ready","render","template","selector","region","q","innerHTML","hideSearchIcon","ofn","parentElement","removeChild","progress","message","init","loadTemplates","initState","langs","books","filter","active","map","lang","alllangs","actives","find","shown","origin","trns","setSearchIcon","document","addEventListener","omessage","version","classList","contains","remove","shell","config","target","nodeName","ohref","closest","preventDefault","href","textContent","ctrlKey","owf","shiftKey","opage","delta","deltaY","scrollTop","osrc","hidden","scrolltop","height","clientHeight","ohr","style","width","ipcRenderer","event","get","loadSection","set","oldver","fetch","then","res","redirected","url","newver","_","split","replace","versionTxt","join","add","catch","err","console","oicon","searchicon","oinput","searchinput","handleError","title","error","process","type","errorHandler","window","rejectionHandler","reason","on","fse","natural","tokenizer","WordTokenizer","sw","start","oed","getFirstBlock","getAttribute","setLamps","autoSync","blockid","synced","nextLamp","otrn","sleep","scrollToPosition","offsetTop","checkBlock","oparsrc","querySelector","srclang","src","opartrn","trnlang","trn","oblock","srcwfs","wordforms","destwfs","limit","sizes","wfmax","wfmin","syncParagraphByStem_","Math","abs","stemmer_src","porter","stemmer_dest","srcstems","wf","expects","getStems","stemdicts","deststems","intersect","sdicts","ids","Promise","all","id","sdict","dicts","dict","stems","str","lang2","where","tokenize","removeStopwords","ms","resolve","setTimeout","startidx","blocks","qs","idx","block","ored","otrnpar","next","bkstore","csyncstore","bid","Error","csyncs","getCSyncs","srcbooks","sbooks","syncCnts","drawCont","showSearchIcon","header","forEach","sbook","bsyncs","csync","cnts","syncCnt","reSync","sync","csyncs2","semaphore","undo","slice","setPanes","roots","doc","level","oroots","createTree","oroot","appendChild","trnroots","getPanes","empty","layout","cnt","path","fakecnt","mess","prev","action","md","size","splice","opar","rotateBlock","par","cols","clear","bmkstore","bmk","newBmk","showBmks","orow","parseBmk","deleteBmk","key","delete","saveBmk","bmks","obmks","bidbmks","tmpl","cloneNode","setAttribute","ohead","oauthor","descr","author","otitle","osname","sname","docs","create","olistline","toggle","jump","pars","host","port","defstate","batch_size","pageSize","splitSizes","ldname","deflang","extpath","dictstore","dstore","parseDictionary","tbody","ditem","dname","oname","otype","olang","osize","queryDict","stem","rdicts","queryDB","firePopup","queryDictComplex","qstems","dictdocs","flsdocs","termdocs","queryDBcomplex","qstem","indecl","synths","plugin","synthesize","dictkeys","qdoc","rdict","altKey","parent","stemmer","getSiblings","el","wfs","pprev","nnext","previousElementSibling","nextElementSibling","siblings","stopword","toLowerCase","otable","odel","oparent","direction","deleteDict","moveRow","toggleActive","current","others","deleteDB","setDstore","step","sibling","app","apath","getAppPath","isZip","ftstore","prefstore","syncstore","ftsopts","getExportBook","checkBooks","createDglPackage","prefs","exportpath","ensureDirSync","packname","dirpath","dgls","syncs","getSyncs","sdocs","getSyncedDocs","mds","docs2md","mdstr","bidname","mdname","mdpath","writeFileSync","dgldescr","sep","dglpack","date","Date","toISOString","texts","jsonname","jsonpath","writeJsonSync","spaces","compressPackage","textsdir","dglpath","zip","compressDGL","generateNodeStream","streamFiles","pipe","createWriteStream","removeSync","backup","iszip","readFileSync","copySync","uncompressDGL","uncompressPackage","pack","text","filepath","obutton","rows","prefname","value","trim","query","fetchChapterDocs","syncdocs","chdocs","syncDoc","fillsize","toString","sdoc","_id","repeat","exportFtsIdxJson_","every","ftspath","chdoc","ftsidx","FlexSearch","json","export","createExternalPackage_","libook","external_dir","ftspack","packpath","jsondocs","bids","ddoc","book_dir","emptyDirSync","pushDocs","jsondoc","updateDocs","setEmptyHeader","showLeftHeader","showRightHeader","showSimpleHeader","oheader","estyle","oleft","cntidx","oul","undefined","htext","oli","span","ohtext","children","child","nextpar","dialog","franc","JSON5","homepath","getPath","getImportBook","showOpenDialog","properties","filters","extensions","result","bpath","filePaths","ext","extname","importDgl","importDglJson","orbid","importBook","guessLang","test","imgs","half","newbook","parseBookInfo","parseCnts","setDocPath","pushImgs","counter","filled","prevheader","chapternum","headers","chaptesize","zerofill","footnote","info","cleanDname","parseBookByType","md2json","substring","lastIndexOf","dgljson","readFile","parse","packages","srcpath","saveDglBook","nonorigin","getimportDict","importStarDict","importDSLDict","sd2json","skey","Object","stemmed","values","saveDict","dsl2json","olddict","importJsonDict","dirname","docspath","readJsonSync","defaultStemmer","terms","term","jsons","marked","appendFile","tmplpath","tmpls","readdirSync","reExt","RegExp","spath","html","osec","omess","timer","show","color","auto","clearTimeout","wait","hide","upath","PouchDB","dpath","newDB","dbdict","pouchpath","pouch","indecls","keys","flskeys","termkeys","dbdicts","flex","flsdicts","termdicts","alldocs","fetchDocs","refstem","refdocs","refstems","lemmas","refdict","refdoc","time","exkeys","refs","examples","example","dbs","db","allDocs","include_docs","rdocs","row","rdoc","fetchFN","newDBdname","fetchRefs","showProgress","total","odprog","percent","round","fetchBlock_","opts","options","fetchBlock","params","param","fetchBook","close","fetchChapter","chpath","startkey","queries","chapter","chunks","chunk","bulkDocs","oks","ok","_rev","orig","put","img","putAttachment","data","_attachments","content_type","getImage","imgname","attachments","oprogress","german","PorterStemmerNl","PorterStemmer","PorterStemmerFa","PorterStemmerFr","StemmerId","PorterStemmerIt","StemmerJa","PorterStemmerNo","PorterStemmerPt","PorterStemmerRu","PorterStemmerEs","PorterStemmerSv","root","treeBlock","treePar","nextroot","chroots","osign","prepend","ochildren","ochild","levstyle","stopPropagation","hashCode","s","reduce","a","b","charCodeAt","sel","querySelectorAll","tag","createElement","recreateDiv","recreate","element","newElement","parentNode","replaceChild","ctext","createTextNode","space","br","oBR","div","p","hasChildNodes","lastChild","removeAll","els","findAncestor","cls","getCoords","rect","getBoundingClientRect","placePopup","coords","top","left","insertAfter","referenceNode","newNode","insertBefore","nextSibling","number","cleanStr","ndash","replaceEl","parentElem","innerElem","firstChild","fromHTML","previousSiblings","elem","sibs","previousSibling","splitByPhrases","selectParallelBooks","Boolean","libstore","bks","libidx","parseLib","stripes","isOrigin","includes","originBid","libbid","expandBook","orows","n","activate","setStore","deactivate","deleteBook","olangs","ocheck","oact","parseRow","oactlangs","actlangs","passives","oalllangs","glob","heappath","oheappath","focus","addRow","ovalue","olookup","ohelp","oheap","openHeappath","shift","fireImport","lookupBook","srcdir","restr","pattern","er","fns","req","fn","oresults","ocontainer","clipboard","Mark","copy","getChapters","chapters","syncChapters","drawPage","localquery","scroll","showPagePosition","getChapter","booksyncs","syncChapter","reload","localSearch","instance","unmark","done","mark","qblockid","context","recontext","markInstance","oBlock","aligns","parsePar","otrnBlock","trndoc","alignPars","newdoc","cindex","indexOf","head","tail","fake","opars","heights","scrollHeight","max","refnotes","JSON","stringify","imgsrc","wrapSpan","nodes","childNodes","node","nodeType","nodeValue","outerHTML","scrollByKey","keyCode","reftext","parid","ref","notes","ref_id","fntext","body","which","exitEditMode","removeEditStyle","tmp","omarks","saveEditChanges","osave","newsync","obody","opos","odata","initPrefs","oexportpath","files","defaults","email","homepage","license","keywords","opack","openDialogExportPath","depth","field","fts","importFts","langfts","bidfts","import","generateFTS","oprocent","originbid","qcnt","clean","cleans","idy","oquery","results","rstem","st","ftsres","randoms","parseBlock","dbdocs","dbdoc","hideSearchInput","showSearchInput","osearch","placeholder","oline","getElementById","onclick","escInput","hideSearchField","fireFTSearch","blur","getElementsByTagName","addEditStyle","setSemaphore","setCntSynchroMarks","ocircle","oright","osvg","oapp","osrcs","srcsize","trnsize","omark","synchronize","oblocks","trnk"],"mappings":"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AO,CAAC,uJAA2E;AAC7F,0BAA0B,mBAAO,CAAC,0HAAyD;;AAE3F;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;;AAIA,sC;;;;;;;;;;AClBA,UAAU,mBAAO,CAAC,uJAA2E;AAC7F,0BAA0B,mBAAO,CAAC,wHAAwD;;AAE1F;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;;AAIA,sC;;;;;;;;;;;AClBa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,uDAAuD;;AAEvD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;;AAEA,iBAAiB,wBAAwB;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,gBAAgB,KAAwC,GAAG,sBAAiB,GAAG,CAAI;;AAEnF;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,qEAAqE,qBAAqB,aAAa;;AAEvG;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA,yDAAyD;AACzD,GAAG;;AAEH;;;AAGA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA,0BAA0B;AAC1B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB,4BAA4B;AAC/C;AACA;AACA;AACA;;AAEA;;AAEA,oBAAoB,6BAA6B;AACjD;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,E;;;;;;;;;;;AC5QA,0C;;;;;;;;;;;ACAA,uC;;;;;;;;;;;ACAA,0C;;;;;;;;;;;ACAA,sC;;;;;;;;;;;ACAA,4C;;;;;;;;;;;ACAA,wC;;;;;;;;;;;ACAA,mC;;;;;;;;;;;ACAA,sC;;;;;;;;;;;ACAA,kC;;;;;;;;;;;ACAA,oC;;;;;;;;;;;ACAA,mC;;;;;;;;;;;ACAA,mC;;;;;;;;;;;ACAA,oC;;;;;;;;;;;ACAA,qC;;;;;;;;;;;ACAA,oC;;;;;;;;;;;ACAA,uC;;;;;;;;;;;ACAA,qC;;;;;;;;;;;ACAA,kC;;;;;;;;;;;ACAA,6C;;;;;;;;;;;ACAA,sC;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,gCAAgC,YAAY;WAC5C;WACA,E;;;;;WCPA;WACA;WACA;WACA;WACA,wCAAwC,yCAAyC;WACjF;WACA;WACA,E;;;;;WCPA,wF;;;;;WCAA;WACA;WACA;WACA,sDAAsD,kBAAkB;WACxE;WACA,+CAA+C,cAAc;WAC7D,E;;;;;UCNA;UACA;UACA;UACA","file":"app.js","sourcesContent":["'use strict'\n\n// import \"./css/tailwind.css\";\nimport \"./css/compiled.css\";\nimport \"./css/index.css\";\nimport \"./css/tree.css\";\n\nimport _ from 'lodash'\nimport { remote, ipcRenderer, shell } from \"electron\"\nimport { log, q, qs, remove } from './lib/utils'\nimport { progress } from './lib/progress'\nimport { message } from './lib/message'\nimport { loadTemplates, loadSection } from './lib/load-templates'\nimport { config } from \"./config\"\nimport { header, rotateBlock } from './header'\n\nconst mouse = require('mousetrap')\nconst Store = require('electron-store')\nconst appstore = new Store({name: 'app'})\n\nlet dgl = remote.getGlobal('dgl')\nimport { getExportBook } from './exportBook'\nimport { getImportBook } from './importBook'\nimport { getImportDict } from './importDict'\nlet templates = remote.getGlobal('templates')\n\nimport { library } from './library'\nimport { book } from './book'\nimport { page } from './page'\nimport { bookmarks } from './bookmarks'\nimport { newtext } from './newtext'\nimport { preference } from './prefs'\nimport { dictionary } from './dicts'\nimport { search } from './search'\nimport { lookup } from './lookup'\n\n// const { app } = require('electron').remote\n// let homepath = app.getPath('home')\n// let lang = appstore.get('lang') || config.deflang\nconst routes = { library, book, page, bookmarks, newtext, preference, dictionary, search, lookup }\n\nclass History {\n  constructor() {\n    this.store = [],\n    this.index = 0\n  }\n  get state() {\n    return this.store[this.index]\n  }\n  set state(state) {\n    this.store.push(state)\n    this.index = this.store.length -1\n  }\n  back() {\n    if (this.index) this.index--, router(this.state, true) // чтобы не запомнить\n    // if (this.index) this.index--, router(this.state)\n  }\n  forward() {\n    if (this.index < this.store.length-1) this.index++, router(this.state, true)\n    // if (this.index < this.store.length-1) this.index++, router(this.state)\n  }\n  log() {\n    log('HST:', this)\n  }\n}\n\nlet hst = new History()\n\nmouse.bind(['alt+left'], function(ev) {\n  if (dgl.editMode) return\n  hst.back()\n})\n\nmouse.bind(['alt+right'], function(ev) {\n  if (dgl.editMode) return\n  hst.forward()\n})\n\nexport const router = async (state, skip) => {\n  closeAll()\n  if (!skip) hst.state = state\n  dgl.route = state.route\n  let section = routes[state.route]\n  await section.ready(state)\n}\n\nexport function render(template, selector = '#app') {\n  const region = q(selector)\n  region.innerHTML = templates[template]\n  hideSearchIcon()\n}\n\nfunction closeAll() {\n  let ofn = q('#footnote')\n  if (ofn) ofn.parentElement.removeChild(ofn)\n  // let oimgs = qs('img.floating')\n  // oimgs.forEach(el => { el.parentElement.removeChild(el) })\n  progress.hide()\n  message.hide()\n  page.localquery = ''\n  // hideSearchIcon()\n}\n\n;(async function init() {\n  await loadTemplates()\n  const initState = {route: 'library'}\n  dgl.langs = (books) => books.filter(book=> book.active).map(book=> book.lang),\n  dgl.alllangs = (books) => books.map(book=> book.lang),\n  dgl.actives = (books) => {\n    books = books.filter(book=> book.active)\n    if (books.length > 1 && !books.find(book=> book.shown)) books[1].shown = true\n    return books\n  }\n  dgl.origin = (books) => books.find(book=> book.origin), // origin always active\n  dgl.shown = (books) => books.filter(book=> book.active).find(book=> book.shown),\n  dgl.trns = (books) => books.filter(book=> book.active && !book.origin)\n\n  router(initState)\n  setSearchIcon()\n  render('message', '#message')\n})()\n\ndocument.addEventListener (\"click\",  (ev) => {\n  const omessage = q('#message-text')\n  let version = omessage.classList.contains('version')\n  if (version) {\n    omessage.classList.remove('version')\n    shell.openExternal(config.version)\n  }\n  // message.hide()\n  if (ev.target.nodeName == 'BUTTON') return\n  if (ev.target.nodeName == 'A') return\n  let ohref = ev.target.closest('.external')\n  if (!ohref) return\n  ev.preventDefault()\n  let href = ohref.textContent\n  if (!href) return\n  shell.openExternal(href)\n})\n\ndocument.addEventListener (\"click\",  (ev) => {\n  if (ev.ctrlKey) return\n  if (dgl.editMode) return\n  let owf = ev.target.closest('span.wf')\n  if (!owf) return\n  ev.preventDefault()\n  let href = owf.textContent\n  if (!href) return\n  href = 'http://diglossa.org/' + href\n  shell.openExternal(href)\n})\n\n\n// scroll page\ndocument.addEventListener(\"wheel\", function(ev) {\n  if (ev.shiftKey) return\n  const opage = q('.page') // || q('.section') // todo: del\n  if (!opage) return\n  let delta = (ev.deltaY > 0) ? 24 : -24\n  opage.scrollTop += delta\n\n  const osrc = q('#src')\n  if (!osrc) return\n  let hidden = osrc.classList.contains('hidden')\n  if (hidden) osrc = q('#trn')\n  let scrolltop = opage.scrollTop\n  let height  = osrc.clientHeight\n  let ohr = q('.show-page-position')\n  if (!ohr) return\n  ohr.style.width = (scrolltop/height)*100 + '%'\n  if (dgl.route == 'book') ohr.style.width = 0\n})\n\nmouse.bind('esc', function(ev) {\n  ipcRenderer.send('hide-popup-window')\n  // exitEditMode()\n  closeAll()\n})\n\nmouse.bind('ctrl+v', function(ev) {\n  let state = {route: 'newtext'}\n  router(state)\n})\n\nmouse.bind('ctrl+d', function(ev) {\n  router({route: 'dictionary'})\n})\n\nipcRenderer.on('route', function (event, route) {\n  router({route})\n})\n\nipcRenderer.on('section', function (event, route) {\n  let lang = appstore.get('lang') || config.deflang\n  loadSection(lang, route)\n})\n\n\nipcRenderer.on('lang', function (event, lang) {\n  appstore.set('lang', lang)\n  ipcRenderer.send('lang', lang)\n})\n\nipcRenderer.on('version', async function (event, oldver) {\n  fetch(config.version)\n    .then(res=> {\n      let redirected = res.url\n      let newver = _.last(redirected.split('/'))\n      if (!newver) return\n      newver = newver.replace(/v/g, '')\n      if (oldver && newver && newver > oldver) {\n        let versionTxt = ['new version available:', newver].join(' ')\n        message.show(versionTxt, 'darkgreen', true)\n        const omessage = q('#message-text')\n        omessage.classList.add('version')\n        // let omessage = omess.querySelector('#message-text')\n        // progress.hide()\n        // omess.classList.remove('hidden')\n        // omessage.classList.remove('darkred')\n        // omessage.textContent = versionTxt\n      }\n    })\n    .catch(err=> {\n      console.log('FETCH VERSION ERR', err)\n    })\n})\n\n// todo: del ================== DEL\nmouse.bind('ctrl+l', function(ev) {\n  ev.preventDefault()\n  const state = {route: 'library'}\n  router(state)\n})\n\nfunction hideSearchIcon() {\n  q('#search-icon').classList.add('hidden')\n  q('#search-input').classList.add('hidden')\n}\n\nfunction setSearchIcon() {\n  let oicon = q('#search-icon')\n  oicon.innerHTML = templates.searchicon\n  let oinput = q('#search-input')\n  oinput.innerHTML = templates.searchinput\n}\n\n\nconst handleError = (title, error) => {\n  log('_HANDLE ERR title', title)\n  log('_HANDLE ERR', error)\n}\n\nif (process.type === 'renderer') {\n\tconst errorHandler = _.debounce(error => {\n\t\thandleError('Unhandled Error', error);\n\t}, 200);\n\twindow.addEventListener('error', event => {\n\t\tevent.preventDefault();\n\t\terrorHandler(event.error || event);\n\t});\n\n\tconst rejectionHandler = _.debounce(reason => {\n\t\thandleError('Unhandled Promise Rejection', reason);\n\t}, 200);\n\twindow.addEventListener('unhandledrejection', event => {\n\t\tevent.preventDefault();\n\t\trejectionHandler(event.reason);\n\t});\n} else {\n\tprocess.on('uncaughtException', error => {\n\t\thandleError('Unhandled Error', error);\n\t});\n\n\tprocess.on('unhandledRejection', error => {\n\t\thandleError('Unhandled Promise Rejection', error);\n\t});\n}\n","'use strict';\n\nimport _ from 'lodash'\nimport { log, q, qs, previousSiblings, scrollToPosition } from './lib/utils'\nimport { render } from './app'\nconst mouse = require('mousetrap')\nimport { message } from './lib/message'\nimport { header } from './header'\nconst fse = require('fs-extra')\nimport { porter } from './lib/stemmer'\n\nconst Store = require('electron-store')\n\nconst natural = require('natural')\nconst tokenizer = new natural.WordTokenizer()\nconst sw = require('stopword')\nconst langs = require('langs')\n\nimport { remote } from \"electron\"\nlet dgl = remote.getGlobal('dgl')\n\nimport { page } from './page'\nimport { book } from './book'\n\n// let stemdictpath = '/home/michael/b/synchro.js/dicts/dict-stems-eng-rus.json'\n// let stemdicts = fse.readJsonSync(stemdictpath)\n\nmouse.bind('ctrl+y', function(ev) {\n  if (!dgl.editMode) return\n  if (book.sbooks.length < 2) return\n  let start = 0\n  let oed = getFirstBlock()\n  if (!oed) return\n  start = oed.getAttribute('blockid')*1\n  setLamps(start)\n  autoSync(start)\n})\n\nasync function autoSync(blockid) {\n  let synced = true\n  while (synced) {\n    synced = await nextLamp(blockid)\n    blockid++\n  }\n}\n\nfunction nextLamp(blockid) {\n  let osrc = q(['#src .block[blockid=\"', blockid, '\"]'].join(''))\n  let otrn = q(['#trn .block[blockid=\"', blockid, '\"]'].join(''))\n  if (!osrc || !otrn) return false\n  otrn.classList.remove('em-red-circle')\n  return sleep(1000)\n    .then(async ()=> {\n      scrollToPosition(osrc.offsetTop - 100)\n      // let synced = await syncParagraphByStem(osrc, otrn)\n      let synced = await checkBlock(osrc, otrn)\n      if (synced) otrn.classList.add('em-green-circle')\n      else otrn.classList.add('em-red-circle')\n      return synced\n    })\n}\n\nasync function checkBlock(osrc, otrn) {\n  let oparsrc = osrc.querySelector('p.ptext:not(.hidden)')\n  let srclang = oparsrc.getAttribute('lang')\n  let src = oparsrc.textContent\n  let opartrn = otrn.querySelector('p.ptext:not(.hidden)')\n  let trnlang = opartrn.getAttribute('lang')\n  let trn = opartrn.textContent\n\n  // log XXX\n  let oblock = otrn.closest('.block')\n  let blockid = oblock.getAttribute('blockid')\n\n  let srcwfs = wordforms(src, srclang)\n  let destwfs = wordforms(trn, trnlang)\n  let limit = 10\n  let sizes = [srcwfs.length, destwfs.length]\n\n  let wfmax = _.max(sizes)\n  let wfmin = _.min(sizes)\n\n  if (wfmax < limit) return true\n  if (wfmax/wfmin > 2) return false\n  else return true\n}\n\nasync function syncParagraphByStem_(osrc, otrn) {\n  let oparsrc = osrc.querySelector('p.ptext:not(.hidden)')\n  let srclang = oparsrc.getAttribute('lang')\n  let src = oparsrc.textContent\n  let opartrn = otrn.querySelector('p.ptext:not(.hidden)')\n  let trnlang = opartrn.getAttribute('lang')\n  let trn = opartrn.textContent\n\n  let srcwfs = wordforms(src, srclang)\n  let destwfs = wordforms(trn, trnlang)\n\n  let limit = 10\n  if (Math.abs(srcwfs.length - destwfs.length)/srcwfs.length > 0.5 ) return false\n  else if (srcwfs.length < limit && destwfs.length < limit ) return true\n\n  let stemmer_src = porter(srclang)\n  let stemmer_dest = porter(trnlang)\n  let srcstems = srcwfs.map(wf=> stemmer_src ? stemmer_src(wf) : wf)\n  let expects = await getStems(stemdicts, srcstems)\n\n  let deststems = destwfs.map(wf=> stemmer_dest ? stemmer_dest(wf) : wf)\n  let intersect = _.intersection(expects, deststems)\n  return intersect.length ? true : false\n}\n\nfunction getStems(sdicts, ids) {\n  return Promise.all(ids.map(function(id) {\n    return sdicts.find(sdict=> sdict.id == id)\n  }))\n    .then(dicts=> {\n      return _.flatten(_.compact(dicts).map(dict=> dict.stems))\n    })\n}\n\nfunction wordforms(str, lang) {\n  let lang2 = ''\n  lang2 = langs.where('3', lang)\n  if (!lang2) return []\n  lang2 = lang2[1]\n  let srcwfs = tokenizer.tokenize(str)\n  srcwfs = sw.removeStopwords(srcwfs, sw[lang2])\n  return _.uniq(srcwfs)\n}\n\nconst sleep = ms => {\n  return new Promise(resolve=> {\n    setTimeout(() => resolve(), ms)\n  })\n}\n\nexport function getFirstBlock() {\n  const oblock = q('.block:hover')\n  // const oblock = q('.editable')\n  if (!oblock) message.show('select paragraph to start', 'darkred')\n  return oblock\n}\n\nfunction setLamps(startidx) {\n  let blocks = qs('#trn .block')\n  let idx = 0\n  for (let block of blocks) {\n    if (idx < startidx) block.classList.add('em-green-circle'), block.classList.remove('em-red-circle')\n    // else if (idx == startidx) block.classList.remove('em-green-circle'), block.classList.add('em-red-circle')\n    else block.classList.remove('em-green-circle'), block.classList.remove('em-red-circle')\n    idx++\n  }\n}\n\nmouse.bind('space', function(ev) {\n  let ored = q('.em-red-circle')\n  if (!ored) return\n  let otrnpar = ored.closest('.block')\n  let blockid = otrnpar.getAttribute('blockid')\n  let next = blockid*1 + 1\n  log('_blockid', blockid)\n  setLamps(next)\n  autoSync(next)\n})\n","'use strict'\n\nimport { router, render } from './app'\nimport _ from 'lodash'\nimport { remote } from \"electron\"\nimport { log, q, qs, create, remove, empty, insertAfter } from './lib/utils'\nimport { progress } from './lib/progress'\nimport { message } from './lib/message'\nimport { page } from './page'\nimport { header, rotateBlock } from './header'\nimport { semaphore } from './semaphore'\nimport { createTree } from './lib/tree'\n\nconst mouse = require('mousetrap')\nconst Store = require('electron-store')\nconst bkstore = new Store({name: 'libks'})\nconst csyncstore = new Store({name: 'csyncs'})\nlet dgl = remote.getGlobal('dgl')\n\nexport const book = {\n  async ready(state) {\n    progress.show()\n    render('book')\n    delete dgl.idx\n    let books\n    if (state && state.bid) {\n      books = bkstore.get(state.bid)\n      books = dgl.actives(books)\n    } else {\n      throw new Error('_BOOK NO STATE')\n    }\n    let csyncs = getCSyncs(state.bid)\n    this.srcbooks = books\n    this.sbooks = this.syncCnts(this.srcbooks, csyncs)\n    this.drawCont()\n    showSearchIcon()\n    header.ready()\n    progress.hide()\n  },\n  origin() {\n    return this.sbooks.find(book=> book.origin)\n  },\n  shown() {\n    return this.sbooks.find(book=> book.shown)\n  },\n  syncCnts(sbooks, csyncs) {\n    sbooks = _.cloneDeep(sbooks)\n    sbooks.forEach(sbook=> {\n      let bsyncs = csyncs.filter(csync=> csync.bid == sbook.bid)\n      bsyncs.forEach(csync=> {\n        sbook.cnts = syncCnt(sbook.cnts, csync)\n      })\n    })\n    return sbooks\n  },\n  reSync(sync) {\n    let sbook = this.sbooks.find(book=> book.bid == sync.bid)\n    sbook.cnts = syncCnt(sbook.cnts, sync)\n    let origin = book.sbooks.find(sbook=> sbook.origin)\n    let csyncs = getCSyncs(origin.bid)\n    csyncs.push(sync)\n    csyncstore.set(dgl.bid, csyncs)\n    let csyncs2 = getCSyncs(sbook.bid)\n    semaphore.ready()\n    this.drawCont()\n  },\n  undo() {\n    let csyncs = getCSyncs(dgl.bid)\n    csyncs = csyncs.slice(0,-1)\n    this.sbooks = this.syncCnts(this.srcbooks, csyncs)\n    csyncstore.set(dgl.bid, csyncs)\n    semaphore.ready()\n    this.drawCont()\n  },\n  drawCont() {\n    let books = this.sbooks\n    let {osrc, otrn} = setPanes(books)\n    const src = dgl.origin(books)\n\n    let roots = _.filter(src.cnts, doc=> doc.level == 1)\n    let oroots = createTree(src.cnts, roots, [src])\n    oroots.forEach(oroot=> osrc.appendChild(oroot))\n\n    const trn = dgl.shown(books)\n    if (!trn) return\n    let trnroots = _.filter(trn.cnts, doc=> doc.level == 1)\n    const trns = dgl.trns(books)\n    oroots = createTree(trn.cnts, trnroots, trns)\n    oroots.forEach(oroot=> otrn.appendChild(oroot))\n  }\n }\n\nexport function getCSyncs(bid) {\n  let csyncs = csyncstore.get(bid)\n  if (_.isEmpty(csyncs)) csyncs = []\n  return csyncs\n}\n\nfunction setPanes(books) {\n  let {osrc, otrn} = getPanes()\n  empty(osrc)\n  empty(otrn)\n  let opage = document.querySelector('.page')\n  if (books.length == 1) {\n    opage.classList.remove('grid-cols-2')\n    otrn.classList.add('hidden')\n  } else if (book.layout) {\n    opage.classList.remove('grid-cols-2')\n    if (book.layout == 'src') {\n      osrc.classList.remove('hidden')\n      otrn.classList.add('hidden')\n    }  else if (book.layout == 'trn') {\n      osrc.classList.add('hidden')\n      otrn.classList.remove('hidden')\n    }\n  } else {\n    opage.classList.add('grid-cols-2')\n    osrc.classList.remove('hidden')\n    otrn.classList.remove('hidden')\n  }\n  return {osrc, otrn}\n}\n\nfunction getPanes() {\n  let osrc = q('#src')\n  let otrn = q('#trn')\n  return {osrc, otrn}\n}\n\n// todo: export - del\nexport function syncCnt(cnts, sync) {\n  let cnt = cnts.find(cnt=> cnt.path == sync.path)\n  if (!cnt) return cnts\n  let fakecnt, mess, next, prev\n\n  switch(sync.action) {\n  case 'delete':\n    cnts = cnts.filter(cnt=> cnt.path != sync.path)\n    break\n  case 'right':\n    cnt.level += 1\n    break\n  case 'mergeNext':\n    next = cnts[cnt.idx+1]\n    if (!next) return cnts\n    let md = [cnt.md, '.'].join('').replace('..', '.')\n    cnt.md = [md, next.md].join(' ')\n    cnt.size = cnt.size + next.size\n    cnts = cnts.filter(cnt=> cnt.path != next.path)\n    break\n  case 'insertAfter':\n    fakecnt = _.clone(cnt)\n    fakecnt.md = 'x'\n    fakecnt.size = 1\n    cnts.splice(cnt.idx+1, 0, fakecnt)\n    break\n  case 'insertBefore':\n    fakecnt = _.clone(cnt)\n    fakecnt.md = 'x'\n    fakecnt.size = 1\n    cnts.splice(cnt.idx, 0, fakecnt)\n    break\n  case 'empty':\n    cnt.size = 1\n    mess = ['s_ection', cnt.md, 'emptied'].join(' ')\n    message.show(mess,'darkgreen')\n    break\n  case 'copy':\n    fakecnt = _.clone(cnt)\n    fakecnt.md = 'x - copied s_ection'\n    cnts.splice(cnt.idx+1, 0, fakecnt)\n    break\n  case 'action':\n    break\n  case 'action':\n    break\n  default:\n  }\n\n  cnts.forEach((cnt, idx)=> cnt.idx = idx)\n  return cnts\n}\n\n// router jump to page\ndocument.addEventListener (\"click\",  (ev) => {\n  if (dgl.route != 'book') return\n  if (dgl.editMode) return\n  let opar = ev.target.closest('p.tree-text')\n  if (!opar) return\n  const idx = opar.getAttribute('idx') * 1\n  const state = {route: 'page', bid: dgl.bid, idx}\n  router(state) // to-page\n})\n\n// switch shown lang\ndocument.addEventListener(\"wheel\", function(ev) {\n  if (!ev.shiftKey) return\n  if (dgl.route != 'book') return\n  let oblock = ev.target.closest('.block')\n  if (!oblock) return\n  rotateBlock(oblock)\n\n  oblock = ev.target.closest('.header-cell.right .block') // header block\n  if (!oblock) return\n  let par = oblock.querySelector('p.headline:not(.hidden)')\n  let bid = par.getAttribute('bid')\n\n  for (let sbook of book.sbooks) {\n    if (sbook.origin) continue\n    sbook.shown = false\n    if (sbook.bid == bid) sbook.shown = true\n  }\n  book.drawCont()\n})\n\nmouse.bind('1', function(ev) {\n  if (!book || book.sbooks.length <= 1) return\n  let opage = q('.page')\n  if (!opage) return\n  let cols = opage.classList.contains('grid-cols-2') // both panes shown\n  if (cols) book.layout = 'src'\n  else book.layout = false\n  if (dgl.route == 'book') book.drawCont()\n  else if (dgl.route == 'page') page.drawPage()\n})\n\nmouse.bind('2', function(ev) {\n  if (!book || book.sbooks.length <= 1) return\n  let opage = q('.page')\n  if (!opage) return\n  let cols = opage.classList.contains('grid-cols-2')\n  if (cols) book.layout = 'trn'\n  else book.layout = false\n  if (dgl.route == 'book') book.drawCont()\n  else if (dgl.route == 'page') page.drawPage()\n})\n\nmouse.bind('3', function(ev) {\n  // todo: change page panes\n  // _как 3 отразится на fts, exports, etc?_'\n})\n\nfunction showSearchIcon() {\n  q('#search-icon').classList.remove('hidden')\n}\n\n// todo: del\nmouse.bind('ctrl+i', function(ev) {\n  console.clear()\n  log('_B:', book.sbooks)\n})\n","'use strict'\n\nimport { log, q, qs, create, empty } from './lib/utils'\nimport { ipcRenderer } from \"electron\";\nimport _ from 'lodash'\nimport { router, render } from './app'\nconst Store = require('electron-store')\nconst bmkstore = new Store({name: 'bookmarks'})\nconst mouse = require('mousetrap')\nimport { remote } from \"electron\"\nimport { rotateBlock } from './header'\nimport { book } from './book'\nlet dgl = remote.getGlobal('dgl')\n\nexport const bookmarks = {\n  async ready(state) {\n    render('bmks')\n    if (state && state.bmk) this.newBmk(state.bmk)\n    this.showBmks()\n  },\n\n  newBmk(bmk) {\n    this.bmk = bmk\n    let orow = q('#add-bmk .list-line')\n    parseBmk(orow, bmk)\n  },\n\n  deleteBmk(key) {\n    bmkstore.delete(key)\n    this.ready()\n  },\n\n  saveBmk() {\n    let key = [this.bmk.idx, this.bmk.blockid].join('-')\n    key = [this.bmk.bid, key].join('.')\n    bmkstore.set(key, this.bmk)\n    delete this.bmk\n    this.ready()\n  },\n\n  showBmks() {\n    let bmks = bmkstore.store\n    let obmks = q('#bmks-list')\n    empty(obmks)\n    for (const bid in bmks) {\n      let bidbmks = bmks[bid]\n      for (const key in bidbmks) {\n        let bmk = bidbmks[key]\n        let tmpl = q('.tmpl')\n        let orow = tmpl.cloneNode(true)\n        orow = parseBmk(orow, bmk)\n        obmks.appendChild(orow)\n      }\n    }\n  }\n}\n\nfunction parseBmk(orow, bmk) {\n  orow.classList.remove('tmpl')\n  orow.classList.remove('hidden')\n\n  orow.setAttribute('bid', bmk.bid)\n  orow.setAttribute('idx', bmk.idx)\n  orow.setAttribute('blockid', bmk.blockid)\n\n  let ohead = orow.querySelector('.line-head')\n  let oauthor = ohead.querySelector('.line-author')\n  oauthor.textContent = bmk.descr.author\n  let otitle = ohead.querySelector('.line-title')\n  otitle.textContent = bmk.descr.title\n  let osname = ohead.querySelector('.line-sname')\n  osname.textContent = bmk.descr.sname\n  ohead.classList.add('truncate')\n\n  let shown = true\n  let oblock = orow.querySelector('.block')\n  empty(oblock)\n  for (const doc of bmk.docs) {\n    let opar = create('p', 'ptext')\n    opar.setAttribute('lang', doc.lang)\n    opar.textContent = doc.md\n    if (shown) shown = false\n    else opar.classList.add('hidden')\n    oblock.appendChild(opar)\n  }\n  return orow\n}\n\n// jump\ndocument.addEventListener('click',  (ev) => {\n  if (dgl.route != 'bookmarks') return\n  const olistline = ev.target.closest('.list-line')\n  if (!olistline) return\n  const bid = olistline.getAttribute('bid')\n  const idx = olistline.getAttribute('idx')\n  const blockid = olistline.getAttribute('blockid')\n\n  if (ev.target.id == 'add-bmk-button') {\n    bookmarks.saveBmk();\n  } else if (ev.target.classList.contains('line-delete')) {\n    const key = [bid, idx, blockid].join('.')\n    bookmarks.deleteBmk(key)\n  }\n\n  const orow = ev.target.closest('.line-block')\n  if (orow) {\n    if (ev.target.classList.contains('ptext')) {\n      let oblock = orow.querySelector('.block')\n      oblock.classList.toggle('truncate')\n    } else {\n      const state = {route: 'page', bid, idx, blockid, jump: true}\n      router(state)\n    }\n  }\n})\n\ndocument.addEventListener(\"wheel\", function(ev) {\n  if (!ev.shiftKey) return\n  if (dgl.route != 'bookmarks') return\n  let oblock = ev.target.closest('.block')\n  if (!oblock) return\n  let next = rotateBlock(oblock)\n}, false)\n\n// jump bookmarks\nmouse.bind('ctrl+b', function(ev) {\n  const state = {route: 'bookmarks'}\n  const opar = q('p.ptext:hover')\n  if (opar && dgl.idx) {\n    const oblock = opar.closest('.block')\n    const blockid = oblock.getAttribute('blockid')\n    const origin = _.find(book.sbooks, book=> book.origin)\n    const descr = {title: origin.descr.title, author: origin.descr.author}\n    descr.sname = origin.cnts[dgl.idx].md\n    let selector = ['.block[blockid=\"', blockid, '\"] .ptext'].join('')\n    let pars = qs(selector)\n    const docs = _.map(pars, opar=> { return {md: opar.textContent, lang: opar.getAttribute('lang')}})\n    const bmk = {bid: dgl.bid, idx: dgl.idx, blockid, descr, docs}\n    state.bmk = bmk\n  }\n  router(state)\n})\n","//\n\nexport const config = {\n  host: 'http://diglossa.org',\n  port: '5984',\n  version: 'https://github.com/mbykov/diglossa.js/releases/latest',\n  defstate: 'library',\n  batch_size: 1000,\n  pageSize: 25,\n  splitSizes: [100, 0],\n  langs: ['eng', 'deu', 'rus'],\n  ldname: 'local',\n  deflang: 'eng',\n  extpath: './diglossa.export.fts'\n}\n","'use strict'\n\nimport { log, q, create } from './lib/utils'\nimport { ipcRenderer } from \"electron\";\nimport _ from 'lodash'\nimport { render } from './app'\nconst Store = require('electron-store')\nconst dictstore = new Store({name: 'dicts'})\nimport { queryDB, queryDBcomplex, deleteDB } from \"./lib/pouch\";\n// siblings\n// const langs = require('langs')\n// const stopword = require('stopword')\nconst mouse = require('mousetrap')\nimport { message } from './lib/message'\nimport { progress } from './lib/progress'\nimport { porter } from './lib/stemmer'\n\nexport const dictionary = {\n  async ready(state) {\n    render('dicts')\n    this.dstore = dictstore.store\n    this.dicts = _.values(dictstore.store)\n    this.parseDictionary()\n    progress.hide()\n  },\n  parseDictionary() {\n    const tbody = q('#dict-table .tbody')\n    let dicts = this.dicts\n    for (let ditem of dicts) {\n      let dname = ditem.dname\n      let dict = _.find(dicts, dict=> dict.dname == dname)\n      const tmpl = q('.table-line.tmpl')\n      const orow = tmpl.cloneNode(true)\n      orow.classList.remove('tmpl')\n      orow.setAttribute('dname', dname)\n      let oname = orow.querySelector('.td-name')\n      oname.textContent = dict.name\n      let otype = orow.querySelector('.td-type')\n      otype.textContent = dict.type\n      let olang = orow.querySelector('.td-lang')\n      olang.textContent = dict.lang\n      let osize = orow.querySelector('.td-size')\n      osize.textContent = dict.size\n      tbody.appendChild(orow)\n    }\n  },\n  async queryDict(wf, stem, dstore) {\n    let rdicts = await queryDB(stem, dstore)\n    firePopup(wf, rdicts)\n  },\n\n  //  τῆς δὲ ἀρχὴ τὰ\n  async queryDictComplex(wf, qstems, dstore) {\n    let {dictdocs, flsdocs, termdocs} = await queryDBcomplex(qstems, dstore)\n    qstems = qstems.filter(qstem=> !qstem.indecl)\n    let synths = plugin.synthesize(qstems, dictdocs, flsdocs)\n    synths.push(...termdocs)\n\n    let dictkeys = {}\n    synths.forEach(qdoc=> {\n      if (!dictkeys[qdoc.dname]) dictkeys[qdoc.dname] = [qdoc]\n      else dictkeys[qdoc.dname].push(qdoc)\n    })\n\n    let rdicts = []\n    for (let dname in dictkeys) {\n      let rdict = {wf, dname, dicts: dictkeys[dname]}\n      rdicts.push(rdict)\n    }\n\n    if (rdicts.length) ipcRenderer.send('show-popup-window', rdicts)\n    else ipcRenderer.send('hide-popup-window')\n  }\n}\n\nfunction firePopup(wf, docs) {\n  let dictkeys = {}\n  docs.forEach(qdoc=> {\n    if (!dictkeys[qdoc.dname]) dictkeys[qdoc.dname] = [qdoc]\n    else dictkeys[qdoc.dname].push(qdoc)\n  })\n\n  let rdicts = []\n  for (let dname in dictkeys) {\n    let rdict = {wf, dname, dicts: dictkeys[dname]}\n    rdicts.push(rdict)\n  }\n\n  if (rdicts.length) ipcRenderer.send('show-popup-window', rdicts)\n  else ipcRenderer.send('hide-popup-window')\n}\n\ndocument.addEventListener(\"mouseover\", function(ev) {\n  if (!ev.altKey || !q('.page')) return\n  let target = ev.target\n  if (target.nodeName != 'SPAN') return\n  let parent = target.closest('p.ptext')\n  if (!parent) return\n  let lang = parent.getAttribute('lang')\n  let wf = target.textContent\n\n  let dicts = _.values(dictstore.store)\n  if (!ev.shiftKey) dicts = _.filter(dicts, dict=> dict.lang == lang)\n\n  if (!dicts.length) {\n    let mess = ['dictionaries for the', lang, 'language are not installed'].join(' ')\n    message.show(mess, 'darkgreen')\n    return\n  }\n\n  const stemmer = porter(lang)\n  const stem = stemmer ? stemmer(wf) : wf\n// let siblings = getSiblings(target, lang)\n\n  // todo: plugin\n  dictionary.queryDict(wf, stem, dicts)\n  if (lang == 'grc') {\n    // const qstems = stemmerGrc(wf)\n    // dictionary.queryDictComplex(wf, qstems, dicts)\n  }\n})\n\n// todo: langs и stopword заменить на natural\nfunction getSiblings(el, lang) {\n  let lang2 = langs.where('3', lang)\n  if (lang2) lang2 = lang2[1]\n  const wfs = []\n  let prev, pprev, next, nnext\n  prev = el.previousElementSibling\n  if (prev) wfs.push(prev.textContent), pprev = prev.previousElementSibling\n  if (pprev) wfs.push(pprev.textContent)\n  next = el.nextElementSibling\n  if (next) wfs.push(next.textContent), nnext = next.nextElementSibling\n  if (nnext)  wfs.push(nnext.textContent)\n  let siblings = stopword.removeStopwords(wfs, stopword[lang2])\n  siblings = siblings.map(wf=> { return wf.toLowerCase() })\n  return siblings\n}\n\ndocument.addEventListener('click',  (ev) => {\n  const otable = q('#dict-table')\n  if (!otable) return\n  let odel = ev.target.closest('.td-delete')\n  let oparent = ev.target.closest('.table-line')\n  if (!oparent) return\n  let dname = oparent.getAttribute('dname')\n  if (!dname) return\n  progress.show()\n  let direction = (ev.ctrlKey && ev.altKey) ? 'down' : (ev.ctrlKey) ? 'up' : null\n  if (odel) deleteDict(dname)\n  else if (direction) moveRow(dname, direction)\n  else toggleActive(dname)\n})\n\nasync function deleteDict(dname) {\n  const dicts = dictionary.dicts\n  if (!dicts.length) return\n  let current = _.find(dicts, dict=> dict.dname == dname)\n  const others = _.filter(dicts, dict=> dict.dname != dname)\n  await deleteDB(dname)\n  others.forEach((dict, idx)=> dict.idx = idx)\n  dictionary.dicts = others\n  setDstore(others)\n  let mess = ['dict', current.name, 'removed'].join(' ')\n  message.show(mess, 'darkgreen')\n}\n\nfunction moveRow(dname, direction) {\n  const dicts = dictionary.dicts\n  let current = _.find(dicts, dict=> dict.dname == dname)\n  if (!current) return\n  let idx = current.idx\n  let step = (direction == 'up') ? -1 : 1\n  let sibling = _.find(dicts, dict=> dict.idx == current.idx + step)\n  if (sibling) current.idx = sibling.idx, sibling.idx = idx\n  setDstore(dicts)\n}\n\nfunction toggleActive(dname) {\n  const dicts = dictionary.dicts\n  log('_A', dname)\n  log('_Adicts', dicts)\n  let current = _.find(dicts, dict=> dict.dname == dname)\n  if (!current) return\n  log('_C', current)\n  current.active = (current.active) ? false : true\n  setDstore(dicts)\n}\n\nfunction setDstore(dicts) {\n  dicts = _.sortBy(dicts, 'idx')\n  dicts.forEach((dict, idx)=> dict.idx = idx)\n  dictionary.dicts = dicts\n  const dstore = {}\n  dicts.forEach(dict=> dstore[dict.dname] = dict)\n  dictstore.clear()\n  dictstore.set(dstore)\n  dictionary.ready({dicts: dicts})\n}\n","'use strict'\n\nimport _ from 'lodash'\nimport { ipcRenderer } from \"electron\";\nconst { app } = require('electron').remote\nlet apath = app.getAppPath()\nimport { config } from './config'\nimport { log, q, qs, zerofill, initBookPrefs, stubEditor } from './lib/utils'\nimport { pushDocs, fetchBook, fetchChapterDocs, updateDocs } from './lib/pouch'\n\nimport { book, syncCnt, getCSyncs } from './book'\nimport { syncDoc, page, getSyncs } from './page'\nimport { preference } from './prefs'\nimport { router } from './app'\nconst isZip = require('is-zip')\n// const JSZip = require(\"jszip\");\n// import { compressDGL, uncompressDGL } from '../../b/dgl-utils'\nimport { compressDGL, uncompressDGL } from 'dgl-utils'\n\nconst fse = require('fs-extra')\n// const fetch = require('node-fetch')\nconst path = require(\"path\")\nconst Store = require('electron-store')\nconst bkstore = new Store({name: 'libks'})\nconst ftstore = new Store({name: 'fts'})\nconst prefstore = new Store({name: 'prefs'})\nconst syncstore = new Store({name: 'syncs'})\nconst appstore = new Store({name: 'appstore'})\n\nimport { progress } from './lib/progress'\nimport { message } from './lib/message'\n\nimport { remote } from \"electron\"\nlet dgl = remote.getGlobal('dgl')\n\n// todo: del\nconst mouse = require('mousetrap')\n// const FlexSearch = require(\"flexsearch\")\nconst ftsopts = remote.getGlobal('ftsopts')\n\nexport const getExportBook = {}\n\nfunction checkBooks() {\n  if (dgl.bid && book.sbooks) return true\n  message.show('select a book', 'darkred')\n}\n\n// create book-DGL:\nexport async function createDglPackage(prefs) {\n  if (!checkBooks()) return\n  let origin = dgl.origin(book.sbooks)\n  let exportpath = appstore.get('exportpath')\n  fse.ensureDirSync(exportpath)\n\n  let packname = prefs.name\n  let dirpath = path.resolve(exportpath, packname)\n  fse.ensureDirSync(dirpath)\n  let dgls = []\n\n  let csyncs = getCSyncs(origin.bid)\n  let books = bkstore.get(origin.bid)\n  books = dgl.actives(books)\n  book.sbooks = book.syncCnts(books, csyncs)\n  let syncs  = getSyncs(origin.bid)\n\n  for await (let sbook of book.sbooks) {\n    let bsyncs = syncs.filter(sync=> sync.bid == sbook.bid)\n    let sdocs = await getSyncedDocs(sbook, bsyncs)\n    let mds = docs2md(sdocs)\n    let mdstr = mds.join('\\n\\n')\n    let bidname = [sbook.descr.author.slice(0,25).replace(/ /g, ''), sbook.descr.title.slice(0,25).replace(/ /g, '-')].join('-')\n    let mdname = [bidname, sbook.lang, 'md'].join('.')\n    let mdpath = path.resolve(dirpath, mdname)\n    await fse.writeFileSync(mdpath, mdstr)\n\n    let dgldescr = {lang: sbook.lang, author: sbook.descr.author, title: sbook.descr.title, type: 'md' }\n    dgldescr.src = [packname, mdname].join(path.sep)\n    if (sbook.origin) dgldescr.origin = true\n    dgls.push(dgldescr)\n  }\n\n  let dglpack = _.cloneDeep(prefs)\n  dglpack.date = new Date().toISOString().replace(/T/, ' ').replace(/\\..+/, '')\n  dglpack.texts = dgls\n\n  let jsonname = [packname, 'json'].join('.')\n  let jsonpath = path.resolve(exportpath, jsonname)\n  try {\n    fse.writeJsonSync(jsonpath, dglpack, {spaces: 2})\n  } catch(err) {\n    let mess =  ['could not export', origin.descr.title].join(' ')\n    message.show(mess, 'darkred')\n  }\n  // if (prefs.compress) compressPackage(packname, dirpath, infopath)\n}\n\nipcRenderer.on('compress', async function (event) {\n  if (!checkBooks()) return\n  let origin = dgl.origin(book.sbooks)\n  let prefs = prefstore.get(origin.bid)\n\n  try {\n    compressPackage(prefs)\n    let mess = [prefs.name, 'compressed'].join(' ')\n  } catch(err) {\n    message.show('can not compress book', 'darkred')\n  }\n})\n\nasync function compressPackage(prefs) {\n  let exportpath = appstore.get('exportpath')\n  let textsdir =  path.resolve(exportpath, prefs.name)\n  let jsonpath = [textsdir, 'json'].join('.')\n  let dglpath = [textsdir, 'dgl'].join('.')\n\n  let zip = await compressDGL(jsonpath)\n  if (zip.err) return message.show('can not read json file. Select a book', 'darkred')\n  zip\n    .generateNodeStream({type:'nodebuffer', streamFiles: true})\n    .pipe(fse.createWriteStream(dglpath))\n    .on('finish', function () {\n      fse.removeSync(jsonpath)\n      fse.removeSync(textsdir)\n      let mess = [prefs.name, 'compressed to', dglpath].join(' ')\n      message.show(mess, 'darkgreen')\n    })\n    .on('error', function () {\n      message.show('can not compress book. Select a book', 'darkred')\n    })\n}\n\nipcRenderer.on('uncompress', async function (event) {\n  if (!checkBooks()) return\n  let origin = dgl.origin(book.sbooks)\n  let prefs = prefstore.get(origin.bid)\n  let exportpath = appstore.get('exportpath')\n  let dirpath = path.resolve(exportpath, prefs.name)\n  let dglpath = [dirpath, 'dgl'].join('.')\n  let backup = dglpath + '.backup'\n\n  let iszip = isZip(fse.readFileSync(dglpath))\n  if (!iszip) {\n    message.show('not a dgl, i.e. zip file', 'darkred')\n    return\n  }\n  try {\n    fse.copySync(dglpath, backup)\n  } catch(err) {\n    message.show('no archive file', 'darkred')\n    return\n  }\n  try {\n    let descr = await uncompressDGL(dglpath)\n    let mess = [prefs.name, 'uncompressed'].join(' ')\n    message.show(mess, 'darkgreen')\n  } catch(err) {\n    message.show('can not uncompress file', 'darkred')\n  }\n})\n\nasync function uncompressPackage(prefs) {\n  let exportpath = appstore.get('exportpath')\n  fse.ensureDirSync(exportpath)\n  let packname = prefs.name\n  let dirpath = path.resolve(exportpath, packname)\n  fse.ensureDirSync(dirpath)\n  let dglpath = [dirpath, 'dgl'].join('.')\n  let jsonpath = [dirpath, 'json'].join('.')\n\n  let pack = await uncompressDGL(dglpath)\n  for await (let text of pack.texts) {\n    let str = text.mds.join('\\n')\n    let filepath =  [exportpath, text.src].join(path.sep)\n    fse.writeFileSync(filepath, str)\n    delete text.mds\n  }\n  fse.writeJsonSync(jsonpath, pack, {spaces: 2})\n  fse.removeSync(dglpath)\n  let mess = [prefs.name, 'uncompressed to', dglpath].join(' ')\n  message.show(mess, 'darkgreen')\n}\n\n// todo: del ctrl+,\nmouse.bind('ctrl+,', function(ev) {\n  if (!checkBooks()) return\n  let origin = dgl.origin(book.sbooks)\n  let prefs = prefstore.get(origin.bid)\n  if (!prefs) {\n    let mess = 'export book to .DGL package before'\n    message.show(mess, 'darkgreen')\n    return\n  }\n  compressPackage(prefs)\n})\n\n// todo: del ctrl+.\nmouse.bind('ctrl+.', function(ev) {\n  if (!checkBooks()) return\n  let origin = dgl.origin(book.sbooks)\n  let prefs = prefstore.get(origin.bid)\n  uncompressPackage(prefs)\n})\n\ndocument.addEventListener('click', async (ev) => {\n  let obutton = ev.target.closest('.create-package')\n  if (!obutton) return\n  progress.show()\n  let origin = dgl.origin(book.sbooks)\n  // let prefs = preference.prefs\n  let prefs = prefstore.get(origin.bid)\n  let rows = qs('.table-line')\n  for (let orow of rows) {\n    let prefname = orow.getAttribute('prefname')\n    if (!prefname) continue\n    let value = orow.querySelector('.td-value').textContent.trim()\n    prefs[prefname] = value\n  }\n  prefstore.set(origin.bid, prefs)\n  await createDglPackage(prefs)\n  const state = {route: 'library'}\n  router(state)\n  let mess =  [origin.descr.title, 'exported'].join(' ')\n  message.show(mess, 'darkgreen')\n})\n\nexport async function getSyncedDocs(book, syncs) {\n  let cnts = book.cnts\n\n  let sdocs = []\n  for await (let cnt of cnts) {\n    let query = {bid: book.bid, path: cnt.path, size: cnt.size}\n    let sbooks = await fetchChapterDocs([query])\n    let syncdocs = sbooks[0].chdocs\n    syncs.forEach(sync=> {\n      syncdocs = syncDoc(syncdocs, sync)\n    })\n    sdocs.push(...syncdocs)\n  }\n\n  const fillsize = sdocs.length.toString().length\n  let doc\n  sdocs = sdocs.map(sdoc=> {\n    doc = {path: sdoc.path, _id: sdoc._id, idx: sdoc.idx, md: sdoc.md}\n    if (sdoc.level) doc.level = sdoc.level\n    if (sdoc.type) doc.type = sdoc.type\n    if (sdoc.size) doc.size = sdoc.size\n    return doc\n  })\n   return sdocs\n}\n\nfunction docs2md(docs) {\n  return docs.map(doc=> {\n    let md = ''\n    if (doc.level) md = '#'.repeat(doc.level) + ' '\n    else if (doc.type == 'list') md = '-'\n    md += doc.md\n    return md\n  })\n}\n\n// нужно отдельно - parse cnts и check sync\nfunction exportFtsIdxJson_(book, docs) {\n  book.cnts.forEach(cnt=> {\n    let start = 0\n    docs.every((doc, idx)=> {\n      if (doc._id < cnt._id) return true\n      start = idx\n    })\n\n    let ftspath = [book.lang, book.bid, cnt.idx].join('.')\n    let chdocs = docs.slice(start, start+cnt.size)\n    chdocs.forEach((chdoc, idx)=> chdoc.blockid = idx)\n\n    let ftsidx = new FlexSearch(ftsopts)\n    ftsidx.add(chdocs)\n    let json = ftsidx.export()\n    // let ftsbook =  {cntidx: cnt.idx, lang: book.lang, json: json}\n    ftstore.set(ftspath, json)\n  })\n}\n\nasync function createExternalPackage_(bid) {\n  let libook = bkstore.store[bid]\n  if (!libook) return\n\n  // new:\n  // books = bkstore.get(state.bid)\n  // books = dgl.actives(books)\n  return\n\n  const extpath = config.extpath\n  let external_dir = path.resolve(apath, extpath)\n  let origin = libook.books.find(book=> book.origin)\n\n  let ftspack = {bid: origin.bid, books: []}\n  let packname = [origin.bid, 'json'].join('.')\n  let packpath = path.resolve(external_dir, packname)\n\n  // let origin_dir = path.resolve(external_dir, origin.bid)\n  // await fse.emptyDirSync(origin_dir)\n\n  let jsondocs = []\n  let bids = libook.books.map(book=> book.bid)\n  for await (let book of libook.books) {\n    let mess = ['clean', book.title, '...'].join(' ')\n    message.show(mess, 'darkgreen', true)\n\n    let sdocs = await getSyncedDocs(book, true)\n\n    let descr = {\n      \"_id\": \"description\",\n      title: book.descr.title,\n      author: book.descr.author,\n      lang: book.lang\n    }\n\n    let ddoc = {\n      \"_id\": \"_design/auth\",\n      \"language\": \"javascript\",\n      \"validate_doc_update\": \"function(n,o,u){if(n._id&&!n._id.indexOf(\\\"_local/\\\"))return;if(!u||!u.roles||u.roles.indexOf(\\\"_admin\\\")==-1){throw({forbidden:'Denied.'})}}\"\n    }\n    sdocs.push(descr)\n    sdocs.push(ddoc)\n\n    let book_dir = path.resolve(external_dir, book.bid)\n    await fse.emptyDirSync(book_dir)\n    await pushDocs(book.bid, sdocs, external_dir)\n\n    let ftsidx = new FlexSearch(ftsopts)\n    ftsidx.add(sdocs)\n    let json = ftsidx.export()\n\n    let jsondoc = {_id: book.bid, lang: book.lang, json}\n    jsondoc.bids = bids\n    if (book.origin) {\n      jsondoc.origin = true\n    }\n    jsondocs.push(jsondoc)\n    ftspack.books.push(book.bid)\n  }\n\n  fse.writeJsonSync(packpath, ftspack, {spaces: 2})\n  await updateDocs('ftsidx', jsondocs, external_dir)\n\n  fse.writeJsonSync(packpath, jsondocs, {spaces: 2})\n\n  let mess = 'package created'\n  message.show(mess, 'darkgreen')\n}\n","'use strict';\n\nimport _ from 'lodash'\nimport { log, q, qs, empty, create, remove, span, p, div, space, ctext } from './lib/utils'\nimport { router, render } from './app'\nimport { book } from './book'\nimport { page } from './page'\nimport { remote } from \"electron\"\nconst Store = require('electron-store')\nconst bkstore = new Store({name: 'libks'})\nlet dgl = remote.getGlobal('dgl')\n\nlet templates = remote.getGlobal('templates')\n\nexport const header = {\n  async ready (idx) {\n    setEmptyHeader()\n    showLeftHeader()\n    if (book.sbooks.length > 1) showRightHeader(idx)\n    else showSimpleHeader(idx)\n  }\n}\n\nfunction setEmptyHeader() {\n  let oheader = q('.header')\n  oheader.classList.add('grid-cols-2')\n  oheader.innerHTML = templates.header\n  let estyle = q('#editStyle')\n  if (estyle) estyle.innerHTML = ''\n}\n\nfunction showLeftHeader() {\n  let oleft = q('.header-cell.left')\n  if (dgl.route == 'book') oleft.textContent = 'Library'\n  else if (dgl.route == 'page') {\n    let origin = dgl.origin(book.sbooks)\n    oleft.textContent = origin.descr.title //.slice(0, 25)\n  }\n}\n\nfunction showRightHeader(cntidx) {\n  let oheader = q('.header-cell.right')\n  empty(oheader)\n  let oul = create('div', 'header-block')\n  oul.classList.add('block')\n  if (cntidx === undefined) cntidx = dgl.idx\n  book.sbooks.forEach(sbook=> {\n    if (sbook.origin) return\n    let htext\n    if (dgl.route == 'book') htext = sbook.descr.title\n    else if (dgl.route == 'page') htext = sbook.cnts[cntidx].md\n    htext = [': ', htext].join('')\n    let oli = create('p')\n    oul.appendChild(oli)\n    oli.classList.add('headline')\n    oli.setAttribute('lang', sbook.lang)\n    oli.setAttribute('bid', sbook.bid)\n    if (sbook.shown) oli.classList.remove('hidden')\n    else oli.classList.add('hidden')\n    let olang = span(sbook.lang, 'head-lang')\n    oli.appendChild(olang)\n    let ohtext = span(htext)\n    oli.appendChild(ohtext)\n  })\n  oheader.appendChild(oul)\n}\n\nfunction showSimpleHeader(cntidx) {\n  let oheader = q('.header-cell.right')\n  empty(oheader)\n  let oul = create('div', 'header-block')\n  oul.classList.add('block')\n  if (cntidx === undefined) cntidx = dgl.idx\n  let origin = dgl.origin(book.sbooks)\n  let oli = create('p')\n  oul.appendChild(oli)\n  oli.classList.add('headline')\n  oli.setAttribute('lang', origin.lang)\n  oli.setAttribute('bid', origin.bid)\n  oli.classList.remove('hidden')\n  let htext\n  if (dgl.route == 'book') htext = origin.descr.title\n  else if (dgl.route == 'page') htext = origin.cnts[cntidx].md\n  oli.textContent = htext\n  oheader.appendChild(oul)\n}\n\nexport function rotateBlock(oblock) {\n  const pars = _.filter(oblock.children, child=> child.nodeName == 'P')\n  if (!pars.length) return false\n  let next = 0\n  _.each(pars, (par, idx)=> {\n    if (par.classList.contains('hidden')) return\n    par.classList.add('hidden')\n    next = idx + 1\n    if (next === pars.length) next = 0\n  })\n  const nextpar = pars[next]\n  nextpar.classList.remove('hidden')\n  return next\n}\n\ndocument.addEventListener (\"click\",  async (ev) => {\n  if (dgl.editMode) return\n  if (!dgl.bid) return\n  let oleft = ev.target.closest('.header-cell.left')\n  if (oleft) {\n    if (dgl.route == 'book') router({route: 'library'})\n    else if (dgl.route == 'page') router({route: 'book', bid: dgl.bid})\n  }\n})\n","'use strict'\n\nimport _ from 'lodash'\nimport { ipcRenderer } from \"electron\";\nconst { dialog } = require('electron').remote\nimport { log, q, create, zerofill, cleanDname, cleanStr } from './lib/utils'\n\n// import { compressDGL, uncompressDGL } from '../../b/dgl-utils'\nimport { compressDGL, uncompressDGL } from 'dgl-utils'\nimport { md2json } from 'book-md2json'\n\nimport { pushDocs, pushImgs, fetchChapterDocs } from './lib/pouch'\n// import { preference } from './prefs'\nimport { book } from './book'\n\nimport { syncDoc } from './page'\nimport { router } from './app'\nconst isZip = require('is-zip')\n// const JSZip = require(\"jszip\");\nconst franc = require('franc')\n\nconst fse = require('fs-extra')\nconst path = require(\"path\")\nconst Store = require('electron-store')\nconst bkstore = new Store({name: 'libks'})\nconst ftstore = new Store({name: 'fts'})\nconst prefstore = new Store({name: 'prefs'})\nconst appstore = new Store({name: 'app'})\n\nconst JSON5 = require('json5')\n\nimport { progress } from './lib/progress'\nimport { message } from './lib/message'\n\nimport { remote } from \"electron\"\nlet dgl = remote.getGlobal('dgl')\n\nconst { app } = require('electron').remote\nlet homepath = app.getPath('home');\nlet exportpath = appstore.get('exportpath')\n\nconst mouse = require('mousetrap')\nconst ftsopts = remote.getGlobal('ftsopts')\n\nexport const getImportBook = {}\n\n// todo: del ctrl+o\nmouse.bind('ctrl+o', function(ev) {\n  dialog.showOpenDialog({properties: ['openFile'], filters: [{name: 'DGL, FB2, EPUB, HTML, MD', extensions: ['dgl', 'json', 'epub', 'pdf', 'md', 'fb2', 'fb2.zip'] }]})\n    .then(result => {\n      const bpath = result.filePaths[0]\n      if (!bpath) {\n        message.show('can not locate book. Select a book', 'darkred')\n        return\n      }\n      let ext = path.extname(bpath)\n      if (!ext) {\n        message.show('can not locate book. Select a book', 'darkred')\n        return\n      }\n      progress.show()\n      if (ext == '.dgl') importDgl(bpath)\n      else if (ext == '.json') importDglJson(bpath)\n      else ipcRenderer.send('importBook', {bpath})\n    }).catch(err => {\n      message.show('can not import book', 'darkred')\n      console.log(err)\n    })\n})\n\nipcRenderer.on('importBook', function (event) {\n  dialog.showOpenDialog({properties: ['openFile'], filters: [{name: 'DGL, FB2, EPUB, HTML, MD', extensions: ['dgl', 'json', 'epub', 'pdf', 'md', 'fb2', 'fb2.zip'] }]})\n    .then(result => {\n      const bpath = result.filePaths[0]\n      if (!bpath) {\n        message.show('can not locate book. Select a book', 'darkred')\n        return\n      }\n      let ext = path.extname(bpath)\n      if (!ext) {\n        message.show('can not locate book. Select a book', 'darkred')\n        return\n      }\n      progress.show()\n      if (ext == '.dgl') importDgl(bpath)\n      else if (ext == '.json') importDglJson(bpath)\n      else ipcRenderer.send('importBook', {bpath})\n    }).catch(err => {\n      message.show('can not import book', 'darkred')\n      console.log(err)\n    })\n})\n\nipcRenderer.on('addParallelBook', function (event) {\n  if (!checkBooks()) return\n  dialog.showOpenDialog({properties: ['openFile'], filters: [{name: 'PDF, FB2, EPUB, PDF, HTML, MD', extensions: ['epub', 'md', 'pdf', 'fb2', 'fb2.zip'] }]})\n    .then(result => {\n      const bpath = result.filePaths[0]\n      if (!bpath) return\n      if (!book) {\n        message.show('select book to add to', 'darkred')\n        return\n      }\n      progress.show()\n      let origin = dgl.origin(book.sbooks)\n      ipcRenderer.send('importBook', {bpath, orbid: origin.bid})\n\n    }).catch(err => {\n      message.show('can not read book', 'darkred')\n      console.log(err)\n    })\n})\n\nipcRenderer.on('importBookResult', function (event, result) {\n  if (!result.docs) {\n    message.show('can not parse book', 'darkred')\n    return\n  }\n  importBook(result)\n})\n\nfunction checkBooks() {\n  if (book.sbooks) return true\n  else message.show('select a book', 'darkred')\n}\n\nfunction guessLang(docs) {\n  let test = docs.map(doc=> doc.md).join(' ')\n  return franc(test)\n}\n\nasync function importBook(result) {\n  let { descr, docs, imgs } = result\n  let half = docs.length/2\n  descr.lang = guessLang(docs.slice(half, half+200))\n\n  let newbook = parseBookInfo(descr)\n  newbook.bpath = result.bpath\n\n  newbook.cnts = parseCnts(docs)\n  setDocPath(docs)\n  newbook.active = true\n\n  if (result.orbid) {\n    // todo: add book\n    book.sbooks.push(newbook)\n    // let origin = dgl.origin(book.sbooks)\n    if (book.sbooks[1]) book.sbooks[1].shown = true\n    bkstore.set(result.orbid, book.sbooks)\n  } else {\n    newbook.origin = true\n    bkstore.set(newbook.bid, [newbook])\n    // let prefs = preference.initPrefs(newbook)\n    // prefstore.set(newbook.bid, prefs)\n  }\n\n  await pushDocs(newbook.bid, docs)\n  if (imgs.length) await pushImgs(newbook.bid, imgs)\n  router({route: 'library'})\n\n  let mess = ['book', newbook.author, newbook.title, 'loaded'].join(' ')\n  message.show(mess, 'darkgreen')\n} // import common book\n\nfunction parseCnts(docs) {\n  let cnts = docs.filter(doc=> doc.level > -1)\n  cnts.forEach((cnt, idx)=> cnt.idx = idx)\n  return cnts\n}\n\nfunction setDocPath(docs) {\n  const fillsize = docs.length.toString().length\n  let path = '', counter = 0, filled\n  let prevheader = {}\n  let parent = {level: 0, path: ''}\n  let chapternum = 0\n  let headers = docs.filter(doc=> doc.level > -1)\n  const chaptesize = headers.length.toString().length\n  for (let doc of docs) {\n    if (doc.level > -1) {\n      chapternum += 1\n      counter = 0\n      prevheader = doc\n      path = zerofill(chapternum, chaptesize)\n  }\n\n    filled = zerofill(counter, fillsize)\n    if (doc.footnote) {\n      // if (!doc._id) doc._id = ['ref', path, doc.ref].join('-')\n    } else {\n      doc.path = path\n      doc._id = [path, filled].join('-')\n      counter++\n    }\n    prevheader.size = counter\n  }\n}\n\nfunction parseBookInfo(info) {\n  let bid = cleanDname(info)\n  let lang = info.lang || 'unk'\n  let descr = {author: info.author, title: info.title}\n  let book = {bid, descr, lang}\n  if (info.origin) book.origin = true\n  return book\n}\n\nasync function parseBookByType(bpath, type) {\n  // now only md as text type\n  let result\n  try {\n    result = await md2json(bpath)\n  } catch(err) {\n    console.log('import ERR: can not import markdown')\n    console.log('import ERR:', bpath)\n    result = {descr: 'can not import book'}\n  }\n  return result\n}\n\nasync function importDglJson(bpath) {\n  let dirpath = bpath.substring(0, bpath.lastIndexOf(path.sep))\n  let pack, dgls\n  try {\n    let dgljson = await fse.readFile(bpath, 'utf-8')\n    pack = JSON5.parse(dgljson)\n    dgls = pack.texts\n  } catch(err) {\n    let mess = 'not a .dgl format'\n    message.show(mess, 'darkred')\n    return\n  }\n  pack.bpath = bpath\n\n  let packages = []\n  for (const dgldescr of dgls) {\n    if (dgldescr.skip) continue\n    if (!dgldescr.type) continue\n    let srcpath = dgldescr.src\n    let bpath = path.resolve(dirpath, srcpath)\n    let { descr, docs, imgs } = await parseBookByType(bpath, dgldescr.type)\n    if (!docs) {\n      let mess = ['incorrect info.json, no book', dgldescr.src]\n      message.show(mess, 'darkred')\n      return\n    }\n    if (dgldescr.type == 'md') descr = dgldescr\n    let pack = {descr, docs, imgs}\n    packages.push(pack)\n  } // for dgls\n\n  saveDglBook(pack, packages)\n} // import bare uncompressed dgl-json\n\nasync function importDgl(dglpath) {\n  progress.show()\n  let iszip = isZip(fse.readFileSync(dglpath))\n  if (!iszip) {\n    let mess = 'not compressed file, not a .dgl format'\n    message.show(mess, 'darkred')\n    return\n  }\n\n  let pack = await uncompressDGL(dglpath)\n  saveDglBook(pack)\n  message.show('zip in progress', 'darkgreen')\n} // import compressed dgl\n\nasync function saveDglBook(pack) {\n  let books = []\n  for (const text of pack.texts)  {\n    // let { descr, docs, imgs } = text\n    let book = parseBookInfo(text)\n    book.active = true\n\n    let mess = [book.lang, '-', book.title, 'loading...'].join(' ')\n    message.show(mess, 'darkgreen', true)\n\n    let {descr, docs, imgs} = await md2json(text.mds)\n    setDocPath(docs)\n    book.cnts = parseCnts(docs) // dgl\n    books.push(book)\n\n    await pushDocs(book.bid, docs)\n    if (imgs && imgs.length) await pushImgs(book.bid, imgs)\n  } // for texts\n\n  // todo: now: установить отметку synced ?\n  let origin = books.find(book=> book.origin)\n  let nonorigin = books.find(book=> !book.origin)\n  if (nonorigin) nonorigin.shown = true\n  bkstore.set(origin.bid, books)\n\n  let prefs = pack\n  delete prefs.texts\n  prefs.exportpath = appstore.get('exportpath')\n  prefstore.set(origin.bid, prefs)\n\n  router({route: 'library'})\n  let mess = ['book', origin.descr.author, origin.descr.title, 'loaded'].join(' ')\n  message.show(mess, 'darkgreen')\n}\n","'use strict';\n\nimport _ from 'lodash'\nimport { ipcRenderer } from \"electron\";\nconst {dialog} = require('electron').remote\nconst path = require(\"path\")\nimport { log, q, zerofill, cleanDname, cleanStr } from './lib/utils'\n// import { sd2js } from '../../b/dict-sd2json'\nimport { sd2json } from 'dict-sd2json'\n// import { importDSL as dsl2json } from 'dict-dsl2json'\nimport { pushDocs } from \"./lib/pouch\";\nconst franc = require('franc')\nimport { message } from './lib/message'\nimport { progress } from './lib/progress'\nimport { router } from './app'\nimport { porter } from './lib/stemmer'\n\nconst JSON5 = require('json5')\nconst fse = require('fs-extra')\nconst Store = require('electron-store')\nconst dictstore = new Store({name: 'dicts'})\nlet  dstore = dictstore.store\n\nexport const getimportDict = {}\n\nipcRenderer.on('importDict', function (event) {\n  // dialog.showOpenDialog({properties: ['openFile'], filters: [{name: 'IFO, DSL, JSON', extensions: ['ifo', 'dsl', 'json'] }]})\n  dialog.showOpenDialog({properties: ['openFile'], filters: [{name: 'IFO, DSL, JSON', extensions: ['ifo'] }]})\n    .then(result => {\n      const bpath = result.filePaths[0]\n      if (!bpath) return\n      let ext = path.extname(bpath)\n      if (ext == '.ifo') importStarDict(bpath)\n      else if (ext == '.dsl') importDSLDict(bpath)\n      // else if (ext == '.json') importJsonDict(bpath)\n    }).catch(err => {\n      console.log(err)\n    })\n})\n\n\nasync function importStarDict(bpath) {\n  progress.show()\n  const result = await sd2json(bpath)\n  let descr = result.descr\n  descr.lang = guessLang(result.docs.slice(1000, 2000))\n\n  const stemmer = porter(descr.lang)\n\n  const sdocs = []\n  const skey = Object.create(null)\n  let stem\n  result.docs.forEach(doc=> {\n    if (doc._id.split(' ').length == 1) {\n      stem = stemmer ? stemmer(doc._id) : doc._id\n      if (!skey[stem]) skey[stem] = {_id: stem, docs: []}\n      skey[stem].docs.push(doc)\n    } else {\n      if (!skey[doc._id]) skey[doc._id] = {_id: doc._id, docs: []}\n      skey[doc._id].docs.push(doc)\n    }\n  })\n  const stemmed = Object.values(skey)\n  sdocs.push(...stemmed)\n  saveDict(descr, sdocs)\n}\n\nexport async function importDSLDict(bpath) {\n  progress.show()\n  const result = await dsl2json(bpath)\n  let dict = result.descr\n  dict.lang = result.descr.src\n  saveDict(dict, result.docs)\n}\n\nasync function saveDict(dict, docs) {\n  progress.show()\n  dict.active = true\n  let dname = cleanDname(dict)\n  dict.dname = dname\n  dict.idx = 0\n  dstore = dictstore.store\n\n  let olddict = _.find(dstore, dict=> dict.dname == dict.dname)\n  if (olddict) dictstore.delete(olddict.dname)\n\n  let idx = 0\n  for (const dname in dstore) {\n    const dict = dstore[dname]\n    idx++\n    dict.idx = idx\n  }\n  dstore[dict.dname] = dict\n  dictstore.set(dstore)\n\n  await pushDocs(dname, docs)\n  let mess = ['dict', dict.name, 'installed'].join(' ')\n  message.show(mess, 'darkgreen')\n  router({route: 'dictionary'})\n}\n\nfunction guessLang(docs) {\n  let test = docs.map(doc=> doc._id).join(' ')\n  return franc(test)\n}\n\nasync function importJsonDict(bpath) {\n  let descr, mess, docs\n  try {\n    descr = await fse.readFileSync(bpath, 'utf-8')\n    descr = JSON5.parse(descr)\n  } catch(err) {\n    mess = ['not a dict description', bpath].join(' ')\n  }\n  if (!descr.src) mess = ['no dictionary source'].join(' ')\n  try {\n    const dirpath = path.dirname(bpath)\n    let docspath = path.resolve(dirpath, descr.src)\n    docs = await fse.readJsonSync(docspath)\n  } catch(err) {\n    mess = ['not a json dict file', bpath].join(' ')\n  }\n\n  if (mess) {\n    message.show(mess, 'red')\n    return\n  }\n\n  if (!descr.lang) descr.lang = guessLang(docs.slice(1000, 2000))\n\n  let stemmer = porter[descr.lang]\n  if (!stemmer) stemmer = defaultStemmer\n\n  const skey = Object.create(null)\n  let stem, stemmed\n  let dicts = docs.filter(doc=> doc.dict) // .dsl or .sd dicts\n  let terms = docs.filter(doc=> doc.term) // .dgl terms or flex dicts\n  let jsons = docs.filter(doc=> doc.stem) // ready stem - .dgl dicts\n\n  dicts.forEach(doc=> {\n    stem = stemmer ? stemmer(doc.dict) : doc.dict\n    if (!skey[stem]) skey[stem] = {_id: stem, docs: []}\n    skey[stem].docs.push(doc)\n  })\n\n  jsons.forEach(doc=> {\n    if (!skey[doc.stem]) skey[doc.stem] = {_id: doc.stem, docs: []}\n    skey[doc.stem].docs.push(doc)\n  })\n\n  terms.forEach(doc=> {\n    if (!skey[doc.term]) skey[doc.term] = {_id: doc.term, docs: []}\n    skey[doc.term].docs.push(doc)\n  })\n\n  stemmed = Object.values(skey)\n  saveDict(descr, stemmed)\n}\n","'use strict'\n\nconst log = console.log\nconst _ = require('lodash')\n// const fs = require('fs')\nconst fse = require('fs-extra')\nconst path = require('path')\nconst marked = require('marked')\n\nimport { config } from \"../config\";\nimport { q, create, empty } from './utils'\nimport { remote } from \"electron\"\n\nconst { app } = require('electron').remote\nlet templates = remote.getGlobal('templates')\nlet apath = app.getAppPath()\n\nexport function loadTemplates() {\n  appendFile('html')\n}\n\nfunction appendFile(ext) {\n  let tmplpath = path.resolve(apath, 'src/templates')\n  let tmpls = fse.readdirSync(tmplpath)\n  let reExt = new RegExp('\\.'+ext+'$')\n\n  tmpls.forEach(sname=> {\n    let spath, html\n    try {\n      spath = path.resolve(apath, 'src/templates', sname)\n      if (!reExt.test(spath)) return\n      html = fse.readFileSync(spath).toString()\n    } catch (err) {\n      console.log('__ERR LOADING TMPL', err)\n    }\n    templates[sname.replace(/\\.html$/, '')] = html\n  })\n}\n\nexport function loadSection(lang, sname) {\n  const app = q('#app')\n  let md\n  let spath = path.resolve(apath, 'src/i18n', lang, [sname, 'md'].join('.'))\n  try {\n    md = fse.readFileSync(spath).toString()\n  } catch (err) {\n    lang = config.deflang\n    let spath = path.resolve(apath, 'src/i18n', lang, [sname, 'md'].join('.'))\n    console.log('_SECTION NAME-ERR', lang, sname, spath)\n    md = fse.readFileSync(spath).toString()\n  }\n  let osec = create('div', 'page')\n  osec.classList.add('section')\n  osec.innerHTML = marked(md)\n  empty(app)\n  app.appendChild(osec)\n}\n","'use strict';\n\nimport { log, q } from './utils'\nconst omess = q('#message')\nimport { progress } from './progress'\n\nlet timer\n\nexport const message = {\n  show(str, color, auto) {\n    log('_message', str)\n    let omessage = omess.querySelector('#message-text')\n    progress.hide()\n    omess.classList.remove('hidden')\n    omessage.classList.remove('darkred')\n    omessage.classList.remove('darkgreen')\n    omessage.textContent = str\n    omessage.classList.add(color)\n\n    if (auto) return\n    if (timer) clearTimeout(timer)\n    timer = setTimeout(wait, 10000)\n  },\n\n  hide() {\n    omess.classList.add('hidden')\n  }\n}\n\nfunction wait() {\n  progress.hide()\n  omess.classList.add('hidden')\n}\n","import _ from 'lodash'\n\nimport { log, q } from './utils'\nconst { app } = require('electron').remote\nconst upath = app.getPath(\"userData\")\n// let apath = app.getAppPath()\nconst path = require('path')\nconst fse = require('fs-extra')\nimport { config } from '../config'\nimport { remote } from \"electron\"\n\nconst mouse = require('mousetrap')\n// const PouchDB = require('pouchdb')\n// import PouchDB from 'pouchdb'\n// const PouchDB = require('pouchdb').default;\nconst PouchDB = require('electron').remote.require('pouchdb')\n\nexport async function deleteDB(dname) {\n  // const pouchpath = path.resolve(upath, 'pouch')\n  const dpath = path.resolve(upath, 'pouch', dname)\n  await fse.remove(dpath)\n}\n\nfunction newDB(dbdict) {\n  const pouchpath = path.resolve(upath, 'pouch')\n  const dname = dbdict.dname || dbdict.bid\n  if (!dname) return\n  const dpath = path.resolve(upath, 'pouch', dname)\n  let pouch = new PouchDB(dpath)\n  pouch.dname = dname\n  pouch.name = dbdict.name\n  return pouch\n}\n\nexport async function queryDBcomplex(qstems, dicts) {\n  let indecls = qstems.filter(qstem=> qstem.indecl)\n  qstems = qstems.filter(qstem=> !qstem.indecl)\n  let keys = _.uniq(_.compact(qstems.map(qstem=> qstem.stem)))\n  let flskeys = _.uniq(_.compact(qstems.map(qstem=> qstem.term)))\n  let termkeys = _.uniq(_.compact(indecls.map(qstem=> qstem.term)))\n  let dbdicts = dicts.filter(dict=> !dict.flex && !dict.indecl)\n  let flsdicts = dicts.filter(dict=> dict.flex)\n  let termdicts = dicts.filter(dict=> dict.indecl)\n\n  let alldocs = await fetchDocs(keys, dbdicts)\n  let dictdocs = alldocs.filter(doc=> !doc.refstem)\n\n  let refdocs = alldocs.filter(doc=> doc.refstem)\n  let refstems = refdocs.map(doc=> doc.refstem)\n  let lemmas = await fetchDocs(refstems, dbdicts)\n\n  // ref - сменить stem на stem исходной формы, и добавить keys исходной формы\n  // refdoc м.б. найден только в WKT, и только в verbs\n  lemmas.forEach(refdict=> {\n    let refdoc = refdocs.find(doc=> doc.refstem == refdict.stem)\n    refdict.stem = refdoc.stem\n    refdict.keys = refdoc.keys\n    refdict.time = refdoc.time\n    // refdict.trns = refdoc.trns\n  })\n\n  dictdocs.push(...lemmas)\n\n  let flsdocs = await fetchDocs(flskeys, flsdicts)\n  let termdocs = await fetchDocs(termkeys, termdicts)\n\n  return {dictdocs, flsdocs, termdocs}\n}\n\nexport async function queryDB (stem, dicts) {\n  let keys = [stem]\n  let dbdicts = dicts.filter(dict=> !dict.flex)\n  let dictdocs = await fetchDocs(keys, dbdicts)\n\n  // exkey: surprise party\n  let exkeys = _.uniq(_.compact(_.flatten(dictdocs.map(ddoc=> ddoc.refs))))\n  let examples = await fetchDocs(exkeys, dbdicts)\n  examples.forEach(example=> example.example = true)\n  dictdocs.push(...examples)\n\n  return dictdocs\n}\n\nfunction fetchDocs(keys, dbdicts) {\n  const dbs = dbdicts.map(dbdict=> newDB(dbdict))\n  return Promise.all(dbs.map(function (db) {\n    return db.allDocs({\n      keys: keys,\n      include_docs: true\n    })\n      .then(function (res) {\n        if (!res || !res.rows) throw new Error('no query dbs result')\n        let rdocs = _.compact(_.flatten(res.rows.map(row => row.doc )))\n        let docs = _.compact(_.flatten(rdocs.map(rdoc=> rdoc.docs)))\n        docs.forEach(doc => { doc.dname = db.name })\n        return docs\n      })\n  }))\n    .then(docs=> {\n      return _.flatten(docs)\n    })\n    .catch(function (err) {\n      console.log('ERR fetchDocs', err)\n      return []\n    })\n}\n\nexport function fetchFN(keys, bids) {\n  const dbs = bids.map(bid=> newDBdname(bid))\n  return Promise.all(dbs.map(function (db) {\n    return db.allDocs({\n      keys: keys,\n      include_docs: true\n    })\n      .then(function (res) {\n        if (!res || !res.rows) throw new Error('no query dbs result')\n        let rdocs = _.compact(_.flatten(res.rows.map(row => row.doc )))\n        return rdocs\n      })\n  }))\n    .then(docs=> {\n      return _.flatten(docs)\n    })\n    .catch(function (err) {\n      console.log('ERR fetchFN', err)\n      return []\n    })\n}\n\nfunction fetchRefs(keys, dbdicts) {\n  const dbs = dbdicts.map(dbdict=> newDB(dbdict))\n  return Promise.all(dbs.map(function (db) {\n    return db.allDocs({\n      keys: keys,\n      include_docs: true\n    })\n      .then(function (res) {\n        if (!res || !res.rows) throw new Error('no query dbs result')\n        let rdocs = _.compact(res.rows.map(row => { return row.doc }))\n        rdocs = _.compact(_.flatten(rdocs))\n        rdocs.forEach(rdoc => { rdoc.dname = db.dname })\n        return rdocs\n      }).catch(function (err) {\n        console.log('ERR fetch_Refs', err)\n      })\n  }))\n}\n\nfunction showProgress(total, size) {\n  let odprog = q('#dict-progress')\n  odprog.classList.remove('hidden')\n  let percent = Math.round(size*100/total)\n  odprog.textContent = [percent, '%'].join(' ')\n  if (percent >= 100) odprog.textContent = '', odprog.classList.add('hidden')\n}\n\nexport async function fetchBlock_(_id, bids) {\n  const dbs = bids.map(bid=> newDBdname(bid))\n  dbs.forEach(db=> {\n    let opts = {include_docs: true, keys: [_id]}\n    db.options = opts\n  })\n\n  return Promise.all(dbs.map(async function (db) {\n    return db.allDocs(db.options)\n      .then(res=> {\n        return res.rows[0].doc\n      })\n  }))\n}\n\nexport async function fetchBlock(params) {\n  const dbs = params.map(param=> newDBdname(param.bid))\n  dbs.forEach((db, idx)=> {\n    let opts = {include_docs: true, keys: [params[idx].id], lang: params[idx].lang, bid: params[idx].bid}\n    db.options = opts\n  })\n\n  return Promise.all(dbs.map(async function (db) {\n    return db.allDocs(db.options)\n      .then(res=> {\n        if (!res.rows.length) return\n        let doc = res.rows[0].doc\n        if (!doc) return\n        doc.bid = db.options.bid\n        doc.lang = db.options.lang\n        return doc\n      })\n  }))\n}\n\nfunction newDBdname(dname) {\n  const pouchpath = path.resolve(upath, 'pouch')\n  const dpath = path.resolve(upath, 'pouch', dname)\n  let pouch = new PouchDB(dpath)\n  pouch.dname = dname\n  return pouch\n}\n\nexport async function fetchBook(bid) {\n  const db = newDBdname(bid)\n  return db.allDocs({include_docs: true})\n    .then(res=> {\n      db.close()\n      return res.rows.map(row=> row.doc)\n    })\n    .catch(err=> {\n      log('_ERR fetch book docs', db.dname, err)\n    })\n}\n\nexport async function fetchChapter(query) {\n  const db = newDBdname(query.bid)\n  let chpath, limit\n  chpath = query.path\n  limit = query.size\n  let startkey = [chpath, '-'].join('')\n  db.options = {include_docs: true, startkey, limit}\n\n  return db.allDocs(db.options)\n    .then(res=> {\n      const chdocs = res.rows.map(row=> row.doc)\n      return chdocs\n      // return {bid: query.bid, chdocs: chdocs}\n    })\n    .catch(err=> {\n      log('_ERR fetchChapterDocs:', db.dname, err)\n    })\n}\n\nexport async function fetchChapterDocs(queries) {\n  const dbs = queries.map(book=> newDBdname(book.bid))\n  let chpath, limit\n  dbs.forEach((db, idx)=> {\n    chpath = queries[idx].path\n    limit = queries[idx].size\n    let startkey = [chpath, '-'].join('')\n    // let endkey = [chpath, '-\\ufff0'].join('')\n    // let opts = {include_docs: true, startkey, endkey}\n    let opts = {include_docs: true, startkey, limit}\n    db.options = opts\n  })\n\n  return Promise.all(dbs.map(async function (db) {\n    return db.allDocs(db.options)\n      .then(res=> {\n        const chdocs = res.rows.map(row=> row.doc)\n        return queries.map(query=> {\n          if (query.bid != db.dname) return false\n          let chapter = {bid: query.bid, lang: query.lang, chdocs: chdocs}\n          if (query.active) chapter.active = true\n          if (query.origin) chapter.origin = true\n          if (query.shown) chapter.shown = true\n          return chapter\n        })\n      })\n      .catch(err=> {\n        log('_ERR fetchChapterDocs:', db.dname, err)\n      })\n  }))\n    .then(res=> {\n      return _.compact(_.flatten(res))\n    })\n}\n\nexport async function pushDocs(dname, docs, pouchpath) {\n  if (!pouchpath) pouchpath = path.resolve(upath, 'pouch')\n  await fse.ensureDirSync(pouchpath)\n  const dpath = path.resolve(pouchpath, dname)\n  let pouch = new PouchDB(dpath)\n  await pouch.close()\n  await fse.emptyDirSync(dpath)\n  pouch = new PouchDB(dpath) // todo: wtf? but that's true\n  pouch.dname = dname\n\n  let total = docs.length\n  let size = 0\n  const chunks = _.chunk(docs, config.batch_size)\n  for await (let chunk of chunks) {\n    size += config.batch_size\n    showProgress(total, size)\n    await pouch.bulkDocs(chunk)\n      .then(res=> {\n        let oks = res.filter(doc=> doc.ok)\n        // log('_chunk ok', res.length, oks.length, '=', res.length == oks.length)\n        return true\n      })\n  }\n  // log('_pouch-docs pushed', docs.length)\n  pouch.close()\n}\n\nexport async function updateDocs(dname, docs, pouchpath) {\n  if (!pouchpath) pouchpath = path.resolve(upath, 'pouch')\n  await fse.ensureDirSync(pouchpath)\n  const dpath = path.resolve(pouchpath, dname)\n\n  docs.forEach(doc=> delete doc._rev)\n  await fse.emptyDirSync(dpath)\n  let pouch = new PouchDB(dpath)\n\n  await Promise.all(docs.map(async function (doc) {\n    return pouch.get(doc._id)\n      .then(function (orig) {\n        if (doc.md && doc.md == orig.md) return false\n        doc._rev = orig._rev\n        return pouch.put(doc)\n      })\n      .catch(function (err) {\n        if (err.name === 'not_found') {\n          return pouch.put(doc)\n        } else {\n          // log('_not not-found-err', doc._id)\n          throw err;\n        }\n      })\n      .catch(function (err) {\n        log('ERR: updating doc', err, 'doc:', doc)\n      })\n  }))\n    // .then(res=> {\n      // return 'updating docs: ok'\n      // pouch.close()\n    // })\n  // log('_updated docs: ok')\n  pouch.close()\n}\n\nexport async function pushImgs(dname, imgs) {\n  const pouchpath = path.resolve(upath, 'pouch')\n  return\n\n  await fse.ensureDirSync(pouchpath)\n  const dpath = path.resolve(upath, 'pouch', dname)\n  let pouch = new PouchDB(dpath)\n  pouch.dname = dname\n\n  imgs = imgs.slice(-3)\n  Promise.all(imgs.map(function (img) {\n    let name = img.name\n    pouch.putAttachment(name, name, img.data, 'image/jpeg')\n      .then(function (res) {\n        log('___IMG-RES:', res)\n      }).catch(function (err) {\n        console.log('ERR push Imgs', err)\n      })\n  }))\n\n  return\n\n  let docs = imgs.map(img=> {\n    // let ctype = ['image', path.extname(img.name)].join('')\n    let name = img.name\n    log('_pushing image_', name)\n    let doc = {_id: name, _attachments: {}}\n    let data = img.data.toString('base64')\n    doc._attachments[name] = {content_type: 'text/plain', data: data}\n    return doc\n  })\n\n  await pouch.bulkDocs(docs)\n    .then(res=> {\n      log('_images pushed_', res)\n      return true\n    }).catch(function (err) {\n      log('IMG PUSH ERR:', err)\n    });\n\n}\n\nexport async function getImage(imgname) {\n  let dname = 'JK-Rowling-Harry-Potter-and-the-Orde'\n  const dpath = path.resolve(upath, 'pouch', dname)\n  let pouch = new PouchDB(dpath)\n  pouch.get(imgname, {attachments: true}).then(function (doc) {\n    console.log(doc);\n  })\n}\n\nmouse.bind('ctrl+g', function(ev) {\n  //\n})\n","'use strict';\n\nimport { log, q } from './utils'\n\nconst oprogress = q('#progress')\n\nexport const progress = {\n  show() {\n    oprogress.classList.remove('hidden')\n  },\n\n  hide() {\n    oprogress.classList.add('hidden')\n  }\n}\n","'use strict'\n\nimport { log } from './utils'\nimport _ from 'lodash'\nconst natural = require('natural')\nconst german = require('snowball-german')\n\nconst stemmer = {\n  'nld': natural.PorterStemmerNl.stem,\n  'eng': natural.PorterStemmer.stem,\n  'faz': natural.PorterStemmerFa.stem,\n  'fra': natural.PorterStemmerFr.stem,\n  'ind': natural.StemmerId.stem, // indonesian\n  'ita': natural.PorterStemmerIt.stem,\n  'jpn': natural.StemmerJa.stem,\n  'nor': natural.PorterStemmerNo.stem,\n  'por': natural.PorterStemmerPt.stem,\n  'rus': natural.PorterStemmerRu.stem,\n  'spa': natural.PorterStemmerEs.stem,\n  'swe': natural.PorterStemmerSv.stem\n}\n\nexport function porter (lang)  {\n  if (lang == 'deu') return german\n  else return stemmer[lang]\n}\n","import \"../css/tree.css\";\n\nimport { log, q, qs, empty, create, remove, span, p, div, space } from './utils'\nimport _ from 'lodash'\nconst marked = require('marked')\n\nexport function createTree(cnts, roots, books) {\n  let oroots = []\n  roots.forEach(root=> {\n    let oroot = treeBlock(root)\n    oroots.push(oroot)\n    books.forEach(book=> {\n      let doc = book.cnts[root.idx]\n      if (!doc) return // un-synchronized\n      let opar = treePar(doc)\n      if (!book.origin && !book.shown) opar.classList.add('hidden')\n      oroot.appendChild(opar)\n    })\n\n    let nextroot = cnts.find(cnt=> cnt.idx > root.idx && cnt.level == root.level)\n    let chroots = cnts.filter(cnt=> cnt.idx > root.idx)\n    if (nextroot) chroots = chroots.filter(cnt=> cnt.idx < nextroot.idx)\n    chroots = chroots.filter(cnt=> cnt.level == root.level + 1)\n    if (chroots.length) {\n      let osign = create('span', 'tree-sign')\n      osign.textContent = '▾'\n      oroot.prepend(osign)\n    }\n\n    let ochildren = createTree(cnts, chroots, books)\n    ochildren.forEach(ochild=> oroot.appendChild(ochild))\n  })\n  return oroots\n}\n\nfunction treeBlock(doc) {\n  const oblock = create('div', 'block')\n  oblock.setAttribute('level', doc.level)\n  oblock.classList.add('tree-block')\n  let levstyle = ['lev', doc.level].join('-')\n  oblock.classList.add(levstyle)\n  return oblock\n}\n\nfunction treePar(doc) {\n  let opar = create('p')\n  // opar.textContent = doc.md.replace(/#/g, '')\n  if (!doc.md) doc.md = 'no text'\n  opar.innerHTML = marked(doc.md)\n  opar.setAttribute('path', doc.path)\n  opar.setAttribute('size', doc.size)\n  opar.setAttribute('idx', doc.idx)\n  opar.classList.add('tree-text')\n  opar.classList.add('ptext')\n  return opar\n}\n\n// sign-collapse\ndocument.addEventListener (\"click\",  (ev) => {\n  if (!q('.page')) return\n  let oblock = ev.target.closest('.block')\n  if (!oblock) return\n  let osign =  ev.target.closest('.tree-sign')\n  if (!osign) return\n  oblock.classList.toggle('tree-collapse')\n  if (oblock.classList.contains('tree-collapse')) osign.textContent =  '▸'\n  else osign.textContent = '▾'\n  ev.stopPropagation()\n})\n","import _ from 'lodash'\n// const natural = require('natural')\n\n// let util = require('util')\n\nexport const log = console.log\n\n// https://stackoverflow.com/questions/7616461/generate-a-hash-from-string-in-javascript\nexport function hashCode(s) {\n  return s.split(\"\").reduce(function(a,b){a=((a<<5)-a)+b.charCodeAt(0);return a&a},0);\n}\n\nexport function q (sel) {\n  return document.querySelector(sel)\n}\n\nexport function qs (sel) {\n  return document.querySelectorAll(sel)\n}\n\nexport function create (tag, style) {\n  let el = document.createElement(tag)\n  if (style) el.classList.add(style)\n  return el\n}\n\nexport function recreateDiv (sel) {\n  let el = document.querySelector(sel)\n  if (el) el.parentElement.removeChild(el)\n  el = document.createElement('div')\n  el.classList.add(sel)\n  // el.id = sel\n  return el\n}\n\nexport function recreate (element) {\n  var newElement = element.cloneNode(true)\n  element.parentNode.replaceChild(newElement, element)\n}\n\nexport function ctext (str) {\n  return document.createTextNode(str)\n}\n\nexport function span (str, style) {\n  let el = document.createElement('span')\n  el.textContent = str\n  if (style) el.classList.add(style)\n  return el\n}\n\nexport function space () {\n  return document.createTextNode(' ')\n}\n\n\nexport function br () {\n  let oBR = document.createElement('br')\n  return oBR\n}\n\nexport function div (str, style) {\n  let el = document.createElement('div')\n  el.textContent = str\n  if (style) el.classList.add(style)\n  return el\n}\n\nexport function p (str, style) {\n  let el = document.createElement('p')\n  el.textContent = str\n  if (style) el.classList.add(style)\n  return el\n}\n\nexport function empty (el) {\n  if (!el) return\n  while (el.hasChildNodes()) {\n    el.removeChild(el.lastChild)\n  }\n}\n\nexport function remove (el) {\n  if (!el) return\n  el.parentElement.removeChild(el)\n}\n\nexport function removeAll (els) {\n  els.forEach(el => { el.parentElement.removeChild(el) })\n}\n\nexport function findAncestor (el, cls) {\n  while ((el = el.parentElement) && !el.classList.contains(cls)) {\n    return el\n  }\n}\n\nexport function getCoords (el) {\n  let rect = el.getBoundingClientRect()\n  return rect\n}\n\nexport function placePopup (coords, el) {\n  let top = [coords.top, 'px'].join('')\n  let left = [coords.left, 'px'].join('')\n  el.style.top = top\n  el.style.left = left\n}\n\n// https://stackoverflow.com/questions/4793604/how-to-insert-an-element-after-another-element-in-javascript-without-using-a-lib\nexport function insertAfter(referenceNode, newNode) {\n  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n}\n\nexport function zerofill(number, size) {\n  number = number.toString()\n  while (number.length < size) number = \"0\" + number\n  return number;\n}\n\nexport function cleanStr(str) {\n  return str.trim().replace(/\\n+/g, '\\n').replace(/↵+/, '\\n').replace(/  +/, ' ').replace(/ /g, '') // .replace(/\\s+/, ' ')\n}\n\nexport function ndash(str) {\n  return str.trim().replace(/^-/, '–').replace(/^—/, '–').replace(/ - /g, ' – ') // m-dash: —\n}\n\nexport function cleanDname(descr) {\n  if (!descr.author) descr.author = 'author'\n  if (!descr.title) descr.title = descr.name || 'title'\n  let lang = descr.lang || ''\n  // let str = [descr.type || '', descr.lang || '', descr.author.slice(0,25), descr.title.slice(0,25)].join('-')\n  let str = [descr.author.slice(0,25), descr.title.slice(0,25), lang].join('-')\n  return str.replace(/[)(,\\.]/g,'').replace(/\\s+/g, '-').replace(/\\//g, '_')\n}\n\n// ev.preventDefault()\n// ev.stopPropagation()\n\nexport function replaceEl (el, html) {\n  const parentElem = el.parentNode\n  let innerElem\n  while (innerElem = el.firstChild) { parentElem.insertBefore(innerElem, el) }\n  parentElem.removeChild(el)\n}\n\nexport function fromHTML(html) {\n  const div = document.createElement('div')\n  div.innerHTML = html\n  return div.firstChild\n}\n\nexport function previousSiblings(elem) {\n  let sibs = []\n  while (elem = elem.previousSibling) {\n    if (elem.nodeName !== 'SPAN') continue\n    sibs.push(elem)\n  }\n  return sibs\n}\n\nexport function splitByPhrases(str) {\n  return str.replace(/([.?!])\\s*(?=[A-Z])/g, \"$1|\").split(\"|\")\n}\n\n\n// PAGE\nexport function scrollToPosition(scrollTop) {\n  let osec = q('.page')\n  osec.scrollTop = scrollTop\n}\n\nexport function selectParallelBooks(store, bid) {\n  for (let libook in store) {\n    for (let book of store[libook].books) {\n      if (book.bid == bid) return store[libook].books\n    }\n  }\n}\n\nexport function tokenizer (str) {\n  return str.split(/[\\p{P} ]+/ug).filter(Boolean)\n}\n","'use strict'\n\nimport { router, render } from './app'\nimport _ from 'lodash'\nimport { remote } from \"electron\"\nimport { log, q, qs, create, remove, empty, insertAfter } from './lib/utils'\nimport { progress } from './lib/progress'\nimport { deleteDB } from \"./lib/pouch\";\n\nconst Store = require('electron-store')\nconst libstore = new Store({name: 'library'})\nconst bkstore = new Store({name: 'libks'})\nconst bmkstore = new Store({name: 'bookmarks'})\nconst csyncstore = new Store({name: 'csyncs'})\nconst syncstore = new Store({name: 'syncs'})\nconst prefstore = new Store({name: 'prefs'})\nconst ftstore = new Store({name: 'fts'})\n\nconst mouse = require('mousetrap')\nimport { message } from './lib/message'\n\nlet dgl = remote.getGlobal('dgl')\nlet templates = remote.getGlobal('templates')\n\n// todo: del\nmouse.bind(['v'], function(ev) {\n  console.clear()\n  let bks = {}\n  for (let bid in libstore.store) {\n    let store = libstore.store[bid]\n    let books = store.books\n    let origin = books.find(book=> book.origin)\n    books.forEach(book=> {\n      delete book.csyncs\n      delete book.syncs\n      book.descr = {author: book.author, title: book.title}\n      delete book.author\n      delete book.title\n      if (!book.origin) book.orbid = origin.bid\n    })\n    books.libidx = store.idx\n    bks[bid] = books\n  }\n  bkstore.clear()\n  bkstore.set(bks)\n\n  // let libidxs = []\n  // for(let libbid in bks) {\n  //   libidxs.push(bks[libbid].libidx)\n  // }\n})\n\nexport const library = {\n  async ready() {\n    render('library')\n    dgl.editMode = false\n    this.bks = bkstore.store\n    parseLib()\n    this.stripes()\n    progress.hide()\n  },\n\n  isOrigin(bid) {\n    return _.keys(this.bks).includes(bid)\n  },\n\n  originBid(bid) {\n    let orbid = bid\n    for (let libbid in this.bks) {\n      let books = this.bks[libbid]\n      for (let book of books) {\n        if (book.bid == bid) orbid = dgl.origin(books).bid\n      }\n    }\n    return orbid\n  },\n\n  expandBook(orbid) {\n    let books = this.bks[orbid]\n    let selector\n    books.forEach(book=> {\n      if (orbid == book.bid) return\n      selector = ['.table-line[bid=\"', book.bid, '\"]'].join('')\n      let row = q(selector)\n      if (!row) return\n      row.classList.toggle('hidden')\n    })\n    this.stripes()\n  },\n\n  stripes() {\n    let orows = qs('.table-line:not(.hidden)')\n    let n = 0\n    for (let orow of orows) {\n      if ((n % 2) === 1) orow.classList.remove('odd'), orow.classList.add('even')\n      else orow.classList.add('odd'), orow.classList.remove('even')\n      n++\n    }\n  },\n\n  activate(bid) {\n    let book, books, orbid\n    if (this.isOrigin(bid)) {\n      books = this.bks[bid]\n      orbid = dgl.origin(books).bid\n      for (const book of books) {\n        book.active = true\n      }\n    } else {\n      orbid = this.originBid(bid)\n      books = this.bks[orbid]\n      let origin = books.find(book=> book.bid == orbid)\n      if (!origin.active) {\n        let mess = ['the origin book -', origin.descr.title, 'should be activated first'].join(' ')\n        message.show(mess,'darkred')\n        return\n      }\n      book = books.find(book=> book.bid == bid)\n      book.active = true\n    }\n    setStore(this.bks)\n    parseLib(orbid)\n  },\n\n  deactivate(bid) {\n    let book, books, orbid\n    if (this.isOrigin(bid)) {\n      books = this.bks[bid]\n      orbid = dgl.origin(books).bid\n      for (const book of books) {\n        book.active = false\n      }\n    } else {\n      orbid = this.originBid(bid)\n      books = this.bks[orbid]\n      book = books.find(book=> book.bid == bid)\n      book.active = false\n    }\n    setStore(this.bks)\n    parseLib(orbid)\n  },\n\n  async deleteBook(bid) {\n    progress.show()\n    let book, books\n    if (this.isOrigin(bid)) {\n      books = this.bks[bid]\n      for (const book of books) {\n        await deleteDB(book.bid)\n        let ftspath = [book.lang, bid].join('.')\n        await ftstore.delete(ftspath)\n        await bmkstore.delete(bid)\n        await prefstore.delete(bid)\n        await csyncstore.delete(bid)\n        await syncstore.delete(bid)\n      }\n      delete this.bks[bid]\n    } else {\n      let libbid = this.originBid(bid)\n      books = this.bks[libbid]\n      if (!books) return\n      this.bks[libbid] = books.filter(book=> book.bid != bid)\n    }\n    book = books.find(book=> book.bid == bid)\n    setStore(this.bks)\n    this.ready()\n    let mess = ['book -', book.descr.author, book.descr.title, 'deleted'].join(' ')\n    message.show(mess,'darkgreen')\n  },\n}\n\nfunction setStore(bks) {\n  let libidx = 0\n  for (let libbid in bks) {\n    let books = bks[libbid]\n    books.libidx = libidx\n    libidx++\n  }\n  bkstore.clear()\n  bkstore.set(bks)\n}\n\ndocument.addEventListener('click',  (ev) => {\n  let orow = ev.target.closest('#lib-table .table-line')\n  if (!orow) return\n  let bid = orow.getAttribute('bid')\n  let orbid = library.originBid(bid)\n\n  let direction = (ev.ctrlKey && ev.altKey) ? 'down' : (ev.ctrlKey) ? 'up' : null\n  let olangs = ev.target.closest('.td-langs')\n  let ocheck = ev.target.closest('svg')\n  let oact = ev.target.closest('button.td-activate')\n  let odel = ev.target.closest('button.td-delete')\n\n  if (olangs) library.expandBook(orbid)\n  else if (oact) library.activate(bid)\n  else if (ocheck) library.deactivate(bid)\n  else if (odel) library.deleteBook(bid)\n  else {\n    let books = bkstore.get(orbid)\n    const origin = dgl.origin(books)\n    if (orbid != bid) {\n      const shown = dgl.shown(books)\n      const book = books.find(book=> book.bid == bid)\n      if (shown.bid != bid && book.active) {\n        book.shown = true\n        shown.shown = false\n        library.bks[orbid] = books\n        bkstore.clear()\n        bkstore.set(library.bks)\n      } else {\n        let mess = [book.descr.title, 'should be activated first'].join(' ')\n        message.show(mess,'darkred')\n      }\n    } else {\n      if (!origin.active) {\n        let mess = 'no active books'\n        message.show(mess,'darkred')\n        return\n      }\n    }\n\n    let state = {route: 'book', bid: orbid}\n    dgl.bid = orbid\n    router(state)\n  }\n  // todo: else if (direction) moveRow(bid, direction)\n})\n\nfunction parseLib() {\n  const tbody = q('#lib-table .tbody')\n  empty(tbody)\n  let books\n  for (let libbid in library.bks) {\n    books = library.bks[libbid]\n    for (let book of books) {\n      let orow = parseRow(book)\n\n      orow.setAttribute('bid', book.bid)\n      if (book.origin) {\n        let olangs = orow.querySelector('.td-langs')\n        olangs.textContent = ''\n        let oactlangs = create('span')\n        let actlangs = dgl.langs(books)\n        oactlangs.textContent = actlangs\n        let passives = _.difference(dgl.alllangs(books), actlangs)\n        olangs.appendChild(oactlangs)\n        if (passives.length) {\n          let oalllangs = create('span')\n          oalllangs.textContent = [' (', passives, ')'].join('')\n          oalllangs.classList.add('text-gray-400')\n          olangs.appendChild(oalllangs)\n        }\n\n      }\n      tbody.appendChild(orow)\n    }\n  }\n}\n\nfunction parseRow (book) {\n  const tmpl = q('.table-line.tmpl')\n  const orow = tmpl.cloneNode(true)\n  orow.classList.remove('tmpl')\n\n  let oauthor = orow.querySelector('.td-author')\n  let otitle = orow.querySelector('.td-title')\n  let olangs = orow.querySelector('.td-langs')\n  let ocheck = orow.querySelector('svg')\n  let oact = orow.querySelector('button.td-activate')\n\n  otitle.textContent = book.descr.title\n  oauthor.textContent = book.descr.author\n  if (book.origin) {\n    orow.classList.remove('hidden')\n  } else {\n    orow.classList.add('hidden')\n    orow.classList.add('grey')\n  }\n  if (book.active) {\n    ocheck.classList.remove('hidden')\n    oact.classList.add('hidden')\n  } else {\n    ocheck.classList.add('hidden')\n    oact.classList.remove('hidden')\n  }\n\n  olangs.textContent = book.lang\n  orow.setAttribute('bid', book.bid)\n  return orow\n}\n","'use strict'\n\nimport { log, q, qs, create, empty, cleanDname } from './lib/utils'\nimport _ from 'lodash'\nconst fse = require('fs-extra')\nconst glob = require(\"glob\")\nimport { router, render } from './app'\nconst mouse = require('mousetrap')\nconst { app } = require('electron').remote\nimport { remote } from \"electron\"\nconst { dialog } = require('electron').remote\nimport { progress } from './lib/progress'\nimport { ipcRenderer } from \"electron\";\nimport { book } from './book'\n\nconst Store = require('electron-store')\nconst appstore = new Store({name: 'appstore'})\nimport { message } from './lib/message'\n\nexport const lookup = {\n  async ready() {\n    render('lookup')\n    let heappath = appstore.get('heappath')\n    if (!heappath) {\n      message.show('set path to heap of the books', 'darkred')\n    }\n    const oheappath = q('#heappath')\n    oheappath.textContent = heappath\n    this.heappath = heappath\n    let oinput = q('.searchinput')\n    oinput.focus();\n  },\n\n  addRow(type, name, value) {\n    const tmpl = q('.search-result-line.tmpl')\n    const orow = tmpl.cloneNode(true)\n    orow.classList.remove('tmpl')\n    orow.setAttribute('type', type)\n    orow.setAttribute('prefname', name)\n    orow.setAttribute('contenteditable', true)\n    let oname = orow.querySelector('.td-name')\n    let ovalue = orow.querySelector('.td-value')\n    oname.textContent = name\n    ovalue.textContent = value\n    this.tbody.appendChild(orow)\n  },\n\n  stripes() {\n    let orows = qs('.lookup-line')\n    let n = 0\n    for (let orow of orows) {\n      if ((n % 2) === 1) orow.classList.remove('odd'), orow.classList.add('even')\n      else orow.classList.add('odd'), orow.classList.remove('even')\n      n++\n    }\n  },\n}\n\ndocument.addEventListener('click',  (ev) => {\n  let olookup = ev.target.closest('#lookup')\n  if (!olookup) return\n  ev.stopPropagation()\n  let ohelp = ev.target.closest('#lookup-help-button')\n  let oheap = ev.target.closest('#heap')\n  let orow = ev.target.closest('.lookup-line')\n  let oinput = ev.target.closest('.searchinput')\n  if (oheap && !oinput) {\n    openHeappath()\n  } else if (ohelp) {\n    ohelp = q('#lookup-help')\n    ohelp.classList.toggle('hidden')\n  } else if (orow) {\n    let shift = (ev.shiftKey) ? true: false\n    fireImport(orow, shift)\n  }\n})\n\nfunction fireImport(orow, shift) {\n  let bpath = orow.textContent\n  if (!bpath) return\n  let sbooks = book.sbooks\n  if (shift && !sbooks) {\n    message.show('select book before', 'darkred')\n    return\n  }\n  if (shift) ipcRenderer.send('addBook', {bpath})\n  else ipcRenderer.send('importBook', {bpath})\n}\n\nfunction openHeappath() {\n  dialog.showOpenDialog({properties: ['openDirectory'] })\n    .then(result => {\n      const bpath = result.filePaths[0]\n      if (!bpath) return\n      appstore.set('heappath', bpath)\n      lookup.ready()\n    }).catch(err => {\n      console.log(err)\n    })\n}\n\ndocument.addEventListener('keydown', ev => {\n  if (ev.key !== 'Enter') return\n  ev.preventDefault()\n  let oinput = ev.target.closest('.searchinput')\n  if (!oinput) return\n  let query = oinput.value\n  if (!query) return\n  if (!lookup.heappath) {\n    message.show('set path to heap of the books', 'darkred')\n    return\n  }\n  lookupBook(lookup.heappath, query)\n  oinput.focus();\n})\n\nfunction lookupBook(srcdir, query) {\n  progress.show()\n  let restr = new RegExp(query, 'i')\n  let pattern = [srcdir, '**/*'].join('/')\n\n  glob(pattern, function (er, fns) {\n    let qs = query.split(/ ,?/)\n    qs.forEach(query=> {\n      let req = new RegExp(query, 'i')\n      fns = fns.filter(fn=> req.test(fn))\n    })\n    let oresults = q('#search-list')\n    empty(oresults)\n\n    for (let fn of fns) {\n      const tmpl = q('.lookup-line.tmpl')\n      const orow = tmpl.cloneNode(true)\n      orow.classList.remove('tmpl')\n      orow.textContent = fn\n      oresults.appendChild(orow)\n    }\n    lookup.stripes()\n    progress.hide()\n  })\n}\n","'use strict';\n\nimport _ from 'lodash'\nimport { log, q, qs, empty, create, remove, span, p, div, space, ctext } from './lib/utils'\nimport { render } from './app'\nimport { remote, clipboard } from \"electron\"\nconst franc = require('franc')\n\nexport const newtext = {\n  ready () {\n    render('newtext')\n    let ocontainer = q('#newtext')\n    let str = clipboard.readText()\n    let lang = franc(str)\n    if (lang == 'ell') lang = 'grc'\n    // lang = 'grc'\n    // todo: прокатать dicts\n    let rows = str.trim().split('\\n')\n    rows.forEach(row=> {\n      let html = ''\n      let orow = create('p', 'ptext')\n      html += row.replace(/([^\\p{P} ]+)/ug, \"<span class=\\\"wf\\\">$1</span>\")\n      orow.innerHTML = html\n      orow.setAttribute('lang', lang)\n      ocontainer.appendChild(orow)\n    })\n  }\n}\n","'use strict'\n\nimport { log, q, qs, empty, create, remove, getCoords, placePopup, scrollToPosition, removeAll, ndash } from './lib/utils'\nimport _ from 'lodash'\nimport { render } from './app'\nimport { fetchChapterDocs, fetchChapter, fetchFN } from \"./lib/pouch\";\nconst mouse = require('mousetrap')\nconst marked = require('marked')\n// const stopword = require('stopword')\nimport { header, rotateBlock } from './header'\nimport { semaphore, removeEditStyle } from './semaphore'\n\nimport { message } from './lib/message'\nimport { book, getCSyncs } from './book'\nconst Mark = require('mark.js')\nimport { progress } from './lib/progress'\n\nconst Store = require('electron-store')\nconst libstore = new Store({name: 'library'})\nconst bkstore = new Store({name: 'libks'})\nconst csyncstore = new Store({name: 'csyncs'})\nconst syncstore = new Store({name: 'syncs'})\n\nimport { remote } from \"electron\"\nlet dgl = remote.getGlobal('dgl')\n\nexport const page = {\n  async ready (state) {\n    progress.show()\n    render('book')\n    if (!state || !state.bid) throw new Error('_PAGE NO STATE')\n\n    let sbooks = bkstore.get(state.bid)\n    sbooks = dgl.actives(sbooks)\n    // let origin = sbooks.find(sbook=> sbook.origin)\n    let syncs = getSyncs(state.bid)\n\n    dgl.idx = state.idx\n    if (state.idx < 0) throw new Error('_PAGE NO CHAPTER IDX')\n\n    if (state.jump) {\n      dgl.bid = state.bid\n      dgl.idx = state.idx // переназвать cntidx?\n      let csyncs = getCSyncs(state.bid)\n      book.sbooks = book.syncCnts(sbooks, csyncs)\n    }\n\n    this.copy = await this.getChapters(book, state.idx)\n    let chapters = _.cloneDeep(this.copy)\n    await this.syncChapters(chapters, syncs)\n    drawPage(chapters)\n\n    header.ready(state.idx)\n    this.localquery = ''\n    if (state && state.blockid) this.scroll(state)\n    showSearchIcon()\n    progress.hide()\n    showPagePosition()\n  },\n  async getChapters(book, cntidx) { // hard copy - chapter for all langs\n    let chapters = []\n    for await (let sbook of book.sbooks) {\n      let chdocs = await this.getChapter(sbook, cntidx)\n      let chapter = {bid: sbook.bid, lang: sbook.lang, idx: cntidx, chdocs: chdocs}\n      if (sbook.active) chapter.active = true\n      if (sbook.origin) chapter.origin = true\n      if (sbook.shown) chapter.shown = true\n      chapters.push(chapter)\n    }\n    return chapters\n  },\n  async syncChapters(chapters, syncs) {\n    for await (let chapter of chapters) {\n      let booksyncs = syncs.filter(sync=> sync.bid == chapter.bid)\n      chapter.chdocs = await this.syncChapter(booksyncs, chapter.chdocs)\n    }\n    this.chapters = chapters\n    // return chapters\n  },\n  async getChapter(sbook, cntidx) {\n    let cnt = sbook.cnts[cntidx]\n    if (!cnt) return []\n    let query = {bid: sbook.bid, path: cnt.path, size: cnt.size}\n    let chdocs = await fetchChapter(query)\n    return chdocs\n  },\n  syncChapter(syncs, chdocs) {\n    syncs.forEach(sync=> {\n      chdocs = syncDoc(chdocs, sync)\n    })\n    return chdocs\n  },\n  async undo() {\n    let origin = book.sbooks.find(sbook=> sbook.origin)\n    let syncs = getSyncs(origin.bid)\n    syncs = syncs.slice(0,-1)\n    syncstore.set(origin.bid, syncs)\n    let chapters = _.cloneDeep(this.copy)\n    await this.syncChapters(chapters, syncs)\n    drawPage(chapters)\n    semaphore.ready()\n  },\n  reload() {\n    drawPage(this.chapters)\n  },\n  reSync(sync) {\n    let chapter = this.chapters.find(chapter=> chapter.bid == sync.bid)\n    chapter.chdocs = syncDoc(chapter.chdocs, sync)\n    let origin = book.sbooks.find(sbook=> sbook.origin)\n    let syncs = getSyncs(origin.bid)\n    syncs.push(sync)\n    syncstore.set(origin.bid, syncs)\n\n    drawPage(this.chapters)\n    semaphore.ready()\n  },\n  localSearch() {\n    // let instance = this.markInstance\n    let instance = new Mark(q('.page'))\n    if (this.localquery.length < 2) {\n      instance.unmark()\n      return\n    }\n    let query = this.localquery\n    instance.unmark({\n  \t  done: function() {\n        instance.mark(query, {\n          \"element\": \"span\",\n          \"className\": \"highlight\"\n        })\n      }\n    })\n  },\n  drawPage() {\n    drawPage(this.chapters)\n  },\n  scroll(state) {\n    let qblockid = state.blockid\n    if (state.context) {\n      // todo: тоже изменить\n      let recontext = new RegExp('^' + state.context)\n      for (let book of this.sbooks) {\n        let blockid = 0\n        for (let doc of book.chdocs) {\n          if (doc.md.split(state.context).length == 2) qblockid = blockid\n          blockid ++\n        }\n      }\n    }\n    const selector =['#src .block[blockid=\"', qblockid, '\"]'].join('')\n    const oblock = q(selector)\n    if (!oblock) return\n\n    // todo: state.stem ?\n    if (state.query) {\n      let markInstance = new Mark(oblock)\n      markInstance.mark(state.query, {\n        \"element\": \"span\",\n        \"className\": \"highlight\"\n      })\n    }\n    scrollToPosition(oblock.offsetTop - 100)\n  },\n}\n\nfunction drawPage(chapters) {\n  const scrollTop = q('.page').scrollTop\n  let {osrc, otrn} = setPanes(book.sbooks)\n  const src = dgl.origin(chapters)\n  const trn = dgl.shown(chapters)\n  if (!src) return\n  let trns = dgl.trns(chapters)\n  let oBlock\n\n  src.chdocs.forEach((doc, blockid)=> {\n    const aligns = []\n    oBlock = create('div', 'block')\n    oBlock.setAttribute('blockid', blockid)\n    osrc.appendChild(oBlock)\n    let opar = parsePar(doc, src.lang)\n\n    oBlock.appendChild(opar)\n    aligns.push(opar)\n\n    if (!trn) return\n    let otrnBlock = create('div', 'block')\n    otrnBlock.setAttribute('blockid', blockid)\n    otrn.appendChild(otrnBlock)\n    trns.forEach(trn=> {\n      let trndoc = trn.chdocs[blockid]\n      if (!trndoc) return\n      let opar = parsePar(trndoc, trn.lang)\n      if (!trn.shown) opar.setAttribute('hdn', true)\n      otrnBlock.appendChild(opar)\n      aligns.push(opar)\n    })\n    alignPars(aligns)\n  })\n  scrollToPosition(scrollTop)\n}\n\nexport function getSyncs(bid) {\n  let syncs = syncstore.get(bid)\n  if (_.isEmpty(syncs)) syncs = []\n  return syncs\n}\n\n// todo: export - del - для create external package\nexport function syncDoc(docs, sync) {\n  let blockid = sync.blockid\n  let doc = docs[blockid]\n  if (!doc) return docs\n  let newdoc, mess\n\n  switch(sync.action) {\n  case 'delete':\n    doc.skip = true\n    break\n  case 'empty':\n    doc.md = 'x'\n    // mess = 'paragraph emptied'\n    break\n  case 'copy':\n    newdoc = _.clone(doc)\n    docs.splice(blockid+1, 0, newdoc)\n    // mess = 'paragraph copied'\n    break\n  case 'mergeNext':\n    let next = docs[blockid+1]\n    if (!next) return docs\n    doc.md = [doc.md, next.md].join(' ')\n    next.skip = true\n    // mess = 'paragraphs merged'\n    break\n  case 'breakParagraph':\n    let md = doc.md.toString()\n    let cindex = md.indexOf(sync.param.context)\n    let context = md.slice(cindex)\n    let index = context.indexOf(sync.param.text)\n    let head = doc.md.slice(0, cindex+index)\n    let tail = doc.md.slice(cindex+index)\n    if (_.last(head) == '‘') head = head.replace(/‘$/, ''), tail = ['‘', tail].join('')\n    doc.md = head\n    newdoc = _.clone(doc)\n    newdoc.md = tail\n    docs.splice(blockid+1, 0, newdoc)\n    // mess = ['paragraph broken by \\\"', sync.param.text, '\\\"'].join(' ')\n    break\n  case 'breakSection':\n    // todo:\n    break\n  case 'insertAfter':\n    newdoc = _.clone(doc)\n    newdoc.md = 'x'\n    newdoc.fake = true\n    docs.splice(blockid+1, 0, newdoc)\n    // mess = 'empty paragraph incerted'\n    break\n  case 'insertBefore':\n    newdoc = _.clone(doc)\n    newdoc.md = 'x'\n    newdoc.fake = true\n    docs.splice(blockid, 0, newdoc)\n    // mess = ''empty paragraph incerted'\n    break\n  case 'action':\n    break\n  case 'action':\n    break\n  default:\n    // todo: any key press:\n    message.show('edit actions are d, e, c, m, ia, ib, b, & ctrl+z (undo)', 'darkred')\n  }\n  docs = _.filter(docs, doc=> !doc.skip)\n  docs.forEach((doc, idx)=> doc.idx = idx)\n  return docs\n}\n\nexport function alignPars(opars) {\n  let heights = _.map(opars, opar => { return opar.scrollHeight })\n  let max = _.max(heights)  + 'px'\n  opars.forEach((opar, idx) => {\n    opar.style.height = max\n    if (opar.getAttribute('hdn')) opar.classList.add('hidden')\n  })\n}\n\nfunction parsePar(doc, lang) {\n  let parent = create('div')\n  if (!doc.md) doc.md = '**empty paragraph**'\n  let md = ndash(doc.md)\n  parent.innerHTML = marked(md)\n  let opar = parent.firstChild\n  opar.classList.add('ptext')\n  opar.setAttribute('_id', doc._id) // отсюда узнаю path при поиске ref\n  opar.setAttribute('lang', lang)\n  if (doc.refnotes) opar.setAttribute('refnotes', JSON.stringify(doc.refnotes))\n  if (doc.imgsrc) opar.setAttribute('imgsrc', doc.imgsrc)\n  if (doc.type == 'list') opar.classList.add('plist')\n  else if (doc.type == 'ulist') opar.classList.add('plist'), opar.classList.add('ul')\n  if (doc.level) {\n    let levstyle = ['h', doc.level].join('')\n    opar.classList.add(levstyle)\n  }\n  return opar\n}\n\nfunction wrapSpan(opar) {\n  opar.innerHTML = opar.innerHTML.replace(/(\\[[^\\]]{1,4}\\])/g, \"<span class=\\\"ref\\\">$1</span>\")\n  let nodes = opar.childNodes\n  // let names = _.map(nodes, node=> node.nodeName)\n  let html = ''\n  nodes.forEach(node=> {\n    if (node.nodeType == 3) {\n      let text = node.nodeValue\n      // text = text.replace(/\\'/g, '᾽').replace(/\\’/g, '᾽') // apocope - todo: нужно включить для greek-plugin\n      html += text.replace(/([^\\p{P} ]+)/ug, \"<span class=\\\"wf\\\">$1</span>\")\n    } else if (node.nodeName == 'EM') {\n      html += ['<em>', wrapSpan(node), '</em>'].join('')\n    } else {\n      html += node.outerHTML\n    }\n  })\n  return html\n}\n\n// todo: mousetrap\nlet scrollByKey = function(ev) {\n  const opage = q('.page')\n  if (!opage) return\n  let height = opage.clientHeight\n  if (ev.keyCode == 38) { // arrow up\n    if (ev.ctrlKey) opage.scrollTop = 0\n    else opage.scrollTop = opage.scrollTop - 24\n  } else if (ev.keyCode == 40) { // arrow down\n    opage.scrollTop = opage.scrollTop + 24\n  } else if (ev.keyCode == 33) { // pageUp\n    opage.scrollTop = opage.scrollTop - height + 60\n  } else if (ev.keyCode == 34) { // pageDown\n    opage.scrollTop = opage.scrollTop + height - 60\n  } else if (ev.keyCode == 36) { // home, ctrl-home\n    opage.scrollTop = 0\n  } else if (ev.keyCode == 35) { // end, ctrl-end\n    opage.scrollTop = opage.scrollHeight - opage.clientHeight;\n  }\n  // show position:\n  let osrc = q('#src')\n  if (!osrc) return\n  let hidden = osrc.classList.contains('hidden')\n  if (hidden) osrc = q('#trn')\n  let scrolltop = opage.scrollTop\n  height  = osrc.clientHeight\n  let ohr = q('.show-page-position')\n  if (!ohr) return\n  ohr.style.width = (scrolltop/height)*90 + '%'\n  if (dgl.route == 'book') ohr.style.width = 0\n}\n\nfunction getPanes() {\n  let osrc = q('#src')\n  let otrn = q('#trn')\n  return {osrc, otrn}\n}\n\nfunction setPanes(books) {\n  let {osrc, otrn} = getPanes()\n  empty(osrc)\n  empty(otrn)\n  let opage = document.querySelector('.page')\n  if (books.length == 1) {\n    opage.classList.remove('grid-cols-2')\n    otrn.classList.add('hidden')\n  } else if (book.layout) {\n    opage.classList.remove('grid-cols-2')\n    if (book.layout == 'src') {\n      osrc.classList.remove('hidden')\n      otrn.classList.add('hidden')\n    }  else if (book.layout == 'trn') {\n      osrc.classList.add('hidden')\n      otrn.classList.remove('hidden')\n    }\n  } else {\n    opage.classList.add('grid-cols-2')\n    osrc.classList.remove('hidden')\n    otrn.classList.remove('hidden')\n  }\n  return {osrc, otrn}\n}\n\ndocument.addEventListener(\"keydown\", scrollByKey)\n\n// wrap wf to span\ndocument.addEventListener(\"mouseover\", function(ev) {\n  if (!q('.book')) return\n  let target = ev.target\n  if (!target.classList.contains('ptext')) return\n  if (!target.getAttribute('ok')) {\n    const html = wrapSpan(target)\n    target.innerHTML = html\n    target.setAttribute('ok', true)\n  }\n})\n\n// show footnote\ndocument.addEventListener (\"click\",  async (ev) => {\n  if (!dgl.bid || dgl.editMode) return\n  let owf = ev.target.closest('span.ref')\n  if (!owf) return\n  let reftext = owf.textContent\n  if (!reftext) return\n  let bid = owf.closest('#src') ? dgl.origin(book.sbooks).bid : dgl.shown(book.sbooks).bid\n  if (!bid) return\n\n  let opar = ev.target.closest('p.ptext')\n  let parid = opar.getAttribute('_id')\n  let refnotes = opar.getAttribute('refnotes')\n  if (!refnotes) return\n  let path = _.first(parid.split('-'))\n  let ref = reftext.replace(/[\\[\\]]/g, '')\n  let notes = JSON.parse(refnotes)\n  let ref_id = notes[ref]\n  let res = await fetchFN([ref_id], [bid])\n  let fntext = ''\n  if (!res[0]) fntext = 'not found'\n  else fntext = res[0].md\n\n  let ofn = q('#footnote') || create('div', 'footnote')\n  ofn.id = 'footnote'\n  ofn.textContent = fntext\n  document.body.appendChild(ofn)\n  let coords = getCoords(owf)\n  placePopup(coords, ofn)\n})\n\n// hide footnote\ndocument.addEventListener (\"click\",  async (ev) => {\n  // todo: сейчас закрываю по esc и по клику. а как правильно?\n  let ofn = q('#footnote')\n  if (ofn) remove(ofn)\n})\n\ndocument.addEventListener(\"wheel\", function(ev) {\n  if (!ev.shiftKey) return\n  if (dgl.route != 'page') return\n  let oblock = ev.target.closest('.block')\n  if (!oblock) return\n  rotateBlock(oblock)\n  oblock = ev.target.closest('.header-cell.right .block')\n  if (!oblock) return\n  let par = oblock.querySelector('p.headline:not(.hidden)')\n  let bid = par.getAttribute('bid')\n\n  for (let chapter of page.chapters) {\n    if (chapter.origin) continue\n    chapter.shown = false\n    if (chapter.bid == bid) chapter.shown = true\n  }\n  page.reload()\n}, false)\n\n// ===============\n\nlet localSearch = function(ev) {\n  if (dgl.editMode) return\n  if (dgl.route != 'page') return\n  if (ev.which == 8) page.localquery = page.localquery.slice(0, -1)\n  else if (ev.which == 27) page.localquery = ''\n  else if (ev.key.length > 1) return\n  else if (ev.ctrlKey) return\n  else page.localquery += ev.key\n  page.localSearch()\n}\n\ndocument.addEventListener(\"keydown\", localSearch)\n\nasync function exitEditMode(ev) { // ESC\n  if (ev.which != 27) return\n  if (!q('.header') || !dgl.editMode) return\n  dgl.editMode = false\n  removeEditStyle()\n  let origin = book.sbooks.find(sbook=> sbook.origin)\n  let syncs = getSyncs(origin.bid)\n  syncs = syncs.filter(sync=> !sync.tmp)\n  syncstore.set(origin.bid, syncs)\n\n  if (dgl.idx > -1) {\n    let chapters = _.cloneDeep(page.copy)\n    await page.syncChapters(chapters, syncs)\n    drawPage(chapters)\n  }\n\n  header.ready()\n  let omarks = qs('.synchroMark')\n  removeAll(omarks)\n  message.show('all last changes lost', 'darkgreen')\n  // else book.reload() // todo: book.reload()\n}\n\ndocument.addEventListener(\"keydown\", exitEditMode)\n\nmouse.bind('ctrl+s', async function(ev) {\n  saveEditChanges()\n})\n\ndocument.addEventListener (\"click\",  (ev) => {\n  let osave = ev.target.closest('.em-save')\n  if (!osave) return\n  saveEditChanges()\n})\n\nasync function saveEditChanges() {\n  if (!q('.header') || !dgl.editMode) return\n  dgl.editMode = false\n  removeEditStyle()\n  message.hide()\n  let origin = book.sbooks.find(sbook=> sbook.origin)\n  let syncs = getSyncs(origin.bid)\n\n  if (dgl.idx) {\n    let syncs = getSyncs(origin.bid)\n    syncs = syncs.map(sync=> {\n      let newsync = {bid: sync.bid, action: sync.action, idx: sync.idx, blockid: sync.blockid}\n      if (sync.param) newsync.param = sync.param\n      return newsync\n    })\n    syncstore.set(dgl.bid, syncs)\n  }\n  header.ready()\n  message.show('changes saved', 'darkgreen')\n  let omarks = qs('.synchroMark')\n  removeAll(omarks)\n}\n\nfunction showSearchIcon() {\n  q('#search-icon').classList.remove('hidden')\n}\n\nfunction showPagePosition() {\n  let obody = q('body')\n  let opos = create('hr', 'show-page-position')\n  obody.appendChild(opos)\n}\n","'use strict'\n\nimport { log, q, qs, create, empty, cleanDname } from './lib/utils'\nimport _ from 'lodash'\nimport { router, render } from './app'\nconst mouse = require('mousetrap')\nconst { app } = require('electron').remote\nimport { remote } from \"electron\"\nlet dgl = remote.getGlobal('dgl')\nconst { dialog } = require('electron').remote\nimport { book } from './book'\nimport { progress } from './lib/progress'\nimport { message } from './lib/message'\n\nconst Store = require('electron-store')\nconst prefstore = new Store({name: 'prefs'})\nconst appstore = new Store({name: 'appstore'})\n\nlet homepath = app.getPath('home');\nlet exportpath = appstore.get('exportpath')\nif (!exportpath) {\n  exportpath = homepath\n  appstore.set('exportpath', exportpath)\n}\n\nexport const preference = {\n  async ready() {\n    let books = book.sbooks\n    if (!books) {\n      message.show('select a book first','darkred')\n      return\n    }\n    render('prefs')\n    this.tbody = q('#prefs-table .tbody')\n    const odata = q('#pref-package-data')\n    let origin = dgl.origin(books)\n    let oauthor = odata.querySelector('#pref-book-author')\n    oauthor.textContent = origin.descr.author\n    let otitle = odata.querySelector('#pref-book-title')\n    otitle.textContent = origin.descr.title\n    this.origin = origin\n\n    let prefs = prefstore.get(origin.bid) || this.initPrefs(origin)\n    this.prefs = prefs\n\n    const oexportpath = q('#exportpath')\n    oexportpath.textContent = exportpath\n\n    for (let name in prefs) {\n      if (name == 'exportpath') continue\n      if (name == 'bpath') continue\n      if (name == 'files') {\n        let files = prefs.files\n        for (let fn in files) {\n          // let value = files[fn]\n          // this.addRow('file', fn, value)\n        }\n      } else {\n        this.addRow('str', name, prefs[name])\n      }\n    }\n    this.stripes()\n  },\n\n  initPrefs(origin) {\n    let defaults = {\n      version: '1.0.0',\n      'editor': 'John Doe',\n      email: 'john.doe@example.com',\n      homepage: 'http://example.com',\n      license: 'CC BY-SA',\n      keywords: 'diglossa, bilingua, dgl',\n      // 'exportpath': exportpath,\n      // files: {\n      //   css: 'path-to-file',\n      //   images: 'path-to-file',\n      //   info: 'path-to-file',\n      //   annotation: 'path-to-file',\n      //   license: 'path-to-file',\n      //   acknowledgements: 'path-to-file'\n      // },\n    }\n    defaults.name = [origin.descr.author, origin.descr.title].join(' ').replace(/ +/g, '-')\n    prefstore.set(origin.bid, defaults)\n    return defaults\n  },\n\n  // savePrefs(type, name, value) {\n  //   let bid = this.origin.bid\n  //   let prefs = this.prefs\n  //   if (type == 'dir') prefs[name] = value\n  //   else if (type == 'file') prefs.files[name] = value\n  //   else if (type == 'value') prefs[name] = value\n  //   prefstore.set(bid, prefs)\n  // },\n\n  addRow(type, name, value) {\n    const tmpl = q('.table-line.tmpl')\n    const orow = tmpl.cloneNode(true)\n    orow.classList.remove('tmpl')\n    orow.setAttribute('type', type)\n    orow.setAttribute('prefname', name)\n    orow.setAttribute('contenteditable', true)\n    let oname = orow.querySelector('.td-name')\n    let ovalue = orow.querySelector('.td-value')\n    oname.textContent = name\n    ovalue.textContent = value\n    this.tbody.appendChild(orow)\n  },\n\n  stripes() {\n    let orows = qs('.table-line:not(.hidden)')\n    let n = 0\n    for (let orow of orows) {\n      if ((n % 2) === 1) orow.classList.remove('odd'), orow.classList.add('even')\n      else orow.classList.add('odd'), orow.classList.remove('even')\n      n++\n    }\n  },\n}\n\ndocument.addEventListener('click',  (ev) => {\n  let opack = ev.target.closest('#package')\n  if (opack) openDialogExportPath()\n})\n\nfunction openDialogExportPath() {\n  dialog.showOpenDialog({properties: ['openDirectory'] })\n    .then(result => {\n      const bpath = result.filePaths[0]\n      if (!bpath) return\n      exportpath = bpath\n      appstore.set('exportpath', bpath)\n      preference.ready()\n    }).catch(err => {\n      console.log(err)\n    })\n}\n\ndocument.addEventListener('keydown', ev => {\n  if (ev.key !== 'Enter') return\n  ev.preventDefault()\n  let orow = ev.target.closest('.table-line')\n  if (!orow) return\n  let name = orow.querySelector('.td-name').textContent.trim()\n  let value = orow.querySelector('.td-value').textContent.trim()\n  let prefname = [preference.origin.bid, name].join('.')\n  prefstore.set(prefname, value)\n  preference.ready()\n})\n\n\nmouse.bind('ctrl+p', function(ev) {\n  const state = {route: 'preference'}\n  router(state)\n})\n","'use strict';\n\nimport _ from 'lodash'\nimport { clipboard, ipcRenderer } from \"electron\";\nimport { log, q, empty, create, tokenizer } from './lib/utils'\nimport { router, render } from './app'\nimport { fetchBook, fetchChapterDocs, fetchBlock } from \"./lib/pouch\";\nconst mouse = require('mousetrap')\nconst FlexSearch = require(\"flexsearch\")\nimport { progress } from './lib/progress'\nconst Mark = require('mark.js')\nimport { page, getSyncs } from './page'\nimport { message } from './lib/message'\nimport { book, getCSyncs } from './book'\nimport { porter } from './lib/stemmer'\nimport { rotateBlock } from './header'\nimport { getSyncedDocs } from './exportBook'\n\nimport { remote } from \"electron\"\nlet dgl = remote.getGlobal('dgl')\nlet templates = remote.getGlobal('templates')\n\nconst Store = require('electron-store')\nconst ftstore = new Store({name: 'fts'})\nconst bkstore = new Store({name: 'libks'})\nconst syncstore = new Store({name: 'syncs'})\n\nconst ftsopts =  {\n  depth: 3,\n  doc: {\n    id: 'idx',\n    field: 'md',\n    store: 'ids'\n  },\n  tokenize: function(str) {\n    return str.split(/[\\p{P} ]+/ug).filter(Boolean)\n  }\n}\n\nlet fts = importFts()\n\nfunction importFts() {\n  let fts = []\n  for (let lang in ftstore.store) {\n    let langfts = ftstore.store[lang]\n    for (let bid in langfts) {\n      let bidfts = langfts[bid]\n      for (let cntidx in bidfts) {\n        let json = bidfts[cntidx]\n        let ftsidx = new FlexSearch(ftsopts)\n        ftsidx.import(json)\n        ftsidx.bid = bid\n        ftsidx.lang = lang\n        ftsidx.cntidx = cntidx\n        fts.push(ftsidx)\n      }\n    }\n  }\n  return fts\n}\n\nipcRenderer.on('generateFTS', function (event) {\n  generateFTS()\n})\n\n// todo: remove generateFTS\nmouse.bind('ctrl+g', function(ev) {\n  generateFTS()\n})\n\nasync function generateFTS() {\n  if (!dgl.bid) {\n    message.show('select a book', 'darkred')\n    return\n  }\n  progress.show()\n  let oprocent = q('#dict-progress')\n  let originbid = dgl.origin(book.sbooks).bid\n\n  let origin = dgl.origin(book.sbooks)\n  let csyncs = getCSyncs(origin.bid)\n  let syncs  = getSyncs(origin.bid)\n\n  let sbooks = dgl.actives(book.sbooks)\n  book.sbooks = book.syncCnts(sbooks, csyncs)\n\n  for await (let sbook of book.sbooks) {\n    let mess = ['indexing', sbook.lang, sbook.descr.title, '...'].join(' - ')\n    message.show(mess, 'darkgreen', true)\n\n    let total = sbook.cnts.length\n    const stemmer = porter(sbook.lang)\n\n    for await (let cnt of sbook.cnts) {\n      showProgress(oprocent, total, cnt.idx+1)\n      await sleep(1000)\n      let queries = book.sbooks.map(sbook=> {\n        let qcnt = sbook.cnts[cnt.idx]\n        if (!qcnt) return false\n        return {bid: sbook.bid, path: qcnt.path, size: qcnt.size, lang: sbook.lang}\n      })\n      queries = _.compact(queries)\n\n      // let chapters = await fetchChapterDocs(queries)\n      // chapters = page.syncDocs(syncs, chapters)\n      let chapters = await page.getChapters(book, cnt.idx)\n      chapters = await syncChapters(chapters, syncs)\n\n      let chapter = chapters.find(chapter=> chapter.bid == sbook.bid)\n      let chdocs = chapter.chdocs\n\n      let clean, doc\n      let cleans = chdocs.map((chdoc, idx)=> {\n        // if (!chdoc.md) log('_NO MD', idx, chdoc)\n        let ids = chapters.map((chapter, idy)=> {\n          doc = chapter.chdocs[idx]\n          if (!doc) return false\n          return {bid: idy, id: doc._id}\n        })\n        ids = _.compact(ids)\n        clean = {idx, ids}\n        try {\n          if (stemmer) clean.md = tokenizer(chdoc.md).map(wf=> stemmer(wf)).join(' ')\n          else clean.md = chdoc.md\n        } catch(err) {\n          console.log('_ERR TOKEN:', err)\n          return null\n        }\n        return clean\n      })\n      cleans = _.compact(cleans)\n\n      let ftspath = [sbook.lang, originbid, cnt.idx].join('.')\n      let ftsidx = new FlexSearch(ftsopts)\n      ftsidx.add(cleans)\n      let json = ftsidx.export()\n      ftstore.set(ftspath, json)\n    } // for sbook.cnts\n  }\n\n  fts = importFts()\n  oprocent.classList.add('hidden')\n  let mess = 'full text search index generated'\n  message.show(mess, 'darkgreen')\n\n}\n\n// // todo: через export getSyncs, del\n// function getSyncs(bid) {\n//   let syncs = syncstore.get(bid)\n//   if (_.isEmpty(syncs)) syncs = []\n//   return syncs\n// }\n\n// это почти копия из page\nasync function syncChapters(chapters, syncs) {\n  for await (let chapter of chapters) {\n    let booksyncs = syncs.filter(sync=> sync.bid == chapter.bid)\n    chapter.chdocs = await page.syncChapter(booksyncs, chapter.chdocs)\n  }\n  return chapters\n}\n\nconst sleep = ms => {\n  return new Promise(resolve=> {\n    setTimeout(() => resolve(), ms)\n  })\n}\nfunction showProgress(oprocent, total, size) {\n  oprocent.classList.remove('hidden')\n  let percent = Math.round(size*100/total)\n  if (percent < 100) oprocent.textContent = [percent, '%'].join(' ')\n  else oprocent.textContent = '', oprocent.classList.add('hidden')\n}\n\nexport const search = {\n  async ready(state) {\n    progress.show()\n    render('search')\n    const oquery = q('#search-query')\n    oquery.textContent = state.query\n    this.query(state)\n  },\n  async query(state) {\n    let results = []\n    for await (let ftsidx of fts) {\n      const stemmer = porter(ftsidx.lang)\n      let rstem\n      try {\n        rstem = state.query.split(' ').map(st=> stemmer(st))\n      } catch(err) {\n        // log('_ERR: bad stemmer')\n        continue\n      }\n      if (!rstem.length) continue\n      rstem = rstem.join(' ')\n\n      // let ftsres = ftsidx.search(stem, { limit: 5 })\n      let ftsres = ftsidx.search(rstem)\n      if (!ftsres.length) continue\n      for (let res of ftsres) {\n        results.push({bid: ftsidx.bid, cntidx: ftsidx.cntidx, lang: ftsidx.lang, ids: res.ids, rstem})\n      }\n    }\n\n    let randoms = _.shuffle(results)\n    let oresults = q('#search-list')\n    empty(oresults)\n    mark(q('.search-query'), state.query)\n\n    let orow\n    for await (let ftsres of randoms) {\n      orow = await this.parseBlock(ftsres)\n      if (!orow) return\n      oresults.appendChild(orow)\n      mark(orow, ftsres.rstem)\n    }\n    progress.hide()\n  },\n\n  async parseBlock(ftsres) {\n    let books = bkstore.get(ftsres.bid)\n    if (!books) return\n    let params = ftsres.ids.map((param, idx)=> {\n      param.bid = books[idx].bid\n      param.lang = books[idx].lang\n      return param\n    })\n    let dbdocs = await fetchBlock(params)\n    dbdocs = _.compact(dbdocs)\n    let mds = dbdocs.map(doc=> doc.md)\n    let origin = dgl.origin(books)\n    let sname = origin.cnts[ftsres.cntidx].md\n\n    const tmpl = q('.list-line.tmpl')\n    const orow = tmpl.cloneNode(true)\n    orow.classList.remove('tmpl')\n    orow.classList.remove('hidden')\n    orow.setAttribute('bid', ftsres.bid)\n    orow.setAttribute('idx', ftsres.cntidx)\n    orow.setAttribute('blockid', ftsres.blockid)\n\n    let ohead = orow.querySelector('.line-head')\n    let oauthor = ohead.querySelector('.line-author')\n    oauthor.textContent = origin.descr.author\n    let otitle = ohead.querySelector('.line-title')\n    otitle.textContent = origin.descr.title\n    let osname = ohead.querySelector('.line-sname')\n    osname.textContent = sname\n    ohead.classList.add('truncate')\n\n    let oblock = orow.querySelector('.block')\n    empty(oblock)\n\n    let shown = true\n    for (const dbdoc of dbdocs) {\n      let opar = create('p', 'ptext')\n      opar.setAttribute('lang', dbdoc.lang)\n      opar.textContent = dbdoc.md\n      if (shown) shown = false\n      else opar.classList.add('hidden')\n      oblock.appendChild(opar)\n    }\n    return orow\n  },\n}\n\nfunction mark(el, query) {\n  let markInstance = new Mark(el)\n  markInstance.mark(query, {\n    \"element\": \"span\",\n    \"className\": \"highlight\"\n  })\n}\n\nmouse.bind('ctrl+c', function(ev) {\n  const owf = q('span.wf:hover')\n  if (!owf) return\n  const text = owf.textContent\n  clipboard.writeText(text)\n})\n\ndocument.addEventListener (\"click\",  (ev) => {\n  if (dgl.route != 'search') return\n  const oheader = q('.header-active')\n  if (!oheader) return\n  let oinput = ev.target.closest('input.search-input')\n  if (!oinput) return\n  if (oheader.classList.contains('hidden')) {\n    hideSearchInput()\n  } else {\n    showSearchInput()\n  }\n})\n\nfunction showSearchInput(query) {\n  const oheader = q('.header-active')\n  if (!oheader) return\n  let oinput = q('input.search-input')\n  const osearch = q('#search')\n  oheader.classList.add('hidden')\n  osearch.classList.add('search-full')\n  oinput.classList.add('search-input-full')\n  oinput.placeholder = 'search...'\n  if (query) oinput.value = query\n}\n\nexport function hideSearchInput() {\n  const oheader = q('.header-active')\n  if (!oheader) return\n  let oinput = q('input.search-input')\n  const osearch = q('#search')\n  oheader.classList.remove('hidden')\n  osearch.classList.remove('search-full')\n  oinput.classList.remove('search-input-full')\n  oinput.placeholder = ''\n  oinput.value = ''\n}\n\n// todo: восстановить showSearchInput()\nmouse.bind('ctrl+f', function(ev) {\n  const owf = q('span.wf:hover')\n  if (!owf) return\n  const query = owf.textContent\n  const opar = owf.closest('p.ptext')\n  const lang = opar.getAttribute('lang')\n  const oblock = owf.closest('.block')\n  const blockid = oblock.getAttribute('blockid') * 1\n  // const books = bkstore.get(dgl.bid)\n  const origin = dgl.origin(book.sbooks)\n  const state = {route: 'search', bid: dgl.bid, idx: dgl.idx, blockid, query, lang, descr: origin.descr}\n  // search.query(state)\n  router(state)\n})\n\n// jump to search result\ndocument.addEventListener (\"click\",  (ev) => {\n  if (dgl.route != 'search') return\n  let oblock = ev.target.closest('.block')\n  if (oblock) return\n  const oline = ev.target.closest('.list-line')\n  if (!oline) return\n  const bid = oline.getAttribute('bid')\n  const idx = oline.getAttribute('idx') * 1\n  const context = oline.getAttribute('context')\n  let oquery = q('#search-query')\n  let query = oquery.textContent\n  const state = {route: 'page', bid, idx, query, context, jump: true}\n  router(state)\n})\n\ndocument.addEventListener(\"wheel\", function(ev) {\n  if (!ev.shiftKey) return\n  if (dgl.route != 'search') return\n  let oblock = ev.target.closest('.block')\n  if (!oblock) return\n  rotateBlock(oblock)\n}, false)\n\ndocument.addEventListener (\"click\",  (ev) => {\n  if (dgl.route != 'search') return\n  let oblock = ev.target.closest('.block')\n  if (!oblock) return\n  oblock.classList.toggle('truncate')\n})\n\ndocument.getElementById('search-icon').onclick = function () {\n  page.localquery = ''\n  let oicon = q('#search-icon')\n  oicon.classList.add('hidden')\n  let oinput = q('#search-input')\n  oinput.classList.remove('hidden')\n  oinput = q('.searchinput')\n  oinput.value = ''\n  oinput.focus();\n};\n\nlet escInput = function(ev) {\n  if (ev.which == 27) hideSearchField()\n  else if (ev.which == 13) fireFTSearch()\n}\n\ndocument.addEventListener('keydown', escInput, true);\n\nfunction hideSearchField() {\n  let oinput = q('.searchinput')\n  oinput.blur();\n  oinput = q('#search-input')\n  oinput.classList.add('hidden')\n  let oicon = q('#search-icon')\n  oicon.classList.remove('hidden')\n}\n\nfunction fireFTSearch() {\n  let oinput = q('.searchinput')\n  let query = oinput.value\n  if (!query) return\n  const state = {route: 'search', query}\n  // search.query(state)\n  router(state)\n  hideSearchField()\n}\n","'use strict';\n\nimport _ from 'lodash'\nimport { log, q, qs, create, previousSiblings, getCoords } from './lib/utils'\nimport { render } from './app'\nconst mouse = require('mousetrap')\nimport { message } from './lib/message'\nimport { header } from './header'\nimport { getFirstBlock } from './autosync'\nconst fse = require('fs-extra')\n\nconst Store = require('electron-store')\nconst syncstore = new Store({name: 'syncs'})\n\nconst natural = require('natural')\nconst tokenizer = new natural.WordTokenizer()\nconst sw = require('stopword')\nconst langs = require('langs')\n// const a = require('debug')('cycle')\n// const d = require('debug')('sync')\n\nimport { page, alignPars } from './page'\nimport { book } from './book'\n\nlet style = document.createElement('style')\nstyle.type = 'text/css'\nstyle.id = 'editStyle'\ndocument.getElementsByTagName('head')[0].appendChild(style)\n\nimport { remote } from \"electron\"\nlet dgl = remote.getGlobal('dgl')\nlet templates = remote.getGlobal('templates')\n\nfunction addEditStyle() {\n  style.innerHTML = 'p.ptext:hover {background-color: #eefddd; }'\n}\n\nexport function removeEditStyle() {\n  style.innerHTML = ''\n  let oed = q('.editable')\n  if (oed) oed.classList.remove('editable')\n  oed = q('.editable-wf')\n  if (oed) oed.classList.remove('editable-wf')\n}\n\nmouse.bind('ctrl+e', function(ev) {\n  if (!q('.header') || dgl.editMode) return\n  dgl.editMode = true\n  message.hide()\n  semaphore.ready()\n})\n\n// что тут происхоит при смене языка ?\nexport const semaphore = {\n  async ready() {\n    setEmptyHeader()\n    setSemaphore()\n    if (!dgl.idx) setCntSynchroMarks()\n  }\n}\n\nasync function setSemaphore() {\n  if (!book.shown()) return\n  let ocircle = q('svg #em-big-circle')\n  let oleft = q('#em-src-size')\n  let oright = q('#em-trn-size')\n  let osrc = q('#em-lang-origin')\n  let otrn = q('#em-lang-shown')\n  if (dgl.idx && page) {\n    // let chapters = await page.getChapters(book, dgl.idx)\n    let chapters = await page.chapters\n    let origin = dgl.origin(chapters)\n    let shown = dgl.shown(chapters)\n    if (origin.chdocs.length == shown.chdocs.length) ocircle.setAttribute('fill', 'green')\n    oleft.textContent = origin.chdocs.length\n    oright.textContent = shown.chdocs.length\n    osrc.textContent = origin.lang\n    otrn.textContent = shown.lang\n  }  else if (book) {\n    let origin = book.origin()\n    let shown = book.shown()\n    if (origin.cnts.length == shown.cnts.length) ocircle.setAttribute('fill', 'green')\n    oleft.textContent = origin.cnts.length\n    oright.textContent = shown.cnts.length\n    osrc.textContent = origin.lang\n    otrn.textContent = shown.lang\n  }\n}\n\nfunction setCntSynchroMarks() {\n  let osvg = q('svg.svg-circle')\n  if (!osvg) return\n  let oapp = q('#app')\n  let osrcs = qs('#src p.tree-text:not(.hidden)')\n\n  for (let osrc of osrcs) {\n    let idx = osrc.getAttribute('idx')\n    let srcsize = osrc.getAttribute('size')\n    let selector = ['#trn p.tree-text:not(.hidden)[idx=\"', idx, '\"]' ].join('')\n    let otrn = q(selector)\n    if (!otrn) continue\n    let oblock = otrn.closest('.block')\n    let trnsize = otrn.getAttribute('size')\n\n    const omark = osvg.cloneNode(true)\n    omark.classList.add('synchroMark')\n    oblock.parentNode.insertBefore(omark, oblock)\n    let title = [srcsize, trnsize].join('/')\n    let ocircle = omark.querySelector('circle')\n    if (srcsize == trnsize) ocircle.setAttribute('fill', 'green')\n    else ocircle.setAttribute('fill', 'red')\n    let otitle = create('title')\n    otitle.textContent = title\n    ocircle.appendChild(otitle)\n  }\n}\n\nfunction setEmptyHeader() {\n  let oheader = q('.header')\n  oheader.innerHTML = templates.semaphore\n  oheader.classList.remove('grid-cols-2')\n  addEditStyle()\n}\n\nfunction synchronize(action, param) {\n  if (!dgl.editMode) return\n  const oblock = q('.block:hover')\n  if (!oblock) {\n    message.show('select chapter / paragraph to synchronize', 'darkred')\n    return\n  }\n  let bid = oblock.closest('#src') ? book.origin().bid : book.shown().bid\n  let sync = {bid, action, tmp: true} // idx не нужен, bid только для origin/shown\n  if (dgl.idx > -1) {\n    const blockid = oblock.getAttribute('blockid') * 1\n    sync.blockid = blockid\n    sync.idx = dgl.idx\n    if (param) sync.param = param\n    page.reSync(sync)\n  } else {\n    const opar = oblock.querySelector('p.tree-text:hover:not(.hidden)')\n    if (!opar) return\n    const path = opar.getAttribute('path')\n    sync.path = path\n    book.reSync(sync)\n  }\n}\n\nmouse.bind('ctrl+z', function(ev) {\n  if (!dgl.editMode) return\n  if (dgl.idx > -1) page.undo()\n  else book.undo()\n})\n\nmouse.bind('d', function(ev) {\n  synchronize('delete')\n})\n\nmouse.bind('b', function(ev) {\n  let oed = q('.editable-wf')\n  if (!oed) {\n    message.show('choose wordform to break paragraph', 'darkred')\n    return\n  }\n  let text = oed.textContent\n  let prev, pprev, next, nnext\n  prev = oed.previousSibling.textContent\n  if (prev) pprev = oed.previousSibling.previousSibling.textContent\n  next = oed.nextSibling.textContent\n  if (next) nnext = oed.nextSibling.nextSibling.textContent\n  let context = [pprev, prev, text, next, nnext].join('')\n  let param = {context, text}\n  synchronize('breakParagraph', param)\n})\n\nmouse.bind('m', function(ev) {\n  synchronize('mergeNext')\n})\n\nmouse.bind('i a', function(ev) {\n  synchronize('insertAfter')\n})\n\nmouse.bind('i b', function(ev) {\n  synchronize('insertBefore')\n})\n\nmouse.bind('e', function(ev) {\n  synchronize('empty')\n})\n\nmouse.bind('c', function(ev) {\n  synchronize('copy')\n})\n\nmouse.bind('right', function(ev) {\n  synchronize('right')\n})\n\n// set editable block and wf\ndocument.addEventListener (\"click\",  (ev) => {\n  if (!dgl.editMode) return\n  let owf = ev.target.closest('span.wf')\n  if (!owf) return\n  let oblock = ev.target.closest('.block')\n  if (!oblock) return\n  let oed = q('.editable')\n  if (oed) oed.classList.remove('editable')\n  oblock.classList.add('editable')\n  oed = q('.editable-wf')\n  if (oed) oed.classList.remove('editable-wf')\n  owf.classList.add('editable-wf')\n})\n\nmouse.bind('ctrl+t', function(ev) {\n  if (!dgl.editMode) return\n  if (!dgl.idx) return\n  let oblocks = qs('.page .block')\n  let oblock = q('.page .block[blockid=\"0\"]')\n  let trnk = oblock.classList.contains('truncate') ? true : false\n  _.each(oblocks, oblock=> {\n    if (trnk) oblock.classList.remove('truncate'), oblock.classList.remove('truncated')\n    else oblock.classList.add('truncate'), oblock.classList.add('truncated')\n  })\n  // todo: ??? а будет ли работать align pars без пересчета?\n})\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"/*! tailwindcss v2.1.2 | MIT License | https://tailwindcss.com */\\n\\n/*! modern-normalize v1.1.0 | MIT License | https://github.com/sindresorhus/modern-normalize */\\n\\n/*\\nDocument\\n========\\n*/\\n\\n/**\\nUse a better box model (opinionated).\\n*/\\n\\n*,\\n::before,\\n::after {\\n  box-sizing: border-box;\\n}\\n\\n/**\\nUse a more readable tab size (opinionated).\\n*/\\n\\nhtml {\\n  -moz-tab-size: 4;\\n  tab-size: 4;\\n}\\n\\n/**\\n1. Correct the line height in all browsers.\\n2. Prevent adjustments of font size after orientation changes in iOS.\\n*/\\n\\nhtml {\\n  line-height: 1.15; /* 1 */\\n  -webkit-text-size-adjust: 100%; /* 2 */\\n}\\n\\n/*\\nSections\\n========\\n*/\\n\\n/**\\nRemove the margin in all browsers.\\n*/\\n\\nbody {\\n  margin: 0;\\n}\\n\\n/**\\nImprove consistency of default fonts in all browsers. (https://github.com/sindresorhus/modern-normalize/issues/3)\\n*/\\n\\nbody {\\n  font-family:\\n\\t\\tsystem-ui,\\n\\t\\t-apple-system, /* Firefox supports this but not yet `system-ui` */\\n\\t\\t'Segoe UI',\\n\\t\\tRoboto,\\n\\t\\tHelvetica,\\n\\t\\tArial,\\n\\t\\tsans-serif,\\n\\t\\t'Apple Color Emoji',\\n\\t\\t'Segoe UI Emoji';\\n}\\n\\n/*\\nGrouping content\\n================\\n*/\\n\\n/**\\n1. Add the correct height in Firefox.\\n2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655)\\n*/\\n\\nhr {\\n  height: 0; /* 1 */\\n  color: inherit; /* 2 */\\n}\\n\\n/*\\nText-level semantics\\n====================\\n*/\\n\\n/**\\nAdd the correct text decoration in Chrome, Edge, and Safari.\\n*/\\n\\nabbr[title] {\\n  -webkit-text-decoration: underline dotted;\\n          text-decoration: underline dotted;\\n}\\n\\n/**\\nAdd the correct font weight in Edge and Safari.\\n*/\\n\\nb,\\nstrong {\\n  font-weight: bolder;\\n}\\n\\n/**\\n1. Improve consistency of default fonts in all browsers. (https://github.com/sindresorhus/modern-normalize/issues/3)\\n2. Correct the odd 'em' font sizing in all browsers.\\n*/\\n\\ncode,\\nkbd,\\nsamp,\\npre {\\n  font-family:\\n\\t\\tui-monospace,\\n\\t\\tSFMono-Regular,\\n\\t\\tConsolas,\\n\\t\\t'Liberation Mono',\\n\\t\\tMenlo,\\n\\t\\tmonospace; /* 1 */\\n  font-size: 1em; /* 2 */\\n}\\n\\n/**\\nAdd the correct font size in all browsers.\\n*/\\n\\nsmall {\\n  font-size: 80%;\\n}\\n\\n/**\\nPrevent 'sub' and 'sup' elements from affecting the line height in all browsers.\\n*/\\n\\nsub,\\nsup {\\n  font-size: 75%;\\n  line-height: 0;\\n  position: relative;\\n  vertical-align: baseline;\\n}\\n\\nsub {\\n  bottom: -0.25em;\\n}\\n\\nsup {\\n  top: -0.5em;\\n}\\n\\n/*\\nTabular data\\n============\\n*/\\n\\n/**\\n1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297)\\n2. Correct table border color inheritance in all Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016)\\n*/\\n\\ntable {\\n  text-indent: 0; /* 1 */\\n  border-color: inherit; /* 2 */\\n}\\n\\n/*\\nForms\\n=====\\n*/\\n\\n/**\\n1. Change the font styles in all browsers.\\n2. Remove the margin in Firefox and Safari.\\n*/\\n\\nbutton,\\ninput,\\noptgroup,\\nselect,\\ntextarea {\\n  font-family: inherit; /* 1 */\\n  font-size: 100%; /* 1 */\\n  line-height: 1.15; /* 1 */\\n  margin: 0; /* 2 */\\n}\\n\\n/**\\nRemove the inheritance of text transform in Edge and Firefox.\\n1. Remove the inheritance of text transform in Firefox.\\n*/\\n\\nbutton,\\nselect { /* 1 */\\n  text-transform: none;\\n}\\n\\n/**\\nCorrect the inability to style clickable types in iOS and Safari.\\n*/\\n\\nbutton,\\n[type='button'] {\\n  -webkit-appearance: button;\\n}\\n\\n/**\\nRemove the inner border and padding in Firefox.\\n*/\\n\\n/**\\nRestore the focus styles unset by the previous rule.\\n*/\\n\\n/**\\nRemove the additional ':invalid' styles in Firefox.\\nSee: https://github.com/mozilla/gecko-dev/blob/2f9eacd9d3d995c937b4251a5557d95d494c9be1/layout/style/res/forms.css#L728-L737\\n*/\\n\\n/**\\nRemove the padding so developers are not caught out when they zero out 'fieldset' elements in all browsers.\\n*/\\n\\nlegend {\\n  padding: 0;\\n}\\n\\n/**\\nAdd the correct vertical alignment in Chrome and Firefox.\\n*/\\n\\nprogress {\\n  vertical-align: baseline;\\n}\\n\\n/**\\nCorrect the cursor style of increment and decrement buttons in Safari.\\n*/\\n\\n/**\\n1. Correct the odd appearance in Chrome and Safari.\\n2. Correct the outline style in Safari.\\n*/\\n\\n[type='search'] {\\n  -webkit-appearance: textfield; /* 1 */\\n  outline-offset: -2px; /* 2 */\\n}\\n\\n/**\\nRemove the inner padding in Chrome and Safari on macOS.\\n*/\\n\\n/**\\n1. Correct the inability to style clickable types in iOS and Safari.\\n2. Change font properties to 'inherit' in Safari.\\n*/\\n\\n/*\\nInteractive\\n===========\\n*/\\n\\n/*\\nAdd the correct display in Chrome and Safari.\\n*/\\n\\nsummary {\\n  display: list-item;\\n}\\n\\n/**\\n * Manually forked from SUIT CSS Base: https://github.com/suitcss/base\\n * A thin layer on top of normalize.css that provides a starting point more\\n * suitable for web applications.\\n */\\n\\n/**\\n * Removes the default spacing and border for appropriate elements.\\n */\\n\\nblockquote,\\ndl,\\ndd,\\nh1,\\nh2,\\nh3,\\nh4,\\nh5,\\nh6,\\nhr,\\nfigure,\\np,\\npre {\\n  margin: 0;\\n}\\n\\nbutton {\\n  background-color: transparent;\\n  background-image: none;\\n}\\n\\n/**\\n * Work around a Firefox/IE bug where the transparent `button` background\\n * results in a loss of the default `button` focus styles.\\n */\\n\\nbutton:focus {\\n  outline: 1px dotted;\\n  outline: 5px auto -webkit-focus-ring-color;\\n}\\n\\nfieldset {\\n  margin: 0;\\n  padding: 0;\\n}\\n\\nol,\\nul {\\n  list-style: none;\\n  margin: 0;\\n  padding: 0;\\n}\\n\\n/**\\n * Tailwind custom reset styles\\n */\\n\\n/**\\n * 1. Use the user's configured `sans` font-family (with Tailwind's default\\n *    sans-serif font stack as a fallback) as a sane default.\\n * 2. Use Tailwind's default \\\"normal\\\" line-height so the user isn't forced\\n *    to override it to ensure consistency even when using the default theme.\\n */\\n\\nhtml {\\n  font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, \\\"Segoe UI\\\", Roboto, \\\"Helvetica Neue\\\", Arial, \\\"Noto Sans\\\", sans-serif, \\\"Apple Color Emoji\\\", \\\"Segoe UI Emoji\\\", \\\"Segoe UI Symbol\\\", \\\"Noto Color Emoji\\\"; /* 1 */\\n  line-height: 1.5; /* 2 */\\n}\\n\\n/**\\n * Inherit font-family and line-height from `html` so users can set them as\\n * a class directly on the `html` element.\\n */\\n\\nbody {\\n  font-family: inherit;\\n  line-height: inherit;\\n}\\n\\n/**\\n * 1. Prevent padding and border from affecting element width.\\n *\\n *    We used to set this in the html element and inherit from\\n *    the parent element for everything else. This caused issues\\n *    in shadow-dom-enhanced elements like <details> where the content\\n *    is wrapped by a div with box-sizing set to `content-box`.\\n *\\n *    https://github.com/mozdevs/cssremedy/issues/4\\n *\\n *\\n * 2. Allow adding a border to an element by just adding a border-width.\\n *\\n *    By default, the way the browser specifies that an element should have no\\n *    border is by setting it's border-style to `none` in the user-agent\\n *    stylesheet.\\n *\\n *    In order to easily add borders to elements by just setting the `border-width`\\n *    property, we change the default border-style for all elements to `solid`, and\\n *    use border-width to hide them instead. This way our `border` utilities only\\n *    need to set the `border-width` property instead of the entire `border`\\n *    shorthand, making our border utilities much more straightforward to compose.\\n *\\n *    https://github.com/tailwindcss/tailwindcss/pull/116\\n */\\n\\n*,\\n::before,\\n::after {\\n  box-sizing: border-box; /* 1 */\\n  border-width: 0; /* 2 */\\n  border-style: solid; /* 2 */\\n  border-color: #e5e7eb; /* 2 */\\n}\\n\\n/*\\n * Ensure horizontal rules are visible by default\\n */\\n\\nhr {\\n  border-top-width: 1px;\\n}\\n\\n/**\\n * Undo the `border-style: none` reset that Normalize applies to images so that\\n * our `border-{width}` utilities have the expected effect.\\n *\\n * The Normalize reset is unnecessary for us since we default the border-width\\n * to 0 on all elements.\\n *\\n * https://github.com/tailwindcss/tailwindcss/issues/362\\n */\\n\\nimg {\\n  border-style: solid;\\n}\\n\\ntextarea {\\n  resize: vertical;\\n}\\n\\ninput::placeholder,\\ntextarea::placeholder {\\n  opacity: 1;\\n  color: #9ca3af;\\n}\\n\\nbutton {\\n  cursor: pointer;\\n}\\n\\ntable {\\n  border-collapse: collapse;\\n}\\n\\nh1,\\nh2,\\nh3,\\nh4,\\nh5,\\nh6 {\\n  font-size: inherit;\\n  font-weight: inherit;\\n}\\n\\n/**\\n * Reset links to optimize for opt-in styling instead of\\n * opt-out.\\n */\\n\\na {\\n  color: inherit;\\n  text-decoration: inherit;\\n}\\n\\n/**\\n * Reset form element properties that are easy to forget to\\n * style explicitly so you don't inadvertently introduce\\n * styles that deviate from your design system. These styles\\n * supplement a partial reset that is already applied by\\n * normalize.css.\\n */\\n\\nbutton,\\ninput,\\noptgroup,\\nselect,\\ntextarea {\\n  padding: 0;\\n  line-height: inherit;\\n  color: inherit;\\n}\\n\\n/**\\n * Use the configured 'mono' font family for elements that\\n * are expected to be rendered with a monospace font, falling\\n * back to the system monospace stack if there is no configured\\n * 'mono' font family.\\n */\\n\\npre,\\ncode,\\nkbd,\\nsamp {\\n  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \\\"Liberation Mono\\\", \\\"Courier New\\\", monospace;\\n}\\n\\n/**\\n * Make replaced elements `display: block` by default as that's\\n * the behavior you want almost all of the time. Inspired by\\n * CSS Remedy, with `svg` added as well.\\n *\\n * https://github.com/mozdevs/cssremedy/issues/14\\n */\\n\\nimg,\\nsvg,\\nvideo,\\ncanvas,\\naudio,\\niframe,\\nembed,\\nobject {\\n  display: block;\\n  vertical-align: middle;\\n}\\n\\n/**\\n * Constrain images and videos to the parent width and preserve\\n * their intrinsic aspect ratio.\\n *\\n * https://github.com/mozdevs/cssremedy/issues/14\\n */\\n\\nimg,\\nvideo {\\n  max-width: 100%;\\n  height: auto;\\n}\\n\\n.bg-white {\\n  --tw-bg-opacity: 1;\\n  background-color: rgba(255, 255, 255, var(--tw-bg-opacity));\\n}\\n\\n.bg-gray-100 {\\n  --tw-bg-opacity: 1;\\n  background-color: rgba(243, 244, 246, var(--tw-bg-opacity));\\n}\\n\\n.bg-gray-200 {\\n  --tw-bg-opacity: 1;\\n  background-color: rgba(229, 231, 235, var(--tw-bg-opacity));\\n}\\n\\n.bg-red-500 {\\n  --tw-bg-opacity: 1;\\n  background-color: rgba(239, 68, 68, var(--tw-bg-opacity));\\n}\\n\\n.bg-green-500 {\\n  --tw-bg-opacity: 1;\\n  background-color: rgba(16, 185, 129, var(--tw-bg-opacity));\\n}\\n\\n.bg-blue-500 {\\n  --tw-bg-opacity: 1;\\n  background-color: rgba(59, 130, 246, var(--tw-bg-opacity));\\n}\\n\\n.hover\\\\:bg-red-700:hover {\\n  --tw-bg-opacity: 1;\\n  background-color: rgba(185, 28, 28, var(--tw-bg-opacity));\\n}\\n\\n.hover\\\\:bg-green-700:hover {\\n  --tw-bg-opacity: 1;\\n  background-color: rgba(4, 120, 87, var(--tw-bg-opacity));\\n}\\n\\n.hover\\\\:bg-blue-700:hover {\\n  --tw-bg-opacity: 1;\\n  background-color: rgba(29, 78, 216, var(--tw-bg-opacity));\\n}\\n\\n.border-gray-300 {\\n  --tw-border-opacity: 1;\\n  border-color: rgba(209, 213, 219, var(--tw-border-opacity));\\n}\\n\\n.rounded {\\n  border-radius: 0.25rem;\\n}\\n\\n.rounded-lg {\\n  border-radius: 0.5rem;\\n}\\n\\n.border {\\n  border-width: 1px;\\n}\\n\\n.border-b {\\n  border-bottom-width: 1px;\\n}\\n\\n.block {\\n  display: block;\\n}\\n\\n.flex {\\n  display: flex;\\n}\\n\\n.table {\\n  display: table;\\n}\\n\\n.grid {\\n  display: grid;\\n}\\n\\n.hidden {\\n  display: none;\\n}\\n\\n.flex-row {\\n  flex-direction: row;\\n}\\n\\n.flex-col {\\n  flex-direction: column;\\n}\\n\\n.flex-nowrap {\\n  flex-wrap: nowrap;\\n}\\n\\n.items-start {\\n  align-items: flex-start;\\n}\\n\\n.items-center {\\n  align-items: center;\\n}\\n\\n.justify-end {\\n  justify-content: flex-end;\\n}\\n\\n.justify-center {\\n  justify-content: center;\\n}\\n\\n.justify-between {\\n  justify-content: space-between;\\n}\\n\\n.flex-grow-0 {\\n  flex-grow: 0;\\n}\\n\\n.flex-grow {\\n  flex-grow: 1;\\n}\\n\\n.font-semibold {\\n  font-weight: 600;\\n}\\n\\n.font-bold {\\n  font-weight: 700;\\n}\\n\\n.h-5 {\\n  height: 1.25rem;\\n}\\n\\n.h-6 {\\n  height: 1.5rem;\\n}\\n\\n.h-8 {\\n  height: 2rem;\\n}\\n\\n.h-full {\\n  height: 100%;\\n}\\n\\n.text-sm {\\n  font-size: 0.875rem;\\n  line-height: 1.25rem;\\n}\\n\\n.text-lg {\\n  font-size: 1.125rem;\\n  line-height: 1.75rem;\\n}\\n\\n.text-3xl {\\n  font-size: 1.875rem;\\n  line-height: 2.25rem;\\n}\\n\\n.m-4 {\\n  margin: 1rem;\\n}\\n\\n.m-8 {\\n  margin: 2rem;\\n}\\n\\n.m-auto {\\n  margin: auto;\\n}\\n\\n.mb-1 {\\n  margin-bottom: 0.25rem;\\n}\\n\\n.mb-2 {\\n  margin-bottom: 0.5rem;\\n}\\n\\n.ml-2 {\\n  margin-left: 0.5rem;\\n}\\n\\n.mr-3 {\\n  margin-right: 0.75rem;\\n}\\n\\n.mb-4 {\\n  margin-bottom: 1rem;\\n}\\n\\n.mr-6 {\\n  margin-right: 1.5rem;\\n}\\n\\n.mt-8 {\\n  margin-top: 2rem;\\n}\\n\\n.mb-10 {\\n  margin-bottom: 2.5rem;\\n}\\n\\n.focus\\\\:outline-none:focus {\\n  outline: 2px solid transparent;\\n  outline-offset: 2px;\\n}\\n\\n.overflow-hidden {\\n  overflow: hidden;\\n}\\n\\n.p-2 {\\n  padding: 0.5rem;\\n}\\n\\n.p-3 {\\n  padding: 0.75rem;\\n}\\n\\n.p-4 {\\n  padding: 1rem;\\n}\\n\\n.py-1 {\\n  padding-top: 0.25rem;\\n  padding-bottom: 0.25rem;\\n}\\n\\n.px-1 {\\n  padding-left: 0.25rem;\\n  padding-right: 0.25rem;\\n}\\n\\n.px-2 {\\n  padding-left: 0.5rem;\\n  padding-right: 0.5rem;\\n}\\n\\n.px-4 {\\n  padding-left: 1rem;\\n  padding-right: 1rem;\\n}\\n\\n.px-5 {\\n  padding-left: 1.25rem;\\n  padding-right: 1.25rem;\\n}\\n\\n.py-6 {\\n  padding-top: 1.5rem;\\n  padding-bottom: 1.5rem;\\n}\\n\\n.px-10 {\\n  padding-left: 2.5rem;\\n  padding-right: 2.5rem;\\n}\\n\\n.pb-4 {\\n  padding-bottom: 1rem;\\n}\\n\\n.pt-12 {\\n  padding-top: 3rem;\\n}\\n\\n* {\\n  --tw-shadow: 0 0 #0000;\\n}\\n\\n.shadow-md {\\n  --tw-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\\n}\\n\\n.shadow-lg {\\n  --tw-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);\\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\\n}\\n\\n.shadow-xl {\\n  --tw-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);\\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\\n}\\n\\n* {\\n  --tw-ring-inset: var(--tw-empty,/*!*/ /*!*/);\\n  --tw-ring-offset-width: 0px;\\n  --tw-ring-offset-color: #fff;\\n  --tw-ring-color: rgba(59, 130, 246, 0.5);\\n  --tw-ring-offset-shadow: 0 0 #0000;\\n  --tw-ring-shadow: 0 0 #0000;\\n}\\n\\n.text-left {\\n  text-align: left;\\n}\\n\\n.text-right {\\n  text-align: right;\\n}\\n\\n.text-white {\\n  --tw-text-opacity: 1;\\n  color: rgba(255, 255, 255, var(--tw-text-opacity));\\n}\\n\\n.text-gray-500 {\\n  --tw-text-opacity: 1;\\n  color: rgba(107, 114, 128, var(--tw-text-opacity));\\n}\\n\\n.text-gray-900 {\\n  --tw-text-opacity: 1;\\n  color: rgba(17, 24, 39, var(--tw-text-opacity));\\n}\\n\\n.text-red-500 {\\n  --tw-text-opacity: 1;\\n  color: rgba(239, 68, 68, var(--tw-text-opacity));\\n}\\n\\n.text-green-500 {\\n  --tw-text-opacity: 1;\\n  color: rgba(16, 185, 129, var(--tw-text-opacity));\\n}\\n\\n.truncate {\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  white-space: nowrap;\\n}\\n\\n.w-5 {\\n  width: 1.25rem;\\n}\\n\\n.w-6 {\\n  width: 1.5rem;\\n}\\n\\n.w-8 {\\n  width: 2rem;\\n}\\n\\n.w-20 {\\n  width: 5rem;\\n}\\n\\n.w-32 {\\n  width: 8rem;\\n}\\n\\n.w-40 {\\n  width: 10rem;\\n}\\n\\n.w-48 {\\n  width: 12rem;\\n}\\n\\n.w-full {\\n  width: 100%;\\n}\\n\\n.grid-cols-2 {\\n  grid-template-columns: repeat(2, minmax(0, 1fr));\\n}\\n\\n@keyframes spin {\\n  to {\\n    transform: rotate(360deg);\\n  }\\n}\\n\\n@keyframes ping {\\n  75%, 100% {\\n    transform: scale(2);\\n    opacity: 0;\\n  }\\n}\\n\\n@keyframes pulse {\\n  50% {\\n    opacity: .5;\\n  }\\n}\\n\\n@keyframes bounce {\\n  0%, 100% {\\n    transform: translateY(-25%);\\n    animation-timing-function: cubic-bezier(0.8,0,1,1);\\n  }\\n\\n  50% {\\n    transform: none;\\n    animation-timing-function: cubic-bezier(0,0,0.2,1);\\n  }\\n}\\n\\n@media (min-width: 640px) {\\n}\\n\\n@media (min-width: 768px) {\\n}\\n\\n@media (min-width: 1024px) {\\n}\\n\\n@media (min-width: 1280px) {\\n}\\n\\n@media (min-width: 1536px) {\\n}\\n    \", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"/* @tailwind base; */\\n/* @tailwind components; */\\n/* .section { */\\n/*     @apply p-4 text-gray-900 w-full bg-gray-200 shadow-md rounded m-4 */\\n/* } */\\n/* .header { */\\n/*     @apply py-2 mb-1 text-left text-gray-900 w-full bg-gray-100 shadow-md rounded */\\n/* } */\\n/* .header-cell { */\\n/*     @apply px-12 */\\n/* } */\\n/* @tailwind utilities; */\\n\\n/* @import \\\"tailwindcss/base\\\"; */\\n/* @import \\\"tailwindcss/components\\\"; */\\n/* @import \\\"tailwindcss/utilities\\\"; */\\n\\n/* @apply p-4 text-gray-900 w-full bg-gray-200 shadow-md rounded m-4 */\\n.section {\\n\\tmargin: 1rem;\\n  padding: 1rem;\\n  color: #1a202c;\\n  width: 100%;\\n  background-color: #edf2f7;\\n  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\\n  border-radius: 0.25rem;\\n  height: 100%;\\n  overflow-y: hidden;\\n  padding-bottom: 50px;\\n}\\n\\n.section p {\\n  padding-top: 0.5rem;\\n}\\n\\n.section ul {\\n  margin-left: 1rem;\\n  list-style: disc;\\n}\\n\\n/* @apply py-2 mb-1 text-left text-gray-900 w-full bg-gray-100 shadow-md rounded */\\n.header {\\n  padding-top: 0.5rem; padding-bottom: 0.5rem;\\n  text-align: left;\\n  color: #1a202c;\\n  width: 100%;\\n  background-color: #f7fafc;\\n  cursor: pointer;\\n  color: maroon;\\n  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\\n  border-radius: 0.25rem;\\n}\\n\\n/* @apply px-12 */\\n.header-cell {\\n  padding-left: 3rem; padding-right: 3rem;\\n}\\n\\n\\n\\n.hidden {\\n  display: none!important;\\n}\\n\\nhtml {\\n    height: 100%;\\n    overflow-y: hidden;\\n    overflow-x: hidden;\\n}\\n\\nbody {\\n    height: 100%;\\n    font-family: -apple-system, BlinkMacSystemFont, \\\"Segoe UI\\\", Roboto, Helvetica, Arial, sans-serif;\\n    margin: 0;\\n    padding: 2rem;\\n    padding-top: 0;\\n}\\n\\n#app {\\n    height: 100%;\\n    overflow: hidden;\\n}\\n\\n#progress {\\n    height: 20px;\\n    width: 100px;\\n    position: absolute;\\n    top: 5px;\\n    right: 25px;\\n    margin-right: 25px;\\n    z-index: 100;\\n}\\n\\n#ok {\\n    position: absolute;\\n    top: 55px;\\n    right: 55px;\\n    z-index: 100;\\n}\\n\\np.ptext {\\n    padding-top: 0.5rem;\\n    text-indent: 1rem;\\n}\\n\\np.plist {\\n  padding-top: 0;\\n  text-indent: 1rem;\\n  height: 1rem;\\n}\\n\\n.ul {\\n  margin-top: 1rem;\\n}\\n\\n\\n.book {\\n  height: 100%;\\n  padding-bottom: 50px;\\n}\\n\\n.page {\\n    margin-top: 25px;\\n    height: 100%;\\n    overflow-y: hidden;\\n}\\n\\n#message {\\n    /* height: 20px; */\\n    width: 80%;\\n    white-space: nowrap;\\n    position: absolute;\\n    top: 0;\\n    left: 25px;\\n    z-index: 10;\\n    background: white;\\n}\\n\\n/* == text == */\\n\\nspan.wf:hover {\\n    background-color: #eee8aa;\\n}\\n\\nspan.ref:hover {\\n    background-color: #eee8aa;\\n    cursor: pointer;\\n}\\n\\nh1, .h1 {\\n    margin-top: 50px;\\n    color: maroon;\\n    font-size: 24px;\\n    font-weight: bold;\\n}\\n\\nh2, .h2 {\\n    margin-top: 50px;\\n    color: maroon;\\n    font-size: 16px;\\n    font-weight: bold;\\n}\\n\\nh3, .h3 {\\n    margin-top: 25px;\\n    color: maroon;\\n    font-size: 16px;\\n}\\n\\nh4, .h4 {\\n    color: maroon;\\n    margin-top: 20px;\\n    font-size: 16px;\\n}\\n\\na {\\n    cursor: pointer;\\n}\\n\\nem {\\n    color: #2f4f4f;\\n}\\n\\n.nowrap {\\n    white-space: nowrap;\\n}\\n\\n/* .line-par { */\\n/*     /\\\\* width: auto; *\\\\/ */\\n/* } */\\n\\n/* .line-block { */\\n/*     overflow: hidden; */\\n/* } */\\n\\n.list-line .ptext {\\n    text-indent: 0;\\n}\\n\\n.line-head {\\n    cursor: pointer;\\n}\\n\\n/* =========== COLORS =============== */\\n\\n.maroon {\\n    color: maroon;\\n}\\n\\n.bold {\\n    font-weight: bold;\\n}\\n\\n.darkgreen {\\n    color: darkgreen;\\n}\\n\\n.darkred {\\n    color: darkred;\\n}\\n\\n.grey {\\n    color: grey;\\n}\\n\\n\\n/* =========== TABLE =============== */\\n\\ntr:nth-child(even):not(.hidden) {\\n    background-color: #edf2f7;\\n}\\n\\ntr:nth-child(odd):not(.hidden) {\\n    background-color: #f7fafc;\\n}\\n\\n.odd {\\n    background-color: #f7fafc;\\n}\\n\\n.even {\\n    background-color: #edf2f7;\\n}\\n\\n.table-line {\\n    cursor: pointer;\\n}\\n\\n.table-line:hover {\\n    background-color: #eee8aa!important;\\n}\\n\\n.tmpl {\\n    display: none!important;\\n}\\n\\n/* == bmk ==  */\\n\\n\\n.tree-block p {\\n    overflow: hidden;\\n    text-overflow: ellipsis;\\n    white-space: nowrap;\\n}\\n\\n.synchroMark {\\n  width: 0.5rem;\\n  height: 0.5rem;\\n  float: right;\\n  position: relative;\\n  z-index: 100;\\n  top: 1rem;\\n}\\n\\n#dict-progress {\\n  height: 20px;\\n  width: auto;\\n  position: absolute;\\n  top: 5px;\\n  right: 150px;\\n  font-weight: bold;\\n  z-index: 20;\\n  margin-left: 25px;\\n}\\n\\n.highlight {\\n  background: orange;\\n  color: black;\\n}\\n\\n/* === search === */\\n#search-input {\\n  position: absolute;\\n  top: 0;\\n  padding: 4px;\\n  right: 25px;\\n  margin-right: 25px;\\n  cursor: pointer;\\n}\\n\\n#search-icon {\\n  position: absolute;\\n  top: 12px;\\n  right: 25px;\\n  margin-right: 25px;\\n  cursor: pointer;\\n}\\n\\n/* .searchinput { */\\n/*   width: 100%; */\\n/* } */\\n\\n/* auto-sync */\\n\\n.em-red-circle::before {\\n  content: '';\\n  display: inline-block;\\n  width: 10px;\\n  height: 10px;\\n  border-radius: 5px;\\n  margin-top: 6px;\\n  background-color: indianred;\\n  float: right;\\n  margin-right: -20px;\\n}\\n\\n.em-green-circle::before {\\n  content: '';\\n  display: inline-block;\\n  width: 10px;\\n  height: 10px;\\n  border-radius: 5px;\\n  margin-top: 6px;\\n  background-color: #bada55;\\n  float: right;\\n  margin-right: -20px;\\n}\\n\\n/* .editable { */\\n/*   border-style: dotted; */\\n/*   border-width: 2px; */\\n/*   border-color: eee8dd; */\\n/* } */\\n\\n.truncated {\\n  height: 2rem;\\n}\\n\\n.external {\\n  cursor: pointer;\\n  color: maroon;\\n}\\n\\n.show-page-position {\\n  position: absolute;\\n  top: 45px;\\n  margin-right: 25px;\\n  z-index: 100;\\n  width: 0;\\n  border-style: solid;\\n  border-width: 2px;\\n  border-top: 1px;\\n}\\n\\n.footnote {\\n    cursor: pointer;\\n    position: absolute;\\n    width: 400px;\\n    padding: 15px;\\n    z-index: 100;\\n    font-size: 90%;\\n    background-color: #f7fafc;\\n    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\\n}\\n\\n.version {\\n    cursor: pointer;\\n}\\n\\n#heap {\\n    cursor: pointer;\\n}\\n\\n.lookup-line {\\n    cursor: pointer;\\n}\\n\\n#lookup-help-button {\\n    cursor: pointer;\\n    color: maroon;\\n}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".somestyle {\\n    /* */\\n}\\n\\n.tree-branch {\\n    /* margin-left: 15px; */\\n    /* padding-left: 10px; */\\n}\\n\\n.tree-branch::before {\\n    content: '▾';\\n    padding-right: 5px;\\n    /* display: inline-block; */\\n    /* width: 20px; */\\n    /* height: 20px; */\\n    float: left;\\n    color: maroon;\\n    font-size: larger;\\n}\\n\\n.tree-branch.tree-collapse::before {\\n    content: '▸';\\n    padding-right: 5px;\\n}\\n\\n.tree-sign {\\n  float: left;\\n  padding-right: 10px;\\n  color: maroon;\\n  font-size: large;\\n  display: inline-block;\\n  width: 10px;\\n}\\n\\n.tree-block {\\n  white-space: nowrap;\\n  cursor: pointer;\\n  /* margin-bottom: 3px; */\\n}\\n\\n\\n.tree-block p {\\n  /* margin-bottom: 6px; */\\n}\\n\\n.tree-text {\\n    white-space: nowrap;\\n    padding-bottom: 5px;\\n    padding-left: 10px;\\n}\\n\\n.tree-text:hover {\\n    background-color: #eee8aa;\\n    cursor: pointer;\\n}\\n\\n.tree-collapse > div {\\n    display: none;\\n}\\n\\n.lev-1 {\\n    /* padding-left: 0 */\\n}\\n\\n.lev-2 {\\n    /* padding-left: 15px; */\\n    margin-left: 10px;\\n}\\n\\n.lev-3 {\\n    /* padding-left: 30px; */\\n  margin-left: 20px;\\n}\\n\\n.lev-4 {\\n    /* padding-left: 45px; */\\n  margin-left: 30px;\\n}\\n\\n.lev-5 {\\n    /* padding-left: 60px; */\\n  margin-left: 40px;\\n}\\n\\n.lev-6 {\\n  /* padding-left: 75px; */\\n  margin-left: 50px;\\n}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","var api = require(\"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./compiled.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","var api = require(\"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./index.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","var api = require(\"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./tree.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","module.exports = require(\"book-md2json\");;","module.exports = require(\"dgl-utils\");;","module.exports = require(\"dict-sd2json\");;","module.exports = require(\"electron\");;","module.exports = require(\"electron-store\");;","module.exports = require(\"flexsearch\");;","module.exports = require(\"franc\");;","module.exports = require(\"fs-extra\");;","module.exports = require(\"glob\");;","module.exports = require(\"is-zip\");;","module.exports = require(\"json5\");;","module.exports = require(\"langs\");;","module.exports = require(\"lodash\");;","module.exports = require(\"mark.js\");;","module.exports = require(\"marked\");;","module.exports = require(\"mousetrap\");;","module.exports = require(\"natural\");;","module.exports = require(\"path\");;","module.exports = require(\"snowball-german\");;","module.exports = require(\"stopword\");;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/app.js\");\n"],"sourceRoot":""}